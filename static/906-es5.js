!function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(self.webpackChunkegritos_group_eg_web_apps=self.webpackChunkegritos_group_eg_web_apps||[]).push([[906],{35906:function(e,n,s){s.r(n),s.d(n,{TautotitaOfeilisModule:function(){return z}});var o,a=s(43645),r=s(29790),u=s(23292),l=s(88052),p=s(54655),c=s(68214),d=s(79765),f=s(46782),h=s(37716),g=s(87622),m=s(12622),y=s(38583),b=s(3379),v=s(24020),A=s(44748),C=s(21571),x=((x||(x={})).paymentCode="\u039a\u03c9\u03b4\u03b9\u03ba\u03cc\u03c2",x),Z=((Z||(Z={})).paymentCode="Payment Code",Z),_=s(84608),w=s(91841),S=((o=function(){function e(i,n){t(this,e),this.http=i,this.toasterSrv=n,this.apiUrl=AppConfOptions.eidopoiitiria_api+"api/"}return i(e,[{key:"getEidopoiitiria",value:function(t){return this.http.post(this.apiUrl+"Atm/Eidopoiitiria",t)}}]),e}()).\u0275fac=function(t){return new(t||o)(h.LFG(w.eN),h.LFG(c.MJ))},o.\u0275prov=h.Yz7({token:o,factory:o.\u0275fac}),o),k=s(3679),T=["tautotitaOfeilisForm"];function M(t,e){1&t&&(h.TgZ(0,"div",2),h.TgZ(1,"span",3),h._UZ(2,"i",4),h.qZA(),h.qZA())}function O(t,e){if(1&t&&h._UZ(0,"p-message",19),2&t){var i=h.oxw(2);h.Q6J("severity",i.bankStatusMessageClass)("text",i.bankStatusMessage)("styleClass","mb-2")}}function q(t,e){if(1&t&&h._UZ(0,"p-message",20),2&t){var i=h.oxw(2);h.Q6J("styleClass","mt-2 form-msgs")("escape",!1)("text",i.formErrorsMsg)}}function J(t,e){1&t&&(h.TgZ(0,"div",2),h.TgZ(1,"span",3),h._UZ(2,"i",4),h.qZA(),h.qZA())}function L(t,e){if(1&t&&(h.TgZ(0,"p",25),h._uU(1,"\u039a\u03c9\u03b4\u03b9\u03ba\u03cc\u03c2 \u03a0\u03bb\u03b7\u03c1\u03c9\u03bc\u03ae\u03c2: "),h.TgZ(2,"span",26),h._uU(3),h.qZA(),h.qZA()),2&t){var i=h.oxw(3);h.xp6(3),h.Oqu(i.model.paymentCode)}}function R(t,e){if(1&t&&(h.TgZ(0,"p",25),h._uU(1,"\u03a3\u03c4\u03bf\u03b9\u03c7\u03b5\u03af\u03b1 \u039f\u03c6\u03b5\u03b9\u03bb\u03ae\u03c2: "),h.TgZ(2,"span",26),h._uU(3),h.qZA(),h.qZA()),2&t){var i=h.oxw(3);h.xp6(3),h.Oqu(i.model.paymentCaption)}}function I(t,e){if(1&t&&(h.TgZ(0,"p",25),h._uU(1,"\u03a3\u03c5\u03bd\u03bf\u03bb\u03b9\u03ba\u03cc \u03a0\u03bf\u03c3\u03cc \u039f\u03c6\u03b5\u03b9\u03bb\u03ae\u03c2: "),h.TgZ(2,"span",26),h._uU(3),h.ALo(4,"currency"),h.qZA(),h.qZA()),2&t){var i=h.oxw(3);h.xp6(3),h.Oqu(h.gM2(4,1,i.model.paymentAmount,"\u20ac","symbol","1.2"))}}function U(t,e){if(1&t){var i=h.EpF();h.ynx(0),h._UZ(1,"hr"),h.TgZ(2,"h5",21),h._uU(3),h.ALo(4,"translate"),h.qZA(),h.TgZ(5,"div",22),h.TgZ(6,"div"),h.YNc(7,L,4,1,"p",23),h.YNc(8,R,4,1,"p",23),h.YNc(9,I,5,6,"p",23),h.qZA(),h.TgZ(10,"app-checkout",24),h.NdJ("onPayBtnClick",function(t){return h.CHM(i),h.oxw(2).onCreatePaymentRequest(t)}),h.qZA(),h.qZA(),h.BQk()}if(2&t){var n=h.oxw(2);h.xp6(3),h.Oqu(h.lcZ(4,9,null==n.translation?null:n.translation.egwebapps.egrResults)),h.xp6(4),h.Q6J("ngIf",n.model.paymentCode),h.xp6(1),h.Q6J("ngIf",n.model.paymentCaption),h.xp6(1),h.Q6J("ngIf",n.model.paymentAmount),h.xp6(1),h.Q6J("isPaymentFormValid",!0)("doPaymentSubscription",n.onDoPaymentSubject.asObservable())("finApiUrl",n.financeApiUrl)("buttonText",n.translation.egwebapps.egrPaymentBtnText)("cancelButtonText",n.translation.egwebapps.egrCancelBtn)}}function P(t,e){if(1&t){var i=h.EpF();h.ynx(0),h.YNc(1,O,1,3,"p-message",5),h.TgZ(2,"form",6,7),h.TgZ(4,"div",8),h.TgZ(5,"div",9),h.TgZ(6,"label",10),h._uU(7),h.ALo(8,"translate"),h.qZA(),h.TgZ(9,"input",11),h.NdJ("ngModelChange",function(t){return h.CHM(i),h.oxw().paymentCode=t}),h.ALo(10,"translate"),h.qZA(),h.TgZ(11,"div",12),h._uU(12),h.ALo(13,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(14,"div",13),h.TgZ(15,"button",14),h.NdJ("click",function(){return h.CHM(i),h.oxw().onSubmit()}),h._UZ(16,"span",15),h._uU(17),h.ALo(18,"translate"),h.qZA(),h.TgZ(19,"button",16),h.NdJ("click",function(){return h.CHM(i),h.oxw().onClear()}),h._UZ(20,"span",17),h._uU(21),h.ALo(22,"translate"),h.qZA(),h.qZA(),h.YNc(23,q,1,3,"p-message",18),h.qZA(),h.YNc(24,J,3,0,"div",0),h.YNc(25,U,11,11,"ng-container",1),h.BQk()}if(2&t){var n=h.oxw();h.xp6(1),h.Q6J("ngIf",n.bankStatusMessage&&""!=n.bankStatusMessage),h.xp6(6),h.hij("",h.lcZ(8,13,null==n.translation?null:n.translation.eidopoiitiria.code),"*"),h.xp6(2),h.Q6J("placeholder",h.lcZ(10,15,null==n.translation?null:n.translation.eidopoiitiria.code))("ngModel",n.paymentCode)("disabled",n.model),h.xp6(2),h.Q6J("hidden",!n.isFormSubmitted||n.isFormSubmitted&&n.paymentCode),h.xp6(1),h.hij(" *",h.lcZ(13,17,null==n.translation?null:n.translation.egwebapps.egrRequiredField)," "),h.xp6(3),h.Q6J("disabled",n.model),h.xp6(2),h.hij(" ",h.lcZ(18,19,null==n.translation?null:n.translation.egwebapps.egrSearchBtn)," "),h.xp6(4),h.hij(" ",h.lcZ(22,21,null==n.translation?null:n.translation.egwebapps.egrClearBtn)," "),h.xp6(2),h.Q6J("ngIf",n.formErrorsMsg&&""!=n.formErrorsMsg),h.xp6(1),h.Q6J("ngIf",n.isLoading),h.xp6(1),h.Q6J("ngIf",n.model&&!n.isLoading)}}var Q=function(){var e=function(){function e(i,n,s,o,a,r,u,l,p){t(this,e),this.oidcSecuritySrv=i,this.epaymentsSrv=n,this.egPaymentSrv=s,this.tautotitaOfeilisSrv=o,this.cookieSrv=a,this.toasterSrv=r,this.appCacheSv=u,this.cdr=l,this.route=p,this.countriesList=[],this.onDoPaymentSubject=new d.xQ,this.onDestroy=new d.xQ,this.isLoading=!1,this.isLoadingInit=!1,this.errorMessageProfile=null,this.oikonomikiBankMessagesEn=_.Px,this.isFormSubmitted=!1}return i(e,[{key:"ngOnInit",value:function(){var t=this;this.appCacheSv.translation$.pipe((0,f.R)(this.onDestroy)).subscribe(function(e){e&&(t.translation=e,(0,c.RA)(t.cdr))}),this.appCacheSv.selectedLang$.pipe((0,f.R)(this.onDestroy)).subscribe(function(e){e&&(t.selectedLang=e,t.formDictionaryEnum="el"==t.selectedLang?x:Z,(0,c.RA)(t.cdr))}),this.isLoadingInit=!0,(0,c.RA)(this.cdr),"undefined"!=typeof AuthConfOptions&&AppConfOptions&&AppConfOptions.epayments_api&&(this.financeApiUrl=(0,c.Qj)(AppConfOptions.epayments_api)),this.route.queryParams.pipe((0,f.R)(this.onDestroy)).subscribe(function(e){var i;if(e){var n=e;if(n.messagecode||n.paymentStatus){var s=n.messagecode?n.messagecode:n.paymentStatus;t.bankStatusMessage="el"==t.selectedLang?t.oikonomikiBankMessages[s]:t.oikonomikiBankMessagesEn[s],t.bankStatusMessageClass="TRANSACTION_COMPLETED"==s||"APPROVED"==s?"success":"error"}}else t.toasterSrv.showError("",null===(i=t.translation)||void 0===i?void 0:i.egwebapps.egrProblemFound);(0,c.RA)(t.cdr)}),this.appCacheSv.initCountries(AuthConfOptions.stsServer+"/api/general/GetCountries"),(0,C.$R)(this.epaymentsSrv.getBankMessages(),this.oidcSecuritySrv.userData$,this.appCacheSv.countries$).subscribe(function(e){e&&(e[0]&&(t.oikonomikiBankMessages=e[0]),e[1]&&(t.user=e[1]),e[2]&&(t.countriesList=e[2],t.user&&t.user.address_country_code&&""!=t.user.address_country_code&&(t.user.address_country_num=t.countriesList.find(function(e){return e.Alpha2Code==t.user.address_country_code}).NumericCode.toString()))),t.isLoadingInit=!1,(0,c.RA)(t.cdr)})}},{key:"ngOnDestroy",value:function(){this.onDestroy.next(null)}},{key:"onSubmit",value:function(){var t=this;if(this.isFormSubmitted=!0,this.formErrorsMsg=null,(0,c.RA)(this.cdr),this.isFormSubmitted&&this.tautotitaOfeilisForm.valid){this.model=null,this.isLoading=!0;var e={language:"el",kodikos:this.paymentCode};(0,c.RA)(this.cdr),this.tautotitaOfeilisSrv.getEidopoiitiria(e).subscribe(function(e){e&&e.isSuccessful?t.model=e.result:(t.toasterSrv.showError("",e.errorDescription),t.errorMessage=e.errorDescription),t.isLoading=!1,(0,c.RA)(t.cdr)})}else this.formErrorsMsg=(0,c.CD)(this.tautotitaOfeilisForm,this.formDictionaryEnum,""),(0,c.RA)(this.cdr)}},{key:"onCreatePaymentRequest",value:function(t){var e=this,i={tinRelated:this.user.tin,relatedCallbackUrl:AppConfOptions.application_url+"/tautotita-ofeilis/debits",billingAddressCity:this.user.address_city,billingAddressCountryCode:this.user.address_country_code,billingAddressZip:this.user.address_zip,billingAddress:this.user.address,userEmail:this.user.email,userPhone:this.user.phone_number,paymentMethodKey:t.key,entries:[]};"PIRBGRAA"===t.key&&(i.billingAddressCountryCode=null),i.entries.push({remittanceInfo:this.model.paymentCode,amount:this.model.paymentAmount,debtorName:this.user.family_name+" "+this.user.fathers_name+" "+this.user.mothers_name+" "+this.user.name,tin:this.user.tin,description:this.model.paymentCaption}),this.paymentRequestDto=i,this.egPaymentSrv.addPaymentRequest(this.financeApiUrl,this.paymentRequestDto).subscribe(function(t){t?(e.paymentResponseDto=t,e.onDoPaymentSubject.next(e.paymentResponseDto)):e.toasterSrv.showError("",e.translation.egwebapps.egrPaymentProblemFound)})}},{key:"onClear",value:function(){this.isFormSubmitted=!1,this.paymentCode=null,this.model=null,(0,c.RA)(this.cdr)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(g.J_),h.Y36(u.C),h.Y36(c.te),h.Y36(S),h.Y36(c.N_),h.Y36(c.MJ),h.Y36(m.g),h.Y36(h.sBO),h.Y36(p.gz))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-tautotita-ofeilis-debits"]],viewQuery:function(t,e){var i;(1&t&&h.Gf(T,5),2&t)&&(h.iGM(i=h.CRH())&&(e.tautotitaOfeilisForm=i.first))},inputs:{isAuthorized:"isAuthorized"},decls:2,vars:2,consts:[["class","bg-white","style","width: 100%; height: 300px",4,"ngIf"],[4,"ngIf"],[1,"bg-white",2,"width","100%","height","300px"],[1,"d-flex","justify-content-center","align-items-center","w-100","h-100"],[1,"fas","fa-circle-notch","fa-3x","fa-pulse"],[3,"severity","text","styleClass",4,"ngIf"],[1,"form"],["tautotitaOfeilisForm","ngForm"],[1,"row"],[1,"form-group","col-12"],["for","paymentCode"],["name","paymentCode","type","text","required","",1,"form-control",3,"placeholder","ngModel","disabled","ngModelChange"],[1,"validation-msg","text-danger","pt-1",3,"hidden"],[1,"d-flex","align-items-center","justify-content-center","flex-wrap"],["type","button",1,"btn","btn-primary","mr-1",3,"disabled","click"],["aria-hidden","true",1,"fas","fa-search","fa-fw"],["type","button",1,"btn","btn-warning","text-white",3,"click"],["aria-hidden","true",1,"fas","fa-times","fa-fw"],["severity","error",3,"styleClass","escape","text",4,"ngIf"],[3,"severity","text","styleClass"],["severity","error",3,"styleClass","escape","text"],[1,"mt-4","text-center"],[1,"debits-info","d-flex","flex-wrap","justify-content-between","w-100","align-items-center"],["class","mb-0",4,"ngIf"],[3,"isPaymentFormValid","doPaymentSubscription","finApiUrl","buttonText","cancelButtonText","onPayBtnClick"],[1,"mb-0"],[1,"totalPoso"]],template:function(t,e){1&t&&(h.YNc(0,M,3,0,"div",0),h.YNc(1,P,26,23,"ng-container",1)),2&t&&(h.Q6J("ngIf",e.isLoadingInit),h.xp6(1),h.Q6J("ngIf",!e.isLoadingInit))},directives:[y.O5,k._Y,k.JL,k.F,k.Fj,k.Q7,k.JJ,k.On,b.q,c.Hl],pipes:[r.X$,y.H9],encapsulation:2,changeDetection:0}),e}(),Y=s(41886);function D(t,e){if(1&t&&h._UZ(0,"p-message",3),2&t){var i=h.oxw();h.Q6J("text",null==i.translation?null:i.translation.egwebapps.egwebappsLoginMesg)}}function F(t,e){if(1&t&&(h.TgZ(0,"p-panel",4),h._UZ(1,"div",5),h.ALo(2,"decodeHtmlString"),h.qZA()),2&t){var i=h.oxw();h.Q6J("styleClass","tab-msg mb-3")("toggleable",!0),h.xp6(1),h.Q6J("innerHTML",h.lcZ(2,3,i.tabMsg),h.oJD)}}function E(t,e){if(1&t){var i=h.EpF();h.TgZ(0,"p-tabView",6),h.NdJ("onChange",function(t){return h.CHM(i),h.oxw().onTabChanged(t)}),h.TgZ(1,"p-tabPanel",7),h.ALo(2,"translate"),h._UZ(3,"app-tautotita-ofeilis-debits"),h.qZA(),h.qZA()}if(2&t){var n=h.oxw();h.Q6J("activeIndex",n.index),h.xp6(1),h.Q6J("header",h.lcZ(2,2,null==n.translation?null:n.translation.menu.katastimataTabTitle))}}var N=[{path:"",component:function(){var e=function(){function e(i,n,s,o,a,r){t(this,e),this.oidcSecuritySrv=i,this.appCacheSv=n,this.location=s,this.cdr=o,this.router=a,this.route=r,this.onDestroy=new d.xQ,this.index=0,this.isUnauthorizedAllowed=AppConfOptions.unauthorized_allowed,this.selectedLang="el"}return i(e,[{key:"ngOnInit",value:function(){var t=this;this.appCacheSv.translation$.pipe((0,f.R)(this.onDestroy)).subscribe(function(e){e&&(t.translation=e,(0,c.RA)(t.cdr))}),this.appCacheSv.selectedLang$.pipe((0,f.R)(this.onDestroy)).subscribe(function(e){e&&(t.selectedLang=e),1==AppConfOptions.multilingual&&"el"!=t.selectedLang&&AppConfOptions.eidopoiitiria_tab_info_en&&""!=AppConfOptions.eidopoiitiria_tab_info_en?t.tabMsg=AppConfOptions.eidopoiitiria_tab_info_en:AppConfOptions.eidopoiitiria_tab_info&&""!=AppConfOptions.eidopoiitiria_tab_info&&"el"==t.selectedLang&&(t.tabMsg=AppConfOptions.eidopoiitiria_tab_info),(0,c.RA)(t.cdr)}),this.oidcSecuritySrv.isAuthenticated$.subscribe(function(e){t.isAuthorized=e,(0,c.RA)(t.cdr)}),this.index="receipts"===this.route.children[0].snapshot.url[0].path?1:0,(0,c.RA)(this.cdr)}},{key:"ngOnDestroy",value:function(){this.onDestroy.next(null)}},{key:"onTabChanged",value:function(t){this.router.navigate(0==t.index?["./debits"]:["./receipts"],{relativeTo:this.route})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(g.J_),h.Y36(m.g),h.Y36(y.Ye),h.Y36(h.sBO),h.Y36(p.F0),h.Y36(p.gz))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-tautotita-ofeilis-layout"]],inputs:{isAuthorized:"isAuthorized"},decls:3,vars:3,consts:[["severity","warn",3,"text",4,"ngIf"],["header","\u03a0\u03bb\u03b7\u03c1\u03bf\u03c6\u03bf\u03c1\u03af\u03b5\u03c2",3,"styleClass","toggleable",4,"ngIf"],[3,"activeIndex","onChange",4,"ngIf"],["severity","warn",3,"text"],["header","\u03a0\u03bb\u03b7\u03c1\u03bf\u03c6\u03bf\u03c1\u03af\u03b5\u03c2",3,"styleClass","toggleable"],[3,"innerHTML"],[3,"activeIndex","onChange"],[3,"header"]],template:function(t,e){1&t&&(h.YNc(0,D,1,1,"p-message",0),h.YNc(1,F,3,5,"p-panel",1),h.YNc(2,E,4,4,"p-tabView",2)),2&t&&(h.Q6J("ngIf",!e.isAuthorized&&!e.isUnauthorizedAllowed),h.xp6(1),h.Q6J("ngIf",e.isAuthorized&&e.tabMsg&&""!=e.tabMsg),h.xp6(1),h.Q6J("ngIf",e.isAuthorized||e.isUnauthorizedAllowed))},directives:[y.O5,b.q,v.s,A.xf,A.x4,Q],pipes:[Y.o,r.X$],encapsulation:2,changeDetection:0}),e}(),children:[{path:"",pathMatch:"full",redirectTo:"debits"},{path:"debits",component:Q}]}],B=function(){var e=i(function e(){t(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=h.oAB({type:e}),e.\u0275inj=h.cJS({imports:[[p.Bz.forChild(N)],p.Bz]}),e}(),z=function(){var e=i(function e(){t(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=h.oAB({type:e}),e.\u0275inj=h.cJS({providers:[S,u.C],imports:[[l.m,a.IJ,B,r.aw.forChild()]]}),e}()}}])}();