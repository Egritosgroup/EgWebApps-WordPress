(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{ibjo:function(t,e,i){"use strict";i.r(e),i.d(e,"TautotitaOfeilisModule",function(){return q});var s=i("1kSV"),n=i("sYmb"),a=i("AEAu"),o=i("PCNd"),r=i("tyNb"),c=i("3u8h"),l=i("oXA7"),p=i("bk9D"),b=i("V7IR"),d=i("fXoL"),u=i("zazq"),h=i("ofXK"),m=i("FMpt"),g=i("7CaW"),f=i("dPl2"),y=i("2kNk"),C=function(t){return t.paymentCode="\u039a\u03c9\u03b4\u03b9\u03ba\u03cc\u03c2",t}({}),O=function(t){return t.paymentCode="Payment Code",t}({}),v=i("tk/3");let S=(()=>{class t{constructor(t,e){this.http=t,this.toasterSrv=e,this.apiUrl=AppConfOptions.eidopoiitiria_api+"api/"}getEidopoiitiria(t){return this.http.post(this.apiUrl+"Atm/Eidopoiitiria",t)}}return t.\u0275fac=function(e){return new(e||t)(d.bc(v.b),d.bc(c.m))},t.\u0275prov=d.Kb({token:t,factory:t.\u0275fac}),t})();var P=i("KsmB"),w=i("3Pt+");const A=["tautotitaOfeilisForm"];function T(t,e){1&t&&(d.Ub(0,"div",2),d.Ub(1,"span",3),d.Pb(2,"i",4),d.Tb(),d.Tb())}function k(t,e){if(1&t&&d.Pb(0,"p-message",19),2&t){const t=d.gc(2);d.pc("severity",t.bankStatusMessageClass)("text",t.bankStatusMessage)("styleClass","mb-2")}}function B(t,e){if(1&t&&d.Pb(0,"p-message",20),2&t){const t=d.gc(2);d.pc("styleClass","mt-2 form-msgs")("escape",!1)("text",t.formErrorsMsg)}}function x(t,e){1&t&&(d.Ub(0,"div",2),d.Ub(1,"span",3),d.Pb(2,"i",4),d.Tb(),d.Tb())}function I(t,e){if(1&t&&(d.Ub(0,"p",25),d.Rc(1,"\u039a\u03c9\u03b4\u03b9\u03ba\u03cc\u03c2 \u03a0\u03bb\u03b7\u03c1\u03c9\u03bc\u03ae\u03c2: "),d.Ub(2,"span",26),d.Rc(3),d.Tb(),d.Tb()),2&t){const t=d.gc(3);d.Bb(3),d.Sc(t.model.paymentCode)}}function M(t,e){if(1&t&&(d.Ub(0,"p",25),d.Rc(1,"\u03a3\u03c4\u03bf\u03b9\u03c7\u03b5\u03af\u03b1 \u039f\u03c6\u03b5\u03b9\u03bb\u03ae\u03c2: "),d.Ub(2,"span",26),d.Rc(3),d.Tb(),d.Tb()),2&t){const t=d.gc(3);d.Bb(3),d.Sc(t.model.paymentCaption)}}function U(t,e){if(1&t&&(d.Ub(0,"p",25),d.Rc(1,"\u03a3\u03c5\u03bd\u03bf\u03bb\u03b9\u03ba\u03cc \u03a0\u03bf\u03c3\u03cc \u039f\u03c6\u03b5\u03b9\u03bb\u03ae\u03c2: "),d.Ub(2,"span",26),d.Rc(3),d.hc(4,"currency"),d.Tb(),d.Tb()),2&t){const t=d.gc(3);d.Bb(3),d.Sc(d.lc(4,1,t.model.paymentAmount,"\u20ac","symbol","1.2"))}}function _(t,e){if(1&t){const t=d.Vb();d.Sb(0),d.Pb(1,"hr"),d.Ub(2,"h5",21),d.Rc(3),d.hc(4,"translate"),d.Tb(),d.Ub(5,"div",22),d.Ub(6,"div"),d.Pc(7,I,4,1,"p",23),d.Pc(8,M,4,1,"p",23),d.Pc(9,U,5,6,"p",23),d.Tb(),d.Ub(10,"app-checkout",24),d.ec("onPayBtnClick",function(e){return d.Hc(t),d.gc(2).onCreatePaymentRequest(e)}),d.Tb(),d.Tb(),d.Rb()}if(2&t){const t=d.gc(2);d.Bb(3),d.Sc(d.ic(4,9,null==t.translation?null:t.translation.egwebapps.egrResults)),d.Bb(4),d.pc("ngIf",t.model.paymentCode),d.Bb(1),d.pc("ngIf",t.model.paymentCaption),d.Bb(1),d.pc("ngIf",t.model.paymentAmount),d.Bb(1),d.pc("isPaymentFormValid",!0)("doPaymentSubscription",t.onDoPaymentSubject.asObservable())("finApiUrl",t.financeApiUrl)("buttonText",t.translation.egwebapps.egrPaymentBtnText)("cancelButtonText",t.translation.egwebapps.egrCancelBtn)}}function j(t,e){if(1&t){const t=d.Vb();d.Sb(0),d.Pc(1,k,1,3,"p-message",5),d.Ub(2,"form",6,7),d.Ub(4,"div",8),d.Ub(5,"div",9),d.Ub(6,"label",10),d.Rc(7),d.hc(8,"translate"),d.Tb(),d.Ub(9,"input",11),d.ec("ngModelChange",function(e){return d.Hc(t),d.gc().paymentCode=e}),d.hc(10,"translate"),d.Tb(),d.Ub(11,"div",12),d.Rc(12),d.hc(13,"translate"),d.Tb(),d.Tb(),d.Tb(),d.Ub(14,"div",13),d.Ub(15,"button",14),d.ec("click",function(){return d.Hc(t),d.gc().onSubmit()}),d.Pb(16,"span",15),d.Rc(17),d.hc(18,"translate"),d.Tb(),d.Ub(19,"button",16),d.ec("click",function(){return d.Hc(t),d.gc().onClear()}),d.Pb(20,"span",17),d.Rc(21),d.hc(22,"translate"),d.Tb(),d.Tb(),d.Pc(23,B,1,3,"p-message",18),d.Tb(),d.Pc(24,x,3,0,"div",0),d.Pc(25,_,11,11,"ng-container",1),d.Rb()}if(2&t){const t=d.gc();d.Bb(1),d.pc("ngIf",t.bankStatusMessage&&""!=t.bankStatusMessage),d.Bb(6),d.Tc("",d.ic(8,13,null==t.translation?null:t.translation.eidopoiitiria.code),"*"),d.Bb(2),d.pc("placeholder",d.ic(10,15,null==t.translation?null:t.translation.eidopoiitiria.code))("ngModel",t.paymentCode)("disabled",t.model),d.Bb(2),d.pc("hidden",!t.isFormSubmitted||t.isFormSubmitted&&t.paymentCode),d.Bb(1),d.Tc(" *",d.ic(13,17,null==t.translation?null:t.translation.egwebapps.egrRequiredField)," "),d.Bb(3),d.pc("disabled",t.model),d.Bb(2),d.Tc(" ",d.ic(18,19,null==t.translation?null:t.translation.egwebapps.egrSearchBtn)," "),d.Bb(4),d.Tc(" ",d.ic(22,21,null==t.translation?null:t.translation.egwebapps.egrClearBtn)," "),d.Bb(2),d.pc("ngIf",t.formErrorsMsg&&""!=t.formErrorsMsg),d.Bb(1),d.pc("ngIf",t.isLoading),d.Bb(1),d.pc("ngIf",t.model&&!t.isLoading)}}let L=(()=>{class t{constructor(t,e,i,s,n,a,o,r,c){this.oidcSecuritySrv=t,this.epaymentsSrv=e,this.egPaymentSrv=i,this.tautotitaOfeilisSrv=s,this.cookieSrv=n,this.toasterSrv=a,this.appCacheSv=o,this.cdr=r,this.route=c,this.countriesList=[],this.onDoPaymentSubject=new l.a,this.onDestroy=new l.a,this.isLoading=!1,this.isLoadingInit=!1,this.errorMessageProfile=null,this.oikonomikiBankMessagesEn=P.b,this.isFormSubmitted=!1}ngOnInit(){this.appCacheSv.translation$.pipe(Object(p.a)(this.onDestroy)).subscribe(t=>{t&&(this.translation=t,Object(c.s)(this.cdr))}),this.appCacheSv.selectedLang$.pipe(Object(p.a)(this.onDestroy)).subscribe(t=>{t&&(this.selectedLang=t,this.formDictionaryEnum="el"==this.selectedLang?C:O,Object(c.s)(this.cdr))}),this.isLoadingInit=!0,Object(c.s)(this.cdr),"undefined"!=typeof AuthConfOptions&&AppConfOptions&&AppConfOptions.epayments_api&&(this.financeApiUrl=Object(c.x)(AppConfOptions.epayments_api)),this.route.queryParams.pipe(Object(p.a)(this.onDestroy)).subscribe(t=>{var e;if(t){let e=t;if(e.messagecode||e.paymentStatus){let t=e.messagecode?e.messagecode:e.paymentStatus;this.bankStatusMessage="el"==this.selectedLang?this.oikonomikiBankMessages[t]:this.oikonomikiBankMessagesEn[t],this.bankStatusMessageClass="TRANSACTION_COMPLETED"==t||"APPROVED"==t?"success":"error"}}else this.toasterSrv.showError("",null===(e=this.translation)||void 0===e?void 0:e.egwebapps.egrProblemFound);Object(c.s)(this.cdr)}),this.appCacheSv.initCountries(AuthConfOptions.stsServer+"/api/general/GetCountries"),Object(y.a)(this.epaymentsSrv.getBankMessages(),this.oidcSecuritySrv.userData$,this.appCacheSv.countries$).subscribe(t=>{t&&(t[0]&&(this.oikonomikiBankMessages=t[0]),t[1]&&(this.user=t[1]),t[2]&&(this.countriesList=t[2],this.user&&this.user.address_country_code&&""!=this.user.address_country_code&&(this.user.address_country_num=this.countriesList.find(t=>t.Alpha2Code==this.user.address_country_code).NumericCode.toString()))),this.isLoadingInit=!1,Object(c.s)(this.cdr)})}ngOnDestroy(){this.onDestroy.next(null)}onSubmit(){if(this.isFormSubmitted=!0,this.formErrorsMsg=null,Object(c.s)(this.cdr),this.isFormSubmitted&&this.tautotitaOfeilisForm.valid){this.model=null,this.isLoading=!0;let t={language:"el",kodikos:this.paymentCode};Object(c.s)(this.cdr),this.tautotitaOfeilisSrv.getEidopoiitiria(t).subscribe(t=>{t&&t.isSuccessful?this.model=t.result:(this.toasterSrv.showError("",t.errorDescription),this.errorMessage=t.errorDescription),this.isLoading=!1,Object(c.s)(this.cdr)})}else this.formErrorsMsg=Object(c.u)(this.tautotitaOfeilisForm,this.formDictionaryEnum,""),Object(c.s)(this.cdr)}onCreatePaymentRequest(t){let e={tinRelated:this.user.tin,relatedCallbackUrl:AppConfOptions.application_url+"/tautotita-ofeilis/debits",billingAddressCity:this.user.address_city,billingAddressCountryCode:this.user.address_country_code,billingAddressZip:this.user.address_zip,billingAddress:this.user.address,userEmail:this.user.email,userPhone:this.user.phone_number,paymentMethodKey:t.key,entries:[]};"PIRBGRAA"===t.key&&(e.billingAddressCountryCode=null),e.entries.push({remittanceInfo:this.model.paymentCode,amount:this.model.paymentAmount,debtorName:this.user.family_name+" "+this.user.fathers_name+" "+this.user.mothers_name+" "+this.user.name,tin:this.user.tin,description:this.model.paymentCaption}),this.paymentRequestDto=e,this.egPaymentSrv.addPaymentRequest(this.financeApiUrl,this.paymentRequestDto).subscribe(t=>{t?(this.paymentResponseDto=t,this.onDoPaymentSubject.next(this.paymentResponseDto)):this.toasterSrv.showError("",this.translation.egwebapps.egrPaymentProblemFound)})}onClear(){this.isFormSubmitted=!1,this.paymentCode=null,this.model=null,Object(c.s)(this.cdr)}}return t.\u0275fac=function(e){return new(e||t)(d.Ob(u.e),d.Ob(a.a),d.Ob(c.k),d.Ob(S),d.Ob(c.d),d.Ob(c.m),d.Ob(b.a),d.Ob(d.h),d.Ob(r.a))},t.\u0275cmp=d.Ib({type:t,selectors:[["app-tautotita-ofeilis-debits"]],viewQuery:function(t,e){if(1&t&&d.Wc(A,1),2&t){let t;d.Ec(t=d.fc())&&(e.tautotitaOfeilisForm=t.first)}},inputs:{isAuthorized:"isAuthorized"},decls:2,vars:2,consts:[["class","bg-white","style","width: 100%; height: 300px",4,"ngIf"],[4,"ngIf"],[1,"bg-white",2,"width","100%","height","300px"],[1,"d-flex","justify-content-center","align-items-center","w-100","h-100"],[1,"fas","fa-circle-notch","fa-3x","fa-pulse"],[3,"severity","text","styleClass",4,"ngIf"],[1,"form"],["tautotitaOfeilisForm","ngForm"],[1,"row"],[1,"form-group","col-12"],["for","paymentCode"],["name","paymentCode","type","text","required","",1,"form-control",3,"placeholder","ngModel","disabled","ngModelChange"],[1,"validation-msg","text-danger","pt-1",3,"hidden"],[1,"d-flex","align-items-center","justify-content-center","flex-wrap"],["type","button",1,"btn","btn-primary","mr-1",3,"disabled","click"],["aria-hidden","true",1,"fas","fa-search","fa-fw"],["type","button",1,"btn","btn-warning","text-white",3,"click"],["aria-hidden","true",1,"fas","fa-times","fa-fw"],["severity","error",3,"styleClass","escape","text",4,"ngIf"],[3,"severity","text","styleClass"],["severity","error",3,"styleClass","escape","text"],[1,"mt-4","text-center"],[1,"debits-info","d-flex","flex-wrap","justify-content-between","w-100","align-items-center"],["class","mb-0",4,"ngIf"],[3,"isPaymentFormValid","doPaymentSubscription","finApiUrl","buttonText","cancelButtonText","onPayBtnClick"],[1,"mb-0"],[1,"totalPoso"]],template:function(t,e){1&t&&(d.Pc(0,T,3,0,"div",0),d.Pc(1,j,26,23,"ng-container",1)),2&t&&(d.pc("ngIf",e.isLoadingInit),d.Bb(1),d.pc("ngIf",!e.isLoadingInit))},directives:[h.p,w.w,w.n,w.o,w.d,w.u,w.m,w.p,m.b,c.b],pipes:[n.c,h.d],encapsulation:2,changeDetection:0}),t})();var D=i("iHy+");function R(t,e){if(1&t&&d.Pb(0,"p-message",3),2&t){const t=d.gc();d.pc("text",null==t.translation?null:t.translation.egwebapps.egwebappsLoginMesg)}}function E(t,e){if(1&t&&(d.Ub(0,"p-panel",4),d.Pb(1,"div",5),d.hc(2,"decodeHtmlString"),d.Tb()),2&t){const t=d.gc();d.pc("styleClass","tab-msg mb-3")("toggleable",!0),d.Bb(1),d.pc("innerHTML",d.ic(2,3,t.tabMsg),d.Ic)}}function F(t,e){if(1&t){const t=d.Vb();d.Ub(0,"p-tabView",6),d.ec("onChange",function(e){return d.Hc(t),d.gc().onTabChanged(e)}),d.Ub(1,"p-tabPanel",7),d.hc(2,"translate"),d.Pb(3,"app-tautotita-ofeilis-debits"),d.Tb(),d.Tb()}if(2&t){const t=d.gc();d.pc("activeIndex",t.index),d.Bb(1),d.pc("header",d.ic(2,2,null==t.translation?null:t.translation.menu.katastimataTabTitle))}}const z=[{path:"",component:(()=>{class t{constructor(t,e,i,s,n,a){this.oidcSecuritySrv=t,this.appCacheSv=e,this.location=i,this.cdr=s,this.router=n,this.route=a,this.onDestroy=new l.a,this.index=0,this.isUnauthorizedAllowed=AppConfOptions.unauthorized_allowed,this.selectedLang="el"}ngOnInit(){this.appCacheSv.translation$.pipe(Object(p.a)(this.onDestroy)).subscribe(t=>{t&&(this.translation=t,Object(c.s)(this.cdr))}),this.appCacheSv.selectedLang$.pipe(Object(p.a)(this.onDestroy)).subscribe(t=>{t&&(this.selectedLang=t),1==AppConfOptions.multilingual&&"el"!=this.selectedLang&&AppConfOptions.eidopoiitiria_tab_info_en&&""!=AppConfOptions.eidopoiitiria_tab_info_en?this.tabMsg=AppConfOptions.eidopoiitiria_tab_info_en:AppConfOptions.eidopoiitiria_tab_info&&""!=AppConfOptions.eidopoiitiria_tab_info&&"el"==this.selectedLang&&(this.tabMsg=AppConfOptions.eidopoiitiria_tab_info),Object(c.s)(this.cdr)}),this.oidcSecuritySrv.isAuthenticated$.subscribe(t=>{this.isAuthorized=t,Object(c.s)(this.cdr)}),this.index="receipts"===this.route.children[0].snapshot.url[0].path?1:0,Object(c.s)(this.cdr)}ngOnDestroy(){this.onDestroy.next(null)}onTabChanged(t){this.router.navigate(0==t.index?["./debits"]:["./receipts"],{relativeTo:this.route})}}return t.\u0275fac=function(e){return new(e||t)(d.Ob(u.e),d.Ob(b.a),d.Ob(h.k),d.Ob(d.h),d.Ob(r.d),d.Ob(r.a))},t.\u0275cmp=d.Ib({type:t,selectors:[["app-tautotita-ofeilis-layout"]],inputs:{isAuthorized:"isAuthorized"},decls:3,vars:3,consts:[["severity","warn",3,"text",4,"ngIf"],["header","\u03a0\u03bb\u03b7\u03c1\u03bf\u03c6\u03bf\u03c1\u03af\u03b5\u03c2",3,"styleClass","toggleable",4,"ngIf"],[3,"activeIndex","onChange",4,"ngIf"],["severity","warn",3,"text"],["header","\u03a0\u03bb\u03b7\u03c1\u03bf\u03c6\u03bf\u03c1\u03af\u03b5\u03c2",3,"styleClass","toggleable"],[3,"innerHTML"],[3,"activeIndex","onChange"],[3,"header"]],template:function(t,e){1&t&&(d.Pc(0,R,1,1,"p-message",0),d.Pc(1,E,3,5,"p-panel",1),d.Pc(2,F,4,4,"p-tabView",2)),2&t&&(d.pc("ngIf",!e.isAuthorized&&!e.isUnauthorizedAllowed),d.Bb(1),d.pc("ngIf",e.isAuthorized&&e.tabMsg&&""!=e.tabMsg),d.Bb(1),d.pc("ngIf",e.isAuthorized||e.isUnauthorizedAllowed))},directives:[h.p,m.b,g.a,f.b,f.a,L],pipes:[D.a,n.c],encapsulation:2,changeDetection:0}),t})(),children:[{path:"",pathMatch:"full",redirectTo:"debits"},{path:"debits",component:L}]}];let V=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.Mb({type:t}),t.\u0275inj=d.Lb({imports:[[r.g.forChild(z)],r.g]}),t})(),q=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.Mb({type:t}),t.\u0275inj=d.Lb({providers:[S,a.a],imports:[[o.a,s.d,V,n.b.forChild()]]}),t})()}}]);