"use strict";(self.webpackChunkegritos_group_eg_web_apps=self.webpackChunkegritos_group_eg_web_apps||[]).push([[906],{35906:function(t,e,s){s.r(e),s.d(e,{TautotitaOfeilisModule:function(){return P}});var i=s(43645),n=s(29790),r=s(23292),a=s(88052),o=s(54655),u=s(68214),l=s(79765),d=s(46782),h=s(37716),p=s(87622),c=s(12622),m=s(38583),g=s(3379),f=s(24020),y=s(44748),b=s(21571),_=(()=>((_||(_={})).paymentCode="\u039a\u03c9\u03b4\u03b9\u03ba\u03cc\u03c2",_))(),A=(()=>((A||(A={})).paymentCode="Payment Code",A))(),C=s(84608),x=s(91841);let w=(()=>{class t{constructor(t,e){this.http=t,this.toasterSrv=e,this.apiUrl=AppConfOptions.eidopoiitiria_api+"api/"}getEidopoiitiria(t){return this.http.post(this.apiUrl+"Atm/Eidopoiitiria",t)}}return t.\u0275fac=function(e){return new(e||t)(h.LFG(x.eN),h.LFG(u.MJ))},t.\u0275prov=h.Yz7({token:t,factory:t.\u0275fac}),t})();var v=s(3679);const Z=["tautotitaOfeilisForm"];function S(t,e){if(1&t&&h._UZ(0,"p-message",16),2&t){const t=h.oxw(2);h.Q6J("severity",t.bankStatusMessageClass)("text",t.bankStatusMessage)("styleClass","mb-2")}}function M(t,e){if(1&t&&h._UZ(0,"p-message",17),2&t){const t=h.oxw(2);h.Q6J("styleClass","mt-2 form-msgs")("escape",!1)("text",t.formErrorsMsg)}}function k(t,e){if(1&t&&(h.TgZ(0,"p",22),h._uU(1,"\u039a\u03c9\u03b4\u03b9\u03ba\u03cc\u03c2 \u03a0\u03bb\u03b7\u03c1\u03c9\u03bc\u03ae\u03c2: "),h.TgZ(2,"span",23),h._uU(3),h.qZA(),h.qZA()),2&t){const t=h.oxw(3);h.xp6(3),h.Oqu(t.model.paymentCode)}}function O(t,e){if(1&t&&(h.TgZ(0,"p",22),h._uU(1,"\u03a3\u03c4\u03bf\u03b9\u03c7\u03b5\u03af\u03b1 \u039f\u03c6\u03b5\u03b9\u03bb\u03ae\u03c2: "),h.TgZ(2,"span",23),h._uU(3),h.qZA(),h.qZA()),2&t){const t=h.oxw(3);h.xp6(3),h.Oqu(t.model.paymentCaption)}}function E(t,e){if(1&t&&(h.TgZ(0,"p",22),h._uU(1,"\u03a3\u03c5\u03bd\u03bf\u03bb\u03b9\u03ba\u03cc \u03a0\u03bf\u03c3\u03cc \u039f\u03c6\u03b5\u03b9\u03bb\u03ae\u03c2: "),h.TgZ(2,"span",23),h._uU(3),h.ALo(4,"currency"),h.qZA(),h.qZA()),2&t){const t=h.oxw(3);h.xp6(3),h.Oqu(h.gM2(4,1,t.model.paymentAmount,"\u20ac","symbol","1.2"))}}function J(t,e){if(1&t){const t=h.EpF();h.ynx(0),h._UZ(1,"hr"),h.TgZ(2,"h5",18),h._uU(3),h.ALo(4,"translate"),h.qZA(),h.TgZ(5,"div",19),h.TgZ(6,"div"),h.YNc(7,k,4,1,"p",20),h.YNc(8,O,4,1,"p",20),h.YNc(9,E,5,6,"p",20),h.qZA(),h.TgZ(10,"app-checkout",21),h.NdJ("onPayBtnClick",function(e){return h.CHM(t),h.oxw(2).onCreatePaymentRequest(e)}),h.qZA(),h.qZA(),h.BQk()}if(2&t){const t=h.oxw(2);h.xp6(3),h.Oqu(h.lcZ(4,9,null==t.translation?null:t.translation.egwebapps.egrResults)),h.xp6(4),h.Q6J("ngIf",t.model.paymentCode),h.xp6(1),h.Q6J("ngIf",t.model.paymentCaption),h.xp6(1),h.Q6J("ngIf",t.model.paymentAmount),h.xp6(1),h.Q6J("isPaymentFormValid",!0)("doPaymentSubscription",t.onDoPaymentSubject.asObservable())("finApiUrl",t.financeApiUrl)("buttonText",t.translation.egwebapps.egrPaymentBtnText)("cancelButtonText",t.translation.egwebapps.egrCancelBtn)}}function T(t,e){if(1&t){const t=h.EpF();h.ynx(0),h.YNc(1,S,1,3,"p-message",2),h.TgZ(2,"form",3,4),h.TgZ(4,"div",5),h.TgZ(5,"div",6),h.TgZ(6,"label",7),h._uU(7),h.ALo(8,"translate"),h.qZA(),h.TgZ(9,"input",8),h.NdJ("ngModelChange",function(e){return h.CHM(t),h.oxw().paymentCode=e}),h.ALo(10,"translate"),h.qZA(),h.TgZ(11,"div",9),h._uU(12),h.ALo(13,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(14,"div",10),h.TgZ(15,"button",11),h.NdJ("click",function(){return h.CHM(t),h.oxw().onSubmit()}),h._UZ(16,"span",12),h._uU(17),h.ALo(18,"translate"),h.qZA(),h.TgZ(19,"button",13),h.NdJ("click",function(){return h.CHM(t),h.oxw().onClear()}),h._UZ(20,"span",14),h._uU(21),h.ALo(22,"translate"),h.qZA(),h.qZA(),h.YNc(23,M,1,3,"p-message",15),h.qZA(),h._UZ(24,"lib-egr-loading",0),h.YNc(25,J,11,11,"ng-container",1),h.BQk()}if(2&t){const t=h.oxw();h.xp6(1),h.Q6J("ngIf",t.bankStatusMessage&&""!=t.bankStatusMessage),h.xp6(6),h.hij("",h.lcZ(8,14,null==t.translation?null:t.translation.eidopoiitiria.code),"*"),h.xp6(2),h.Q6J("placeholder",h.lcZ(10,16,null==t.translation?null:t.translation.eidopoiitiria.code))("ngModel",t.paymentCode)("disabled",t.model),h.xp6(2),h.Q6J("hidden",!t.isFormSubmitted||t.isFormSubmitted&&t.paymentCode),h.xp6(1),h.hij(" *",h.lcZ(13,18,null==t.translation?null:t.translation.egwebapps.egrRequiredField)," "),h.xp6(3),h.Q6J("disabled",t.model),h.xp6(2),h.hij(" ",h.lcZ(18,20,null==t.translation?null:t.translation.egwebapps.egrSearchBtn)," "),h.xp6(4),h.hij(" ",h.lcZ(22,22,null==t.translation?null:t.translation.egwebapps.egrClearBtn)," "),h.xp6(2),h.Q6J("ngIf",t.formErrorsMsg&&""!=t.formErrorsMsg),h.xp6(1),h.Q6J("condition",t.isLoadingInit)("customClass","egr-load-small"),h.xp6(1),h.Q6J("ngIf",t.model&&!t.isLoading)}}let L=(()=>{class t{constructor(t,e,s,i,n,r,a,o,u){this.oidcSecuritySrv=t,this.epaymentsSrv=e,this.egPaymentSrv=s,this.tautotitaOfeilisSrv=i,this.cookieSrv=n,this.toasterSrv=r,this.appCacheSv=a,this.cdr=o,this.route=u,this.countriesList=[],this.onDoPaymentSubject=new l.xQ,this.onDestroy=new l.xQ,this.isLoading=!1,this.isLoadingInit=!1,this.errorMessageProfile=null,this.oikonomikiBankMessagesEn=C.Px,this.isFormSubmitted=!1}ngOnInit(){this.appCacheSv.translation$.pipe((0,d.R)(this.onDestroy)).subscribe(t=>{t&&(this.translation=t,(0,u.RA)(this.cdr))}),this.appCacheSv.selectedLang$.pipe((0,d.R)(this.onDestroy)).subscribe(t=>{t&&(this.selectedLang=t,this.formDictionaryEnum="el"==this.selectedLang?_:A,(0,u.RA)(this.cdr))}),this.isLoadingInit=!0,(0,u.RA)(this.cdr),"undefined"!=typeof AuthConfOptions&&AppConfOptions&&AppConfOptions.epayments_api&&(this.financeApiUrl=(0,u.Qj)(AppConfOptions.epayments_api)),this.route.queryParams.pipe((0,d.R)(this.onDestroy)).subscribe(t=>{var e;if(t){let e=t;if(e.messagecode||e.paymentStatus){let t=e.messagecode?e.messagecode:e.paymentStatus;this.bankStatusMessage="el"==this.selectedLang?this.oikonomikiBankMessages[t]:this.oikonomikiBankMessagesEn[t],this.bankStatusMessageClass="TRANSACTION_COMPLETED"==t||"APPROVED"==t?"success":"error"}}else this.toasterSrv.showError("",null===(e=this.translation)||void 0===e?void 0:e.egwebapps.egrProblemFound);(0,u.RA)(this.cdr)}),this.appCacheSv.initCountries(AuthConfOptions.stsServer+"/api/general/GetCountries"),(0,b.$R)(this.epaymentsSrv.getBankMessages(),this.oidcSecuritySrv.userData$,this.appCacheSv.countries$).subscribe(t=>{t&&(t[0]&&(this.oikonomikiBankMessages=t[0]),t[1]&&(this.user=t[1],this.user.email=(0,u.Ew)(this.user.email)?this.user.email:this.user.email.trim(),this.user.username=(0,u.Ew)(this.user.username)?this.user.username:this.user.username.trim(),this.user.tin=(0,u.Ew)(this.user.tin)?this.user.tin:this.user.tin.trim(),this.user.family_name=(0,u.Ew)(this.user.family_name)?this.user.family_name:this.user.family_name.trim(),this.user.given_name=(0,u.Ew)(this.user.given_name)?this.user.given_name:this.user.given_name.trim(),this.user.fathers_name=(0,u.Ew)(this.user.fathers_name)?this.user.fathers_name:this.user.fathers_name.trim(),this.user.mothers_name=(0,u.Ew)(this.user.mothers_name)?this.user.mothers_name:this.user.mothers_name.trim(),this.user.name=(0,u.Ew)(this.user.name)?this.user.name:this.user.name.trim(),this.user.address_city=(0,u.Ew)(this.user.address_city)?this.user.address_city:this.user.address_city.trim(),this.user.address_country_code=(0,u.Ew)(this.user.address_country_code)?this.user.address_country_code:this.user.address_country_code.trim(),this.user.address_country_num=(0,u.Ew)(this.user.address_country_num)?this.user.address_country_num:this.user.address_country_num.trim(),this.user.address_zip=(0,u.Ew)(this.user.address_zip)?this.user.address_zip:this.user.address_zip.trim(),this.user.address=(0,u.Ew)(this.user.address)?this.user.address:this.user.address.trim(),this.user.adt=(0,u.Ew)(this.user.adt)?this.user.adt:this.user.adt.trim(),this.user.phone_number=(0,u.Ew)(this.user.phone_number)?this.user.phone_number:this.user.phone_number.trim()),t[2]&&(this.countriesList=t[2],this.user&&this.user.address_country_code&&""!=this.user.address_country_code&&(this.user.address_country_num=this.countriesList.find(t=>t.Alpha2Code==this.user.address_country_code).NumericCode.toString()))),this.isLoadingInit=!1,(0,u.RA)(this.cdr)})}ngOnDestroy(){this.onDestroy.next(null)}onSubmit(){if(this.isFormSubmitted=!0,this.formErrorsMsg=null,(0,u.RA)(this.cdr),this.isFormSubmitted&&this.tautotitaOfeilisForm.valid){this.model=null,this.isLoading=!0;let t={language:"el",kodikos:this.paymentCode};(0,u.RA)(this.cdr),this.tautotitaOfeilisSrv.getEidopoiitiria(t).subscribe(t=>{t&&t.isSuccessful?this.model=t.result:(this.toasterSrv.showError("",t.errorDescription),this.errorMessage=t.errorDescription),this.isLoading=!1,(0,u.RA)(this.cdr)})}else this.formErrorsMsg=(0,u.CD)(this.tautotitaOfeilisForm,this.formDictionaryEnum,""),(0,u.RA)(this.cdr)}onCreatePaymentRequest(t){if((0,u.Ew)(this.user.email))this.toasterSrv.showWarning("","\u0395\u03af\u03bd\u03b1\u03b9 \u03b1\u03c0\u03b1\u03c1\u03b1\u03af\u03c4\u03b7\u03c4\u03bf \u03c4\u03bf email \u03c3\u03b1\u03c2 \u03c3\u03c4\u03b7 \u03c3\u03b5\u03bb\u03af\u03b4\u03b1 \u03c4\u03bf\u03c5 \u03c0\u03c1\u03bf\u03c6\u03af\u03bb \u03c3\u03b1\u03c2.");else{let e={tinRelated:this.user.tin,relatedCallbackUrl:AppConfOptions.application_url+"/tautotita-ofeilis/debits",billingAddressCity:this.user.address_city,billingAddressCountryCode:this.user.address_country_code,billingAddressZip:this.user.address_zip,billingAddress:this.user.address,userEmail:this.user.email,userPhone:this.user.phone_number,paymentMethodKey:t.key,entries:[]};"PIRBGRAA"===t.key&&(e.billingAddressCountryCode=null),e.entries.push({remittanceInfo:this.model.paymentCode,amount:this.model.paymentAmount,debtorName:this.user.family_name+" "+this.user.fathers_name+" "+this.user.mothers_name+" "+this.user.name,tin:this.user.tin,description:this.model.paymentCaption}),this.paymentRequestDto=e,this.egPaymentSrv.addPaymentRequest(this.financeApiUrl,this.paymentRequestDto).subscribe(t=>{t?(this.paymentResponseDto=t,this.onDoPaymentSubject.next(this.paymentResponseDto)):this.toasterSrv.showError("",this.translation.egwebapps.egrPaymentProblemFound)})}}onClear(){this.isFormSubmitted=!1,this.paymentCode=null,this.model=null,(0,u.RA)(this.cdr)}}return t.\u0275fac=function(e){return new(e||t)(h.Y36(p.J_),h.Y36(r.C),h.Y36(u.te),h.Y36(w),h.Y36(u.N_),h.Y36(u.MJ),h.Y36(c.g),h.Y36(h.sBO),h.Y36(o.gz))},t.\u0275cmp=h.Xpm({type:t,selectors:[["app-tautotita-ofeilis-debits"]],viewQuery:function(t,e){if(1&t&&h.Gf(Z,5),2&t){let t;h.iGM(t=h.CRH())&&(e.tautotitaOfeilisForm=t.first)}},inputs:{isAuthorized:"isAuthorized"},decls:2,vars:3,consts:[[3,"condition","customClass"],[4,"ngIf"],[3,"severity","text","styleClass",4,"ngIf"],[1,"form"],["tautotitaOfeilisForm","ngForm"],[1,"row"],[1,"form-group","col-12"],["for","paymentCode"],["name","paymentCode","type","text","required","",1,"form-control",3,"placeholder","ngModel","disabled","ngModelChange"],[1,"validation-msg","text-danger","pt-1",3,"hidden"],[1,"d-flex","align-items-center","justify-content-center","flex-wrap"],["type","button",1,"btn","btn-primary","mr-1",3,"disabled","click"],["aria-hidden","true",1,"fas","fa-search","fa-fw"],["type","button",1,"btn","btn-warning","text-white",3,"click"],["aria-hidden","true",1,"fas","fa-times","fa-fw"],["severity","error",3,"styleClass","escape","text",4,"ngIf"],[3,"severity","text","styleClass"],["severity","error",3,"styleClass","escape","text"],[1,"mt-4","text-center"],[1,"debits-info","d-flex","flex-wrap","justify-content-between","w-100","align-items-center"],["class","mb-0",4,"ngIf"],[3,"isPaymentFormValid","doPaymentSubscription","finApiUrl","buttonText","cancelButtonText","onPayBtnClick"],[1,"mb-0"],[1,"totalPoso"]],template:function(t,e){1&t&&(h._UZ(0,"lib-egr-loading",0),h.YNc(1,T,26,24,"ng-container",1)),2&t&&(h.Q6J("condition",e.isLoadingInit)("customClass","egr-load-small"),h.xp6(1),h.Q6J("ngIf",!e.isLoadingInit))},directives:[u.IE,m.O5,v._Y,v.JL,v.F,v.Fj,v.Q7,v.JJ,v.On,g.q,u.Hl],pipes:[n.X$,m.H9],encapsulation:2,changeDetection:0}),t})();var q=s(41886);function R(t,e){if(1&t&&h._UZ(0,"p-message",3),2&t){const t=h.oxw();h.Q6J("text",null==t.translation?null:t.translation.egwebapps.egwebappsLoginMesg)}}function I(t,e){if(1&t&&(h.TgZ(0,"p-panel",4),h._UZ(1,"div",5),h.ALo(2,"decodeHtmlString"),h.qZA()),2&t){const t=h.oxw();h.Q6J("styleClass","tab-msg mb-3")("toggleable",!0),h.xp6(1),h.Q6J("innerHTML",h.lcZ(2,3,t.tabMsg),h.oJD)}}function U(t,e){if(1&t){const t=h.EpF();h.TgZ(0,"p-tabView",6),h.NdJ("onChange",function(e){return h.CHM(t),h.oxw().onTabChanged(e)}),h.TgZ(1,"p-tabPanel",7),h.ALo(2,"translate"),h._UZ(3,"app-tautotita-ofeilis-debits"),h.qZA(),h.qZA()}if(2&t){const t=h.oxw();h.Q6J("activeIndex",t.index),h.xp6(1),h.Q6J("header",h.lcZ(2,2,null==t.translation?null:t.translation.menu.katastimataTabTitle))}}const Q=[{path:"",component:(()=>{class t{constructor(t,e,s,i,n,r){this.oidcSecuritySrv=t,this.appCacheSv=e,this.location=s,this.cdr=i,this.router=n,this.route=r,this.onDestroy=new l.xQ,this.index=0,this.isUnauthorizedAllowed=AppConfOptions.unauthorized_allowed,this.selectedLang="el"}ngOnInit(){this.appCacheSv.translation$.pipe((0,d.R)(this.onDestroy)).subscribe(t=>{t&&(this.translation=t,(0,u.RA)(this.cdr))}),this.appCacheSv.selectedLang$.pipe((0,d.R)(this.onDestroy)).subscribe(t=>{t&&(this.selectedLang=t),1==AppConfOptions.multilingual&&"el"!=this.selectedLang&&AppConfOptions.eidopoiitiria_tab_info_en&&""!=AppConfOptions.eidopoiitiria_tab_info_en?this.tabMsg=AppConfOptions.eidopoiitiria_tab_info_en:AppConfOptions.eidopoiitiria_tab_info&&""!=AppConfOptions.eidopoiitiria_tab_info&&"el"==this.selectedLang&&(this.tabMsg=AppConfOptions.eidopoiitiria_tab_info),(0,u.RA)(this.cdr)}),this.oidcSecuritySrv.isAuthenticated$.subscribe(t=>{this.isAuthorized=t,(0,u.RA)(this.cdr)}),this.index="receipts"===this.route.children[0].snapshot.url[0].path?1:0,(0,u.RA)(this.cdr)}ngOnDestroy(){this.onDestroy.next(null)}onTabChanged(t){this.router.navigate(0==t.index?["./debits"]:["./receipts"],{relativeTo:this.route})}}return t.\u0275fac=function(e){return new(e||t)(h.Y36(p.J_),h.Y36(c.g),h.Y36(m.Ye),h.Y36(h.sBO),h.Y36(o.F0),h.Y36(o.gz))},t.\u0275cmp=h.Xpm({type:t,selectors:[["app-tautotita-ofeilis-layout"]],inputs:{isAuthorized:"isAuthorized"},decls:3,vars:3,consts:[["severity","warn",3,"text",4,"ngIf"],["header","\u03a0\u03bb\u03b7\u03c1\u03bf\u03c6\u03bf\u03c1\u03af\u03b5\u03c2",3,"styleClass","toggleable",4,"ngIf"],[3,"activeIndex","onChange",4,"ngIf"],["severity","warn",3,"text"],["header","\u03a0\u03bb\u03b7\u03c1\u03bf\u03c6\u03bf\u03c1\u03af\u03b5\u03c2",3,"styleClass","toggleable"],[3,"innerHTML"],[3,"activeIndex","onChange"],[3,"header"]],template:function(t,e){1&t&&(h.YNc(0,R,1,1,"p-message",0),h.YNc(1,I,3,5,"p-panel",1),h.YNc(2,U,4,4,"p-tabView",2)),2&t&&(h.Q6J("ngIf",!e.isAuthorized&&!e.isUnauthorizedAllowed),h.xp6(1),h.Q6J("ngIf",e.isAuthorized&&e.tabMsg&&""!=e.tabMsg),h.xp6(1),h.Q6J("ngIf",e.isAuthorized||e.isUnauthorizedAllowed))},directives:[m.O5,g.q,f.s,y.xf,y.x4,L],pipes:[q.o,n.X$],encapsulation:2,changeDetection:0}),t})(),children:[{path:"",pathMatch:"full",redirectTo:"debits"},{path:"debits",component:L}]}];let D=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=h.oAB({type:t}),t.\u0275inj=h.cJS({imports:[[o.Bz.forChild(Q)],o.Bz]}),t})(),P=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=h.oAB({type:t}),t.\u0275inj=h.cJS({providers:[w,r.C],imports:[[a.m,i.IJ,D,n.aw.forChild()]]}),t})()}}]);