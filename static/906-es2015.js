"use strict";(self.webpackChunkegritos_group_eg_web_apps=self.webpackChunkegritos_group_eg_web_apps||[]).push([[906],{35906:function(t,e,s){s.r(e),s.d(e,{TautotitaOfeilisModule:function(){return I}});var i=s(43645),n=s(29790),r=s(23292),a=s(88052),o=s(54655),u=s(68214),l=s(79765),h=s(46782),d=s(37716),p=s(87622),c=s(12622),m=s(38583),g=s(21571),f=(()=>((f||(f={})).paymentCode="\u039a\u03c9\u03b4\u03b9\u03ba\u03cc\u03c2",f))(),y=(()=>((y||(y={})).paymentCode="Payment Code",y))(),_=s(84608),b=s(91841);let A=(()=>{class t{constructor(t,e){this.http=t,this.toasterSrv=e,this.apiUrl=AppConfOptions.eidopoiitiria_api+"api/"}getEidopoiitiria(t){return this.http.post(this.apiUrl+"Atm/Eidopoiitiria",t)}}return t.\u0275fac=function(e){return new(e||t)(d.LFG(b.eN),d.LFG(u.MJ))},t.\u0275prov=d.Yz7({token:t,factory:t.\u0275fac}),t})();var C=s(3679),w=s(3379);const x=["tautotitaOfeilisForm"];function v(t,e){if(1&t&&d._UZ(0,"p-message",16),2&t){const t=d.oxw(2);d.Q6J("severity",t.bankStatusMessageClass)("text",t.bankStatusMessage)("styleClass","mb-2")}}function Z(t,e){if(1&t&&d._UZ(0,"p-message",17),2&t){const t=d.oxw(2);d.Q6J("styleClass","mt-2 form-msgs")("escape",!1)("text",t.formErrorsMsg)}}function S(t,e){if(1&t&&(d.TgZ(0,"p",22),d._uU(1,"\u039a\u03c9\u03b4\u03b9\u03ba\u03cc\u03c2 \u03a0\u03bb\u03b7\u03c1\u03c9\u03bc\u03ae\u03c2: "),d.TgZ(2,"span",23),d._uU(3),d.qZA(),d.qZA()),2&t){const t=d.oxw(3);d.xp6(3),d.Oqu(t.model.paymentCode)}}function M(t,e){if(1&t&&(d.TgZ(0,"p",22),d._uU(1,"\u03a3\u03c4\u03bf\u03b9\u03c7\u03b5\u03af\u03b1 \u039f\u03c6\u03b5\u03b9\u03bb\u03ae\u03c2: "),d.TgZ(2,"span",23),d._uU(3),d.qZA(),d.qZA()),2&t){const t=d.oxw(3);d.xp6(3),d.Oqu(t.model.paymentCaption)}}function O(t,e){if(1&t&&(d.TgZ(0,"p",22),d._uU(1,"\u03a3\u03c5\u03bd\u03bf\u03bb\u03b9\u03ba\u03cc \u03a0\u03bf\u03c3\u03cc \u039f\u03c6\u03b5\u03b9\u03bb\u03ae\u03c2: "),d.TgZ(2,"span",23),d._uU(3),d.ALo(4,"currency"),d.qZA(),d.qZA()),2&t){const t=d.oxw(3);d.xp6(3),d.Oqu(d.gM2(4,1,t.model.paymentAmount,"\u20ac","symbol","1.2"))}}function k(t,e){if(1&t){const t=d.EpF();d.ynx(0),d._UZ(1,"hr"),d.TgZ(2,"h5",18),d._uU(3),d.ALo(4,"translate"),d.qZA(),d.TgZ(5,"div",19),d.TgZ(6,"div"),d.YNc(7,S,4,1,"p",20),d.YNc(8,M,4,1,"p",20),d.YNc(9,O,5,6,"p",20),d.qZA(),d.TgZ(10,"app-checkout",21),d.NdJ("onPayBtnClick",function(e){return d.CHM(t),d.oxw(2).onCreatePaymentRequest(e)}),d.qZA(),d.qZA(),d.BQk()}if(2&t){const t=d.oxw(2);d.xp6(3),d.Oqu(d.lcZ(4,9,null==t.translation?null:t.translation.egwebapps.egrResults)),d.xp6(4),d.Q6J("ngIf",t.model.paymentCode),d.xp6(1),d.Q6J("ngIf",t.model.paymentCaption),d.xp6(1),d.Q6J("ngIf",t.model.paymentAmount),d.xp6(1),d.Q6J("isPaymentFormValid",!0)("doPaymentSubscription",t.onDoPaymentSubject.asObservable())("finApiUrl",t.financeApiUrl)("buttonText",t.translation.egwebapps.egrPaymentBtnText)("cancelButtonText",t.translation.egwebapps.egrCancelBtn)}}function E(t,e){if(1&t){const t=d.EpF();d.ynx(0),d.YNc(1,v,1,3,"p-message",2),d.TgZ(2,"form",3,4),d.TgZ(4,"div",5),d.TgZ(5,"div",6),d.TgZ(6,"label",7),d._uU(7),d.ALo(8,"translate"),d.qZA(),d.TgZ(9,"input",8),d.NdJ("ngModelChange",function(e){return d.CHM(t),d.oxw().paymentCode=e}),d.ALo(10,"translate"),d.qZA(),d.TgZ(11,"div",9),d._uU(12),d.ALo(13,"translate"),d.qZA(),d.qZA(),d.qZA(),d.TgZ(14,"div",10),d.TgZ(15,"button",11),d.NdJ("click",function(){return d.CHM(t),d.oxw().onSubmit()}),d._UZ(16,"span",12),d._uU(17),d.ALo(18,"translate"),d.qZA(),d.TgZ(19,"button",13),d.NdJ("click",function(){return d.CHM(t),d.oxw().onClear()}),d._UZ(20,"span",14),d._uU(21),d.ALo(22,"translate"),d.qZA(),d.qZA(),d.YNc(23,Z,1,3,"p-message",15),d.qZA(),d._UZ(24,"lib-egr-loading",0),d.YNc(25,k,11,11,"ng-container",1),d.BQk()}if(2&t){const t=d.oxw();d.xp6(1),d.Q6J("ngIf",t.bankStatusMessage&&""!=t.bankStatusMessage),d.xp6(6),d.hij("",d.lcZ(8,14,null==t.translation?null:t.translation.eidopoiitiria.code),"*"),d.xp6(2),d.Q6J("placeholder",d.lcZ(10,16,null==t.translation?null:t.translation.eidopoiitiria.code))("ngModel",t.paymentCode)("disabled",t.model),d.xp6(2),d.Q6J("hidden",!t.isFormSubmitted||t.isFormSubmitted&&t.paymentCode),d.xp6(1),d.hij(" *",d.lcZ(13,18,null==t.translation?null:t.translation.egwebapps.egrRequiredField)," "),d.xp6(3),d.Q6J("disabled",t.model),d.xp6(2),d.hij(" ",d.lcZ(18,20,null==t.translation?null:t.translation.egwebapps.egrSearchBtn)," "),d.xp6(4),d.hij(" ",d.lcZ(22,22,null==t.translation?null:t.translation.egwebapps.egrClearBtn)," "),d.xp6(2),d.Q6J("ngIf",t.formErrorsMsg&&""!=t.formErrorsMsg),d.xp6(1),d.Q6J("condition",t.isLoadingInit)("customClass","egr-load-small"),d.xp6(1),d.Q6J("ngIf",t.model&&!t.isLoading)}}let q=(()=>{class t{constructor(t,e,s,i,n,r,a,o,u){this.oidcSecuritySrv=t,this.epaymentsSrv=e,this.egPaymentSrv=s,this.tautotitaOfeilisSrv=i,this.cookieSrv=n,this.toasterSrv=r,this.appCacheSv=a,this.cdr=o,this.route=u,this.countriesList=[],this.onDoPaymentSubject=new l.xQ,this.onDestroy=new l.xQ,this.isLoading=!1,this.isLoadingInit=!1,this.errorMessageProfile=null,this.oikonomikiBankMessagesEn=_.Px,this.isFormSubmitted=!1}ngOnInit(){this.appCacheSv.translation$.pipe((0,h.R)(this.onDestroy)).subscribe(t=>{t&&(this.translation=t,(0,u.RA)(this.cdr))}),this.appCacheSv.selectedLang$.pipe((0,h.R)(this.onDestroy)).subscribe(t=>{t&&(this.selectedLang=t,this.formDictionaryEnum="el"==this.selectedLang?f:y,(0,u.RA)(this.cdr))}),this.isLoadingInit=!0,(0,u.RA)(this.cdr),"undefined"!=typeof AuthConfOptions&&AppConfOptions&&AppConfOptions.epayments_api&&(this.financeApiUrl=(0,u.Qj)(AppConfOptions.epayments_api)),this.route.queryParams.pipe((0,h.R)(this.onDestroy)).subscribe(t=>{var e;if(t){let e=t;if(e.messagecode||e.paymentStatus){let t=e.messagecode?e.messagecode:e.paymentStatus;this.bankStatusMessage="el"==this.selectedLang?this.oikonomikiBankMessages[t]:this.oikonomikiBankMessagesEn[t],this.bankStatusMessageClass="TRANSACTION_COMPLETED"==t||"APPROVED"==t?"success":"error"}}else this.toasterSrv.showError("",null===(e=this.translation)||void 0===e?void 0:e.egwebapps.egrProblemFound);(0,u.RA)(this.cdr)}),this.appCacheSv.initCountries(AuthConfOptions.stsServer+"/api/general/GetCountries"),(0,g.$R)(this.epaymentsSrv.getBankMessages(),this.oidcSecuritySrv.userData$,this.appCacheSv.countries$).subscribe(t=>{t&&(t[0]&&(this.oikonomikiBankMessages=t[0]),t[1]&&(this.user=t[1],this.user.email=(0,u.Ew)(this.user.email)?this.user.email:this.user.email.trim(),this.user.username=(0,u.Ew)(this.user.username)?this.user.username:this.user.username.trim(),this.user.tin=(0,u.Ew)(this.user.tin)?this.user.tin:this.user.tin.trim(),this.user.family_name=(0,u.Ew)(this.user.family_name)?this.user.family_name:this.user.family_name.trim(),this.user.given_name=(0,u.Ew)(this.user.given_name)?this.user.given_name:this.user.given_name.trim(),this.user.fathers_name=(0,u.Ew)(this.user.fathers_name)?this.user.fathers_name:this.user.fathers_name.trim(),this.user.mothers_name=(0,u.Ew)(this.user.mothers_name)?this.user.mothers_name:this.user.mothers_name.trim(),this.user.name=(0,u.Ew)(this.user.name)?this.user.name:this.user.name.trim(),this.user.address_city=(0,u.Ew)(this.user.address_city)?this.user.address_city:this.user.address_city.trim(),this.user.address_country_code=(0,u.Ew)(this.user.address_country_code)?this.user.address_country_code:this.user.address_country_code.trim(),this.user.address_country_num=(0,u.Ew)(this.user.address_country_num)?this.user.address_country_num:this.user.address_country_num.trim(),this.user.address_zip=(0,u.Ew)(this.user.address_zip)?this.user.address_zip:this.user.address_zip.trim(),this.user.address=(0,u.Ew)(this.user.address)?this.user.address:this.user.address.trim(),this.user.adt=(0,u.Ew)(this.user.adt)?this.user.adt:this.user.adt.trim(),this.user.phone_number=(0,u.Ew)(this.user.phone_number)?this.user.phone_number:this.user.phone_number.trim()),t[2]&&(this.countriesList=t[2],this.user&&this.user.address_country_code&&""!=this.user.address_country_code&&(this.user.address_country_num=this.countriesList.find(t=>t.Alpha2Code==this.user.address_country_code).NumericCode.toString()))),this.isLoadingInit=!1,(0,u.RA)(this.cdr)})}ngOnDestroy(){this.onDestroy.next(null)}onSubmit(){if(this.isFormSubmitted=!0,this.formErrorsMsg=null,(0,u.RA)(this.cdr),this.isFormSubmitted&&this.tautotitaOfeilisForm.valid){this.model=null,this.isLoading=!0;let t={language:"el",kodikos:this.paymentCode};(0,u.RA)(this.cdr),this.tautotitaOfeilisSrv.getEidopoiitiria(t).subscribe(t=>{t&&t.isSuccessful?this.model=t.result:(this.toasterSrv.showError("",t.errorDescription),this.errorMessage=t.errorDescription),this.isLoading=!1,(0,u.RA)(this.cdr)})}else this.formErrorsMsg=(0,u.CD)(this.tautotitaOfeilisForm,this.formDictionaryEnum,""),(0,u.RA)(this.cdr)}onCreatePaymentRequest(t){if((0,u.Ew)(this.user.email))this.toasterSrv.showWarning("","\u0395\u03af\u03bd\u03b1\u03b9 \u03b1\u03c0\u03b1\u03c1\u03b1\u03af\u03c4\u03b7\u03c4\u03bf \u03c4\u03bf email \u03c3\u03b1\u03c2 \u03c3\u03c4\u03b7 \u03c3\u03b5\u03bb\u03af\u03b4\u03b1 \u03c4\u03bf\u03c5 \u03c0\u03c1\u03bf\u03c6\u03af\u03bb \u03c3\u03b1\u03c2.");else{let e={tinRelated:this.user.tin,relatedCallbackUrl:AppConfOptions.application_url+"/tautotita-ofeilis/debits",billingAddressCity:this.user.address_city,billingAddressCountryCode:this.user.address_country_code,billingAddressZip:this.user.address_zip,billingAddress:this.user.address,userEmail:this.user.email,userPhone:this.user.phone_number,paymentMethodKey:t.key,entries:[]};"PIRBGRAA"===t.key&&(e.billingAddressCountryCode=null),e.entries.push({remittanceInfo:this.model.paymentCode,amount:this.model.paymentAmount,debtorName:this.user.family_name+" "+this.user.fathers_name+" "+this.user.mothers_name+" "+this.user.name,tin:this.user.tin,description:this.model.paymentCaption}),this.paymentRequestDto=e,this.egPaymentSrv.addPaymentRequest(this.financeApiUrl,this.paymentRequestDto).subscribe(t=>{t?(this.paymentResponseDto=t,this.onDoPaymentSubject.next(this.paymentResponseDto)):this.toasterSrv.showError("",this.translation.egwebapps.egrPaymentProblemFound)})}}onClear(){this.isFormSubmitted=!1,this.paymentCode=null,this.model=null,(0,u.RA)(this.cdr)}}return t.\u0275fac=function(e){return new(e||t)(d.Y36(p.J_),d.Y36(r.C),d.Y36(u.te),d.Y36(A),d.Y36(u.N_),d.Y36(u.MJ),d.Y36(c.g),d.Y36(d.sBO),d.Y36(o.gz))},t.\u0275cmp=d.Xpm({type:t,selectors:[["app-tautotita-ofeilis-debits"]],viewQuery:function(t,e){if(1&t&&d.Gf(x,5),2&t){let t;d.iGM(t=d.CRH())&&(e.tautotitaOfeilisForm=t.first)}},inputs:{isAuthorized:"isAuthorized"},decls:2,vars:3,consts:[[3,"condition","customClass"],[4,"ngIf"],[3,"severity","text","styleClass",4,"ngIf"],[1,"form"],["tautotitaOfeilisForm","ngForm"],[1,"row"],[1,"form-group","col-12"],["for","paymentCode"],["name","paymentCode","type","text","required","",1,"form-control",3,"placeholder","ngModel","disabled","ngModelChange"],[1,"validation-msg","text-danger","pt-1",3,"hidden"],[1,"d-flex","align-items-center","justify-content-center","flex-wrap"],["type","button",1,"btn","btn-primary","mr-1",3,"disabled","click"],["aria-hidden","true",1,"fas","fa-search","fa-fw"],["type","button",1,"btn","btn-warning","text-white",3,"click"],["aria-hidden","true",1,"fas","fa-times","fa-fw"],["severity","error",3,"styleClass","escape","text",4,"ngIf"],[3,"severity","text","styleClass"],["severity","error",3,"styleClass","escape","text"],[1,"mt-4","text-center"],[1,"debits-info","d-flex","flex-wrap","justify-content-between","w-100","align-items-center"],["class","mb-0",4,"ngIf"],[3,"isPaymentFormValid","doPaymentSubscription","finApiUrl","buttonText","cancelButtonText","onPayBtnClick"],[1,"mb-0"],[1,"totalPoso"]],template:function(t,e){1&t&&(d._UZ(0,"lib-egr-loading",0),d.YNc(1,E,26,24,"ng-container",1)),2&t&&(d.Q6J("condition",e.isLoadingInit)("customClass","egr-load-small"),d.xp6(1),d.Q6J("ngIf",!e.isLoadingInit))},directives:[u.IE,m.O5,C._Y,C.JL,C.F,C.Fj,C.Q7,C.JJ,C.On,w.q,u.Hl],pipes:[n.X$,m.H9],encapsulation:2,changeDetection:0}),t})();var L=s(24020),T=s(41886);function J(t,e){if(1&t&&d._UZ(0,"p-message",4),2&t){const t=d.oxw();d.Q6J("text",null==t.translation?null:t.translation.egwebapps.egwebappsLoginMesg)}}function R(t,e){if(1&t&&(d.TgZ(0,"p-panel",5),d._UZ(1,"div",6),d.ALo(2,"decodeHtmlString"),d.qZA()),2&t){const t=d.oxw();d.Q6J("header",null==t.translation?null:t.translation.egwebapps.information)("styleClass","tab-msg mb-3")("toggleable",!0),d.xp6(1),d.Q6J("innerHTML",d.lcZ(2,4,t.tabMsg),d.oJD)}}const U=[{path:"",component:(()=>{class t{constructor(t,e,s,i,n,r){this.oidcSecuritySrv=t,this.appCacheSv=e,this.location=s,this.cdr=i,this.router=n,this.route=r,this.onDestroy=new l.xQ,this.index=0,this.isUnauthorizedAllowed=AppConfOptions.unauthorized_allowed,this.selectedLang="el"}ngOnInit(){this.appCacheSv.translation$.pipe((0,h.R)(this.onDestroy)).subscribe(t=>{t&&(this.translation=t,(0,u.RA)(this.cdr))}),this.appCacheSv.selectedLang$.pipe((0,h.R)(this.onDestroy)).subscribe(t=>{t&&(this.selectedLang=t),1==AppConfOptions.multilingual&&"el"!=this.selectedLang&&AppConfOptions.eidopoiitiria_tab_info_en&&""!=AppConfOptions.eidopoiitiria_tab_info_en?this.tabMsg=AppConfOptions.eidopoiitiria_tab_info_en:AppConfOptions.eidopoiitiria_tab_info&&""!=AppConfOptions.eidopoiitiria_tab_info&&"el"==this.selectedLang&&(this.tabMsg=AppConfOptions.eidopoiitiria_tab_info),(0,u.RA)(this.cdr)}),this.oidcSecuritySrv.isAuthenticated$.subscribe(t=>{this.isAuthorized=t,(0,u.RA)(this.cdr)}),this.index="receipts"===this.route.children[0].snapshot.url[0].path?1:0,(0,u.RA)(this.cdr)}ngOnDestroy(){this.onDestroy.next(null)}onTabChanged(t){this.router.navigate(0==t.index?["./debits"]:["./receipts"],{relativeTo:this.route})}}return t.\u0275fac=function(e){return new(e||t)(d.Y36(p.J_),d.Y36(c.g),d.Y36(m.Ye),d.Y36(d.sBO),d.Y36(o.F0),d.Y36(o.gz))},t.\u0275cmp=d.Xpm({type:t,selectors:[["app-tautotita-ofeilis-layout"]],inputs:{isAuthorized:"isAuthorized"},decls:6,vars:3,consts:[[1,"module-title"],["severity","warn",3,"text",4,"ngIf"],[3,"header","styleClass","toggleable",4,"ngIf"],[1,"bg-white","p-2"],["severity","warn",3,"text"],[3,"header","styleClass","toggleable"],[3,"innerHTML"]],template:function(t,e){1&t&&(d.TgZ(0,"h3",0),d._uU(1),d.qZA(),d.YNc(2,J,1,1,"p-message",1),d.YNc(3,R,3,6,"p-panel",2),d.TgZ(4,"div",3),d._UZ(5,"app-tautotita-ofeilis-debits"),d.qZA()),2&t&&(d.xp6(1),d.Oqu(null==e.translation?null:e.translation.menu.eidopoiitiriaMenuItem),d.xp6(1),d.Q6J("ngIf",!e.isAuthorized&&!e.isUnauthorizedAllowed),d.xp6(1),d.Q6J("ngIf",e.tabMsg))},directives:[m.O5,q,w.q,L.s],pipes:[T.o],encapsulation:2,changeDetection:0}),t})(),children:[{path:"",pathMatch:"full",redirectTo:"debits"},{path:"debits",component:q}]}];let D=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.oAB({type:t}),t.\u0275inj=d.cJS({imports:[[o.Bz.forChild(U)],o.Bz]}),t})(),I=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.oAB({type:t}),t.\u0275inj=d.cJS({providers:[A,r.C],imports:[[a.m,i.IJ,D,n.aw.forChild()]]}),t})()}}]);