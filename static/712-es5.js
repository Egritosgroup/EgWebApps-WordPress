!function(){"use strict";function e(e,n){var s="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!s){if(Array.isArray(e)||(s=function(e,n){if(!e)return;if("string"==typeof e)return t(e,n);var s=Object.prototype.toString.call(e).slice(8,-1);"Object"===s&&e.constructor&&(s=e.constructor.name);if("Map"===s||"Set"===s)return Array.from(e);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return t(e,n)}(e))||n&&e&&"number"==typeof e.length){s&&(e=s);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,l=!1;return{s:function(){s=s.call(e)},n:function(){var e=s.next();return o=e.done,e},e:function(e){l=!0,r=e},f:function(){try{o||null==s.return||s.return()}finally{if(l)throw r}}}}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function i(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(self.webpackChunkegritos_group_eg_web_apps=self.webpackChunkegritos_group_eg_web_apps||[]).push([[712],{37712:function(t,s,a){a.r(s),a.d(s,{EpaymentsModule:function(){return _e}});var r=a(46019),o=a(29790),l=a(35660),p=a(54655),c=a(68214),u=a(79765),d=a(46782),h=a(43190),g=a(37716),f=a(74868),m=a(12622),y=a(38583),b=a(60394),Z=a(3379),A=a(24020),_=a(44748),x=a(84608),w=a(23292),v=a(35746),T=a(84439),C=a(33013),k=a(3679),q=a(86640),D=a(12332);function S(e,t){if(1&e&&g._UZ(0,"p-message",4),2&e){var n=g.oxw();g.Q6J("text",n.bankStatusMessage)("styleClass","mt-2")}}function O(e,t){if(1&e&&g._UZ(0,"p-message",4),2&e){var n=g.oxw(2);g.Q6J("text",n.translation.epayments.noCheckedDebits)("styleClass","my-2")}}function L(e,t){1&e&&g._UZ(0,"p-message",6),2&e&&g.Q6J("styleClass","my-2")}function R(e,t){1&e&&g.GkF(0)}function U(e,t){if(1&e&&(g.TgZ(0,"div",15),g.YNc(1,R,1,0,"ng-container",16),g.qZA()),2&e){g.oxw(3);var n=g.MAs(4);g.xp6(1),g.Q6J("ngTemplateOutlet",n)}}function M(e,t){if(1&e){var n=g.EpF();g.TgZ(0,"form",17),g.TgZ(1,"label"),g._uU(2),g.ALo(3,"translate"),g.qZA(),g.TgZ(4,"ng-select",18),g.NdJ("ngModelChange",function(e){return g.CHM(n),g.oxw(3).selectedEidosId=e})("ngModelChange",function(e){return g.CHM(n),g.oxw(3).onSelectedPersistedTypeChanged(e)}),g.qZA(),g.qZA()}if(2&e){var s=g.oxw(3);g.xp6(2),g.Oqu(g.lcZ(3,4,s.translation.epayments.debitType)),g.xp6(2),g.Q6J("items",s.eidosDebit)("ngModel",s.selectedEidosId)("clearable",!1)}}function P(e,t){if(1&e&&(g.TgZ(0,"div",19),g.TgZ(1,"span",20),g._UZ(2,"i",21),g._uU(3),g.ALo(4,"translate"),g.qZA(),g.TgZ(5,"span",20),g._UZ(6,"i",22),g._uU(7),g.ALo(8,"translate"),g.qZA(),g.qZA()),2&e){var n=g.oxw(3);g.xp6(3),g.hij(" ",g.lcZ(4,2,n.translation.epayments.persistedDebit),""),g.xp6(4),g.hij(" ",g.lcZ(8,4,n.translation.epayments.nonPersistedDebit),"")}}function I(e,t){if(1&e&&(g.TgZ(0,"th",26),g._uU(1),g.ALo(2,"translate"),g.qZA()),2&e){var n=g.oxw(4);g.xp6(1),g.Oqu(g.lcZ(2,1,n.translation.egwebapps.debitType))}}function E(e,t){if(1&e){var n=g.EpF();g.TgZ(0,"tr"),g.TgZ(1,"th",23),g.TgZ(2,"p-checkbox",24),g.NdJ("ngModelChange",function(e){return g.CHM(n),g.oxw(3).isAllDebitsChecked=e})("onChange",function(){return g.CHM(n),g.oxw(3).onAllDebitsSelected()}),g.qZA(),g.qZA(),g.YNc(3,I,3,3,"th",25),g.TgZ(4,"th",26),g._uU(5),g.ALo(6,"translate"),g.qZA(),g.TgZ(7,"th",27),g._uU(8),g.ALo(9,"translate"),g.qZA(),g.TgZ(10,"th",28),g._uU(11),g.ALo(12,"translate"),g.qZA(),g.TgZ(13,"th",29),g._uU(14),g.ALo(15,"translate"),g._UZ(16,"p-sortIcon",30),g.qZA(),g.TgZ(17,"th",31),g._uU(18),g.ALo(19,"translate"),g._UZ(20,"p-sortIcon",32),g.qZA(),g.TgZ(21,"th",33),g._uU(22),g.ALo(23,"translate"),g._UZ(24,"p-sortIcon",34),g.qZA(),g.TgZ(25,"th",35),g._uU(26),g.ALo(27,"translate"),g._UZ(28,"p-sortIcon",36),g.qZA(),g.qZA()}if(2&e){var s=g.oxw(3);g.xp6(2),g.Q6J("binary",!0)("ngModel",s.isAllDebitsChecked),g.xp6(1),g.Q6J("ngIf",s.isNonPersistedEnabled),g.xp6(2),g.Oqu(g.lcZ(6,10,s.translation.egwebapps.egrAA)),g.xp6(3),g.Oqu(g.lcZ(9,12,s.translation.egwebapps.egrXK)),g.xp6(3),g.Oqu(g.lcZ(12,14,s.translation.egwebapps.description)),g.xp6(3),g.hij("",g.lcZ(15,16,s.translation.egwebapps.egrExpDate)," "),g.xp6(4),g.hij("",g.lcZ(19,18,s.translation.epayments.netPoso)," "),g.xp6(4),g.hij("",g.lcZ(23,20,s.translation.egwebapps.egrOngoingCharges),"* "),g.xp6(4),g.hij("",g.lcZ(27,22,s.translation.egwebapps.egrTotalCost)," ")}}function N(e,t){if(1&e&&(g.TgZ(0,"td",23),g.TgZ(1,"span",37),g._uU(2),g.ALo(3,"translate"),g.qZA(),g._UZ(4,"i",41),g.qZA()),2&e){var n=g.oxw().$implicit,s=g.oxw(3);g.xp6(2),g.Oqu(g.lcZ(3,2,s.translation.egwebapps.debitType)),g.xp6(2),g.Q6J("ngClass",n.isBebaiomeno?"far fa-dot-circle text-success":"fas fa-dot-circle text-warning")}}function J(e,t){if(1&e){var n=g.EpF();g.TgZ(0,"tr"),g.TgZ(1,"td",23),g.TgZ(2,"span",37),g._uU(3),g.ALo(4,"translate"),g.qZA(),g.TgZ(5,"p-checkbox",24),g.NdJ("ngModelChange",function(e){return g.CHM(n).$implicit.isChecked=e})("onChange",function(){return g.CHM(n),g.oxw(3)._calculateTotalAmounts()}),g.qZA(),g.qZA(),g.YNc(6,N,5,4,"td",38),g.TgZ(7,"td",26),g.TgZ(8,"span",37),g._uU(9),g.ALo(10,"translate"),g.qZA(),g._uU(11),g.qZA(),g.TgZ(12,"td",27),g.TgZ(13,"span",37),g._uU(14),g.ALo(15,"translate"),g.qZA(),g._uU(16),g.qZA(),g.TgZ(17,"td",28),g.TgZ(18,"span",37),g._uU(19),g.ALo(20,"translate"),g.qZA(),g._uU(21),g.qZA(),g.TgZ(22,"td",39),g.TgZ(23,"span",37),g._uU(24),g.ALo(25,"translate"),g.qZA(),g._uU(26),g.ALo(27,"date"),g.qZA(),g.TgZ(28,"td",40),g.TgZ(29,"span",37),g._uU(30),g.ALo(31,"translate"),g.qZA(),g._uU(32),g.ALo(33,"currency"),g.qZA(),g.TgZ(34,"td",40),g.TgZ(35,"span",37),g._uU(36),g.ALo(37,"translate"),g.qZA(),g._uU(38),g.ALo(39,"currency"),g.qZA(),g.TgZ(40,"td",40),g.TgZ(41,"span",37),g._uU(42),g.ALo(43,"translate"),g.qZA(),g._uU(44),g.ALo(45,"currency"),g.qZA(),g.qZA()}if(2&e){var s=t.$implicit,i=t.rowIndex,a=g.oxw(3);g.xp6(3),g.Oqu(g.lcZ(4,18,a.translation.egwebapps.egrSelect)),g.xp6(2),g.Q6J("binary",!0)("ngModel",s.isChecked),g.xp6(1),g.Q6J("ngIf",a.isNonPersistedEnabled),g.xp6(3),g.Oqu(g.lcZ(10,20,a.translation.egwebapps.egrAA)),g.xp6(2),g.hij(" ",i+1," "),g.xp6(3),g.Oqu(g.lcZ(15,22,a.translation.egwebapps.egrXK)),g.xp6(2),g.hij(" ",s.aaEggrafis," "),g.xp6(3),g.Oqu(g.lcZ(20,24,a.translation.egwebapps.description)),g.xp6(2),g.hij(" ",s.perigrafi," "),g.xp6(3),g.Oqu(g.lcZ(25,26,a.translation.egwebapps.egrExpDate)),g.xp6(2),g.hij(" ",g.xi3(27,28,s.hmerominiaLixis,"dd/LL/yyyy")," "),g.xp6(4),g.Oqu(g.lcZ(31,31,a.translation.epayments.netPoso)),g.xp6(2),g.hij(" ",g.gM2(33,33,s.currentKatharoPoso,"\u20ac","symbol","1.2")," "),g.xp6(4),g.Oqu(g.lcZ(37,38,a.translation.egwebapps.egrOngoingCharges)),g.xp6(2),g.hij(" ",g.gM2(39,40,s.currentProsafksisi+s.currentKrathseis,"\u20ac","symbol","1.2")," "),g.xp6(4),g.Oqu(g.lcZ(43,45,a.translation.egwebapps.egrTotalCost)),g.xp6(2),g.hij(" ",g.gM2(45,47,s.currentSynolo,"\u20ac","symbol","1.2")," ")}}function F(e,t){if(1&e&&(g.TgZ(0,"tr"),g.TgZ(1,"td"),g._uU(2," \u0394\u03b5\u03bd \u03b2\u03c1\u03ad\u03b8\u03b7\u03ba\u03b1\u03bd \u03b5\u03b3\u03b3\u03c1\u03b1\u03c6\u03ad\u03c2. "),g.qZA(),g.qZA()),2&e){var n=g.oxw(3);g.xp6(1),g.uIk("colspan",n.isNonPersistedEnabled?9:8)}}function Q(e,t){if(1&e&&(g.TgZ(0,"td",45),g.TgZ(1,"strong"),g._uU(2),g.ALo(3,"translate"),g.qZA(),g.qZA()),2&e){var n=g.oxw(4);g.xp6(2),g.AsE("",g.lcZ(3,2,n.translation.egwebapps.egrTotal),": ",null==n.filteredDebits.entries?null:n.filteredDebits.entries.length,"")}}function Y(e,t){if(1&e&&(g.TgZ(0,"td",46),g.TgZ(1,"strong"),g._uU(2),g.ALo(3,"translate"),g.qZA(),g.qZA()),2&e){var n=g.oxw(4);g.xp6(2),g.AsE("",g.lcZ(3,2,n.translation.egwebapps.egrTotal),": ",null==n.filteredDebits.entries?null:n.filteredDebits.entries.length,"")}}function B(e,t){if(1&e&&(g.TgZ(0,"tr"),g.YNc(1,Q,4,4,"td",42),g.YNc(2,Y,4,4,"td",43),g.TgZ(3,"td",44),g.TgZ(4,"strong"),g._uU(5),g.ALo(6,"currency"),g.qZA(),g.qZA(),g.TgZ(7,"td",44),g.TgZ(8,"strong"),g._uU(9),g.ALo(10,"currency"),g.qZA(),g.qZA(),g.TgZ(11,"td",44),g.TgZ(12,"strong"),g._uU(13),g.ALo(14,"currency"),g.qZA(),g.qZA(),g.qZA()),2&e){var n=g.oxw(3);g.xp6(1),g.Q6J("ngIf",!n.isNonPersistedEnabled),g.xp6(1),g.Q6J("ngIf",n.isNonPersistedEnabled),g.xp6(3),g.Oqu(g.gM2(6,5,n.totalCurrentKatharo,"\u20ac","symbol","1.2")),g.xp6(4),g.Oqu(g.gM2(10,10,n.totalCurrentProsafksisi,"\u20ac","symbol","1.2")),g.xp6(4),g.Oqu(g.gM2(14,15,n.totalcurrentSynolo,"\u20ac","symbol","1.2"))}}function j(e,t){if(1&e){var n=g.EpF();g.ynx(0),g.YNc(1,U,2,1,"div",7),g.YNc(2,M,5,6,"form",8),g.TgZ(3,"p-table",9),g.NdJ("sortFunction",function(e){return g.CHM(n),g.oxw(2)._customSort(e)}),g.YNc(4,P,9,6,"ng-template",10),g.YNc(5,E,29,24,"ng-template",11),g.YNc(6,J,46,52,"ng-template",12),g.YNc(7,F,3,1,"ng-template",13),g.YNc(8,B,15,20,"ng-template",14),g.qZA(),g.TgZ(9,"p"),g.TgZ(10,"small"),g.TgZ(11,"em"),g._uU(12),g.ALo(13,"translate"),g.qZA(),g.qZA(),g.qZA(),g.BQk()}if(2&e){var s=g.oxw(2);g.xp6(1),g.Q6J("ngIf",s.calculatedChecked.countChecked>0),g.xp6(1),g.Q6J("ngIf",s.isNonPersistedEnabled),g.xp6(1),g.Q6J("value",s.filteredDebits.entries)("lazy",!1)("lazyLoadOnInit",!1)("rowHover",!0)("paginator",!0)("alwaysShowPaginator",!1)("rows",10)("loading",s.isLoading)("totalRecords",null==s.filteredDebits.entries?null:s.filteredDebits.entries.length)("customSort",!0),g.xp6(9),g.hij("* ",g.lcZ(13,13,s.translation.egwebapps.egrOngoingChargesAndDeductions),"")}}function z(e,t){if(1&e&&(g.TgZ(0,"div"),g.YNc(1,O,1,2,"p-message",1),g.YNc(2,L,1,1,"p-message",5),g.YNc(3,j,14,15,"ng-container",2),g.qZA()),2&e){var n=g.oxw();g.xp6(1),g.Q6J("ngIf",n.filteredDebits.entries&&n.filteredDebits.entries.length&&0===n.calculatedChecked.countChecked&&n.debits.entries),g.xp6(1),g.Q6J("ngIf",n.filteredDebits.entries&&0===n.filteredDebits.entries.length),g.xp6(1),g.Q6J("ngIf",n.filteredDebits.entries)}}function $(e,t){if(1&e){var n=g.EpF();g.TgZ(0,"div",47),g.TgZ(1,"div"),g.TgZ(2,"p",48),g._uU(3),g.ALo(4,"translate"),g.TgZ(5,"span",49),g._uU(6),g.ALo(7,"translate"),g.ALo(8,"translate"),g.qZA(),g.qZA(),g.TgZ(9,"p",48),g._uU(10),g.ALo(11,"translate"),g.TgZ(12,"span",49),g._uU(13),g.ALo(14,"currency"),g.qZA(),g.qZA(),g.TgZ(15,"p",48),g._uU(16),g.ALo(17,"translate"),g.TgZ(18,"span",49),g._uU(19),g.ALo(20,"currency"),g.qZA(),g.qZA(),g.TgZ(21,"p",48),g._uU(22),g.ALo(23,"translate"),g.TgZ(24,"span",50),g._uU(25),g.ALo(26,"currency"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(27,"app-checkout",51),g.NdJ("onPayBtnClick",function(e){return g.CHM(n),g.oxw().onCreatePaymentRequest(e)}),g.qZA(),g.qZA()}if(2&e){var s=g.oxw();g.xp6(3),g.hij("",g.lcZ(4,14,s.translation.egwebapps.egrSelected)," "),g.xp6(3),g.AsE("",s.calculatedChecked.countChecked," ",1===s.calculatedChecked.countChecked?g.lcZ(7,16,s.translation.epayments.debit):g.lcZ(8,18,s.translation.epayments.debits),""),g.xp6(4),g.hij("",g.lcZ(11,20,s.translation.epayments.netPoso),": "),g.xp6(3),g.Oqu(g.gM2(14,22,s.calculatedChecked.checkedKatharo,"\u20ac","symbol","1.2")),g.xp6(3),g.hij("",g.lcZ(17,27,s.translation.egwebapps.egrOngoingCharges),": "),g.xp6(3),g.Oqu(g.gM2(20,29,s.calculatedChecked.checkedEpivarinseis,"\u20ac","symbol","1.2")),g.xp6(3),g.hij("",g.lcZ(23,34,s.translation.epayments.totalChecked),": "),g.xp6(3),g.Oqu(g.gM2(26,36,s.calculatedChecked.checkedSum,"\u20ac","symbol","1.2")),g.xp6(2),g.Q6J("isPaymentFormValid",!0)("doPaymentSubscription",s.onDoPaymentSubject.asObservable())("finApiUrl",s.financeApiUrl)("buttonText",s.translation.egwebapps.egrPaymentBtnText)("cancelButtonText",s.translation.egwebapps.egrCancelBtn)}}var H,K=((H=function(){function t(e,s,i,a,r,o,l){n(this,t),this.toasterSrv=e,this.oidcSecuritySrv=s,this.epaymentsSrv=i,this.egPaymentSrv=a,this.appCacheSv=r,this.cdr=o,this._parent=l,this.countriesList=[],this.onDoPaymentSubject=new u.xQ,this.isMobile=!1,this.bankStatusMessage=null,this.calculatedChecked={countChecked:0,countText:"\u03bf\u03c6\u03b5\u03b9\u03bb\u03ad\u03c2",checkedSum:0,checkedKatharo:0,checkedProsafksisis:0},this.isAllDebitsChecked=!1,this.isLoading=!0,this.eidosDebit=[],this.selectedEidosId=0,this.onDestroy=new u.xQ,this.oikonomikiBankMessagesEn=x.Px}return i(t,[{key:"ngOnInit",value:function(){var e=this;this.appCacheSv.translation$.pipe((0,d.R)(this.onDestroy)).subscribe(function(t){t&&(e.translation=t,(0,c.RA)(e.cdr))}),this.appCacheSv.selectedLang$.pipe((0,d.R)(this.onDestroy)).subscribe(function(t){if(t)switch(e.selectedLang=t,t){case"en":e.eidosDebit=[{value:0,perigrafi:"All"},{value:1,perigrafi:"Persisted Debits"},{value:2,perigrafi:"Non Persisted Debits"}];break;default:e.eidosDebit=[{value:0,perigrafi:"\u038c\u03bb\u03b5\u03c2"},{value:1,perigrafi:"\u0392\u03b5\u03b2\u03b1\u03b9\u03c9\u03bc\u03ad\u03bd\u03b5\u03c2 \u039f\u03c6\u03b5\u03b9\u03bb\u03ad\u03c2"},{value:2,perigrafi:"\u039c\u03b7 \u0392\u03b5\u03b2\u03b1\u03b9\u03c9\u03bc\u03ad\u03bd\u03b5\u03c2 \u039f\u03c6\u03b5\u03b9\u03bb\u03ad\u03c2"}]}}),this.isMobile=this._parent.isMobile,this.isNonPersistedEnabled=AppConfOptions.show_non_persisted_debits,"undefined"!=typeof AuthConfOptions&&AppConfOptions&&AppConfOptions.epayments_api&&(this.financeApiUrl=(0,c.Qj)(AppConfOptions.epayments_api));var t="".concat((0,c.Qj)(AuthConfOptions.stsServer),"/api/general/GetCountries");this.appCacheSv.initCountries(t),this.appCacheSv.countries$.pipe((0,d.R)(this.onDestroy)).subscribe(function(t){return e.countriesList=t}),this.oidcSecuritySrv.userData$.pipe((0,d.R)(this.onDestroy)).subscribe(function(t){t&&(e.user=t.userData)}),this._initDebitsByTin()}},{key:"ngOnDestroy",value:function(){this.onDestroy.next(null)}},{key:"onCreatePaymentRequest",value:function(t){var n=this;if((0,c.Ew)(this.user.email))this.toasterSrv.showWarning("","\u0395\u03af\u03bd\u03b1\u03b9 \u03b1\u03c0\u03b1\u03c1\u03b1\u03af\u03c4\u03b7\u03c4\u03bf \u03c4\u03bf email \u03c3\u03b1\u03c2 \u03c3\u03c4\u03b7 \u03c3\u03b5\u03bb\u03af\u03b4\u03b1 \u03c4\u03bf\u03c5 \u03c0\u03c1\u03bf\u03c6\u03af\u03bb \u03c3\u03b1\u03c2.");else{this.paymentRequestDto=void 0,(0,c.RA)(this.cdr);var s=this.filteredDebits.entries.filter(function(e){return e.isChecked});if(s&&s.length){var i={tinRelated:this.user.tin,relatedCallbackUrl:AppConfOptions.application_url+"/epayments/receipts",billingAddressCity:this.user.address_city,billingAddressCountryCode:this.user.address_country_code,billingAddressZip:this.user.address_zip,billingAddress:this.user.address,userEmail:this.user.email,userPhone:this.user.phone_number,paymentMethodKey:t.key,entries:[]};"PIRBGRAA"===t.key&&(i.billingAddressCountryCode=null);var a,r=e(s.filter(function(e){return e.isChecked}));try{for(r.s();!(a=r.n()).done;){var o=a.value,l={remittanceInfo:this._createRemittanceInfo(o),amount:o.currentSynolo,debtorName:o.eponymia,tin:this.user.tin,description:o.perigrafi,metadata:o.metadata};i.entries.push(l)}}catch(p){r.e(p)}finally{r.f()}this.paymentRequestDto=i,(0,c.RA)(this.cdr),this.egPaymentSrv.addPaymentRequest(this.financeApiUrl,this.paymentRequestDto).subscribe(function(e){e?(n.paymentResponseDto=e,n.onDoPaymentSubject.next(n.paymentResponseDto)):n.toasterSrv.showError("",n.translation.egwebapps.egrPaymentProblemFound)})}}}},{key:"onAllDebitsSelected",value:function(){var e=this;this.filteredDebits.entries.forEach(function(t){t.isChecked=e.isAllDebitsChecked}),(0,c.RA)(this.cdr),this._calculateTotalAmounts()}},{key:"onSelectedPersistedTypeChanged",value:function(e){this.selectedEidosId=+e,this.filteredDebits=(0,c.p$)(this.debits),this.filteredDebits.entries=1===this.selectedEidosId?this.debits.entries.filter(function(e){return!0===e.isBebaiomeno}):2===this.selectedEidosId?this.debits.entries.filter(function(e){return!1===e.isBebaiomeno}):this.debits.entries,(0,c.RA)(this.cdr),this._fillDebitsTable(this.filteredDebits)}},{key:"_initDebitsByTin",value:function(){var e=this;if(this.isLoading=!0,(0,c.RA)(this.cdr),this.user){this.countriesList&&this.user.address_country_code&&""!=this.user.address_country_code&&(this.user.address_country_num=this.countriesList.find(function(t){return t.Alpha2Code==e.user.address_country_code}).NumericCode.toString()),this.user.email=(0,c.Ew)(this.user.email)?this.user.email:this.user.email.trim(),this.user.username=(0,c.Ew)(this.user.username)?this.user.username:this.user.username.trim(),this.user.tin=(0,c.Ew)(this.user.tin)?this.user.tin:this.user.tin.trim(),this.user.family_name=(0,c.Ew)(this.user.family_name)?this.user.family_name:this.user.family_name.trim(),this.user.given_name=(0,c.Ew)(this.user.given_name)?this.user.given_name:this.user.given_name.trim(),this.user.fathers_name=(0,c.Ew)(this.user.fathers_name)?this.user.fathers_name:this.user.fathers_name.trim(),this.user.mothers_name=(0,c.Ew)(this.user.mothers_name)?this.user.mothers_name:this.user.mothers_name.trim(),this.user.name=(0,c.Ew)(this.user.name)?this.user.name:this.user.name.trim(),this.user.address_city=(0,c.Ew)(this.user.address_city)?this.user.address_city:this.user.address_city.trim(),this.user.address_country_code=(0,c.Ew)(this.user.address_country_code)?this.user.address_country_code:this.user.address_country_code.trim(),this.user.address_country_num=(0,c.Ew)(this.user.address_country_num)?this.user.address_country_num:this.user.address_country_num.trim(),this.user.address_zip=(0,c.Ew)(this.user.address_zip)?this.user.address_zip:this.user.address_zip.trim(),this.user.address=(0,c.Ew)(this.user.address)?this.user.address:this.user.address.trim(),this.user.adt=(0,c.Ew)(this.user.adt)?this.user.adt:this.user.adt.trim(),this.user.phone_number=(0,c.Ew)(this.user.phone_number)?this.user.phone_number:this.user.phone_number.trim();var t={tin:this.user.tin};this.epaymentsSrv.getBankMessages().pipe((0,h.w)(function(n){return e.oikonomikiBankMessages=n,e.epaymentsSrv.getDebitsByTin(t)})).subscribe(function(t){t&&(t.entries&&t.entries.length>=0?(e.debits=t,e._fillDebitsTable(e.debits)):(t.message||t.messageId)&&(e.bankStatusMessage="el"==e.selectedLang?e.oikonomikiBankMessages[t.messageId]?e.oikonomikiBankMessages[t.messageId]:t.message:e.oikonomikiBankMessagesEn[t.messageId]?e.oikonomikiBankMessagesEn[t.messageId]:t.message,e.toasterSrv.showError("",e.bankStatusMessage)),e.isLoading=!1)})}else this.toasterSrv.showError("","\u03a5\u03c0\u03ae\u03c1\u03be\u03b5 \u03ba\u03ac\u03c0\u03bf\u03b9\u03bf \u03c0\u03c1\u03cc\u03b2\u03bb\u03b7\u03bc\u03b1 \u03bc\u03b5 \u03c4\u03b7\u03bd \u03b1\u03bd\u03ac\u03ba\u03c4\u03b7\u03c3\u03b7 \u03c4\u03c9\u03bd \u03c3\u03c4\u03bf\u03b9\u03c7\u03b5\u03af\u03c9\u03bd \u03c7\u03c1\u03ae\u03c3\u03c4\u03b7.")}},{key:"_fillDebitsTable",value:function(e){if(this.isLoading=!0,(0,c.RA)(this.cdr),e.statusCode==c.WE.Error)return this.toasterSrv.showWarning("",this.translation.epayments.duplicateTin),void(this.bankStatusMessage=this.translation.epayments.duplicateTin);if(e.statusCode==c.WE.UndefinedError)return this.toasterSrv.showWarning("",this.translation.epayments.loadPaymentsError),void(this.bankStatusMessage=this.translation.epayments.loadPaymentsError);0===e.entries.length&&(this.bankStatusMessage=this.translation.epayments.noDebitsFound),!1===this.isNonPersistedEnabled&&(e.entries=e.entries.filter(function(e){return!0===e.isBebaiomeno})),e.entries.forEach(function(e){e.isChecked=!1});var t=e.entries.map(function(e){return e.currentKatharoPoso});this.totalCurrentKatharo=t.reduce(function(e,t){return e+t},0);var n=e.entries.map(function(e){return e.currentProsafksisi}),s=e.entries.map(function(e){return e.currentKrathseis});this.totalCurrentProsafksisi=n.reduce(function(e,t){return e+t},0)+s.reduce(function(e,t){return e+t},0);var i=e.entries.map(function(e){return e.currentSynolo});this.totalcurrentSynolo=i.reduce(function(e,t){return e+t},0),e.entries.sort(function(e,t){return Date.parse(e.hmerominiaLixis)/1e3-Date.parse(t.hmerominiaLixis)/1e3}),this.filteredDebits=e,this.isLoading=!1,(0,c.RA)(this.cdr)}},{key:"_calculateTotalAmounts",value:function(){var e=0,t=0,n=0,s=0,i=this.translation.epayments.debits;this.filteredDebits.entries.forEach(function(i){i.isChecked&&(s++,e+=i.currentSynolo,t+=i.currentKatharoPoso,n+=i.currentProsafksisi+i.currentKrathseis)}),i=1==s?this.translation.epayments.debit:this.translation.epayments.debits,this.calculatedChecked={countChecked:s,countText:i,checkedSum:e,checkedKatharo:t,checkedEpivarinseis:n}}},{key:"_createRemittanceInfo",value:function(e){return e.remittanceInfo}},{key:"_customSort",value:function(e){if(e.hasOwnProperty("field"))switch(e.field){case"hmerominiaLixis":this.filteredDebits.entries=e.hasOwnProperty("order")&&1==e.order?this.filteredDebits.entries.sort(function(e,t){return+new Date(t.hmerominiaLixis)-+new Date(e.hmerominiaLixis)>0?1:-1}):this.filteredDebits.entries.sort(function(e,t){return+new Date(t.hmerominiaLixis)-+new Date(e.hmerominiaLixis)<0?1:-1});break;default:this.filteredDebits.entries=e.hasOwnProperty("order")&&1==e.order?this.filteredDebits.entries.sort(function(t,n){return+n[e.field]-+t[e.field]>0?1:-1}):this.filteredDebits.entries.sort(function(t,n){return+n[e.field]-+t[e.field]<0?1:-1})}}}]),t}()).\u0275fac=function(e){return new(e||H)(g.Y36(c.MJ),g.Y36(f.J_),g.Y36(w.C),g.Y36(c.te),g.Y36(m.g),g.Y36(g.sBO),g.Y36(v.y))},H.\u0275cmp=g.Xpm({type:H,selectors:[["app-debits"]],inputs:{isAuthorized:"isAuthorized"},decls:5,vars:4,consts:[[3,"condition","customClass"],["severity","warn",3,"text","styleClass",4,"ngIf"],[4,"ngIf"],["selectedDebits",""],["severity","warn",3,"text","styleClass"],["severity","warn","text","\u0394\u03b5\u03bd \u03b2\u03c1\u03ad\u03b8\u03b7\u03ba\u03b1\u03bd \u03b5\u03b3\u03b3\u03c1\u03b1\u03c6\u03ad\u03c2.",3,"styleClass",4,"ngIf"],["severity","warn","text","\u0394\u03b5\u03bd \u03b2\u03c1\u03ad\u03b8\u03b7\u03ba\u03b1\u03bd \u03b5\u03b3\u03b3\u03c1\u03b1\u03c6\u03ad\u03c2.",3,"styleClass"],["class","debits-info__selected-debits",4,"ngIf"],["class","form mb-1",4,"ngIf"],["responsiveLayout","stack","breakpoint","1070px",3,"value","lazy","lazyLoadOnInit","rowHover","paginator","alwaysShowPaginator","rows","loading","totalRecords","customSort","sortFunction"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","footer"],[1,"debits-info__selected-debits"],[4,"ngTemplateOutlet"],[1,"form","mb-1"],["name","perstType","bindLabel","perigrafi","bindValue","value",3,"items","ngModel","clearable","ngModelChange"],[1,"ui-helper-clearfix",2,"text-align","left"],[1,"mr-1"],[1,"far","fa-dot-circle","fa-fw","text-success"],[1,"fas","fa-dot-circle","fa-fw","text-warning"],[1,"fixed-width-col-40","text-center"],[3,"binary","ngModel","ngModelChange","onChange"],["class","fixed-width-col-40",4,"ngIf"],[1,"fixed-width-col-40"],[1,"fixed-width-col-120"],[1,"fixed-width-col-170"],["pSortableColumn","hmerominiaLixis",1,"fixed-width-col-100"],["field","hmerominiaLixis"],["pSortableColumn","currentKatharoPoso",1,"fixed-width-col-120"],["field","currentKatharoPoso"],["pSortableColumn","currentProsafksisi",1,"fixed-width-col-120"],["field","currentProsafksisi"],["pSortableColumn","currentSynolo",1,"fixed-width-col-120"],["field","currentSynolo"],[1,"p-column-title"],["class","fixed-width-col-40 text-center",4,"ngIf"],[1,"fixed-width-col-100","text-center"],[1,"fixed-width-col-120","text-right"],["aria-hidden","true",1,"fa-fw",3,"ngClass"],["class","fixed-width-col-470","colspan","5",4,"ngIf"],["class","fixed-width-col-510","colspan","6",4,"ngIf"],["colspan","1",1,"fixed-width-col-100","text-right"],["colspan","5",1,"fixed-width-col-470"],["colspan","6",1,"fixed-width-col-510"],[1,"debits-info","d-flex","flex-wrap","justify-content-around","w-100","align-items-center","mb-1"],[1,"mb-0"],[1,"totalPoso"],["id","sumTotalToBank",1,"totalPoso"],[3,"isPaymentFormValid","doPaymentSubscription","finApiUrl","buttonText","cancelButtonText","onPayBtnClick"]],template:function(e,t){1&e&&(g._UZ(0,"lib-egr-loading",0),g.YNc(1,S,1,2,"p-message",1),g.YNc(2,z,4,3,"div",2),g.YNc(3,$,28,41,"ng-template",null,3,g.W1O)),2&e&&(g.Q6J("condition",t.isLoading)("customClass","egr-load-small"),g.xp6(1),g.Q6J("ngIf",t.bankStatusMessage),g.xp6(1),g.Q6J("ngIf",t.filteredDebits&&!t.isLoading))},directives:[c.IE,y.O5,Z.q,T.iA,C.jx,y.tP,k._Y,k.JL,k.F,q.w9,k.JJ,k.On,D.XZ,T.lQ,T.fz,y.mk,c.Hl],pipes:[o.X$,y.uU,y.H9],encapsulation:2}),H),W=a(24663),V=a(23815),X=a(25917),G=a(40205),ee=a(88598);function te(e,t){if(1&e&&g._UZ(0,"p-message",23),2&e){var n=g.oxw();g.Q6J("text",n.receiptsMessage)}}function ne(e,t){if(1&e&&g._UZ(0,"p-message",24),2&e){var n=g.oxw();g.Q6J("severity",n.bankStatusMessageClass)("text",n.bankStatusMessage)("styleClass","mb-2")}}function se(e,t){if(1&e&&(g.TgZ(0,"div",25),g.TgZ(1,"span",26),g._UZ(2,"i",27),g._uU(3),g.ALo(4,"translate"),g.qZA(),g.TgZ(5,"span",26),g._UZ(6,"i",28),g._uU(7),g.ALo(8,"translate"),g.qZA(),g.qZA()),2&e){var n=g.oxw();g.xp6(3),g.hij(" ",g.lcZ(4,2,n.translation.epayments.waiverOnline),""),g.xp6(4),g.hij(" ",g.lcZ(8,4,n.translation.epayments.waiverOffline),"")}}function ie(e,t){if(1&e&&(g.TgZ(0,"th",30),g._uU(1),g.ALo(2,"translate"),g.qZA()),2&e){var n=g.oxw(2);g.xp6(1),g.Oqu(g.lcZ(2,1,n.translation.epayments.receipt))}}function ae(e,t){if(1&e&&(g.TgZ(0,"tr"),g.TgZ(1,"th",29),g._uU(2),g.ALo(3,"translate"),g.qZA(),g.TgZ(4,"th",30),g._uU(5),g.ALo(6,"translate"),g.qZA(),g.TgZ(7,"th",31),g._uU(8),g.ALo(9,"translate"),g._UZ(10,"p-sortIcon",32),g.qZA(),g.TgZ(11,"th",30),g._uU(12),g.ALo(13,"translate"),g.qZA(),g.TgZ(14,"th",33),g._uU(15),g.ALo(16,"translate"),g._UZ(17,"p-sortIcon",34),g.qZA(),g.TgZ(18,"th",35),g._uU(19),g.ALo(20,"translate"),g.qZA(),g.TgZ(21,"th",36),g._uU(22),g.ALo(23,"translate"),g.qZA(),g.YNc(24,ie,3,3,"th",37),g.qZA()),2&e){var n=g.oxw();g.xp6(2),g.Oqu(g.lcZ(3,8,n.translation.egwebapps.egrType)),g.xp6(3),g.Oqu(g.lcZ(6,10,n.translation.epayments.receiptNbr)),g.xp6(3),g.hij("",g.lcZ(9,12,n.translation.epayments.receiptDate)," "),g.xp6(4),g.Oqu(g.lcZ(13,14,n.translation.epayments.transactionNbr)),g.xp6(3),g.hij("",g.lcZ(16,16,n.translation.epayments.transactionDate)," "),g.xp6(4),g.Oqu(g.lcZ(20,18,n.translation.egwebapps.description)),g.xp6(3),g.Oqu(g.lcZ(23,20,n.translation.epayments.poso)),g.xp6(2),g.Q6J("ngIf",!(null!=n.paymentsSettings&&n.paymentsSettings.isProviderThirdParty))}}function re(e,t){if(1&e&&(g.TgZ(0,"a",46),g._UZ(1,"i",47),g.qZA()),2&e){var n=g.oxw(2).$implicit,s=g.oxw();g.hYB("href","",s.financeApiUrl,"/api/PersistedDebits/GetPaymentFile/",n.bankTxnUid,"",g.LSH)}}function oe(e,t){if(1&e&&(g.TgZ(0,"td",44),g.TgZ(1,"span",39),g._uU(2),g.ALo(3,"translate"),g.qZA(),g.YNc(4,re,2,2,"a",45),g.qZA()),2&e){var n=g.oxw().$implicit,s=g.oxw();g.xp6(2),g.Oqu(g.lcZ(3,2,s.translation.epayments.receipt)),g.xp6(2),g.Q6J("ngIf",n.receiptId&&n.bankTxnUid)}}function le(e,t){if(1&e&&(g.TgZ(0,"tr"),g.TgZ(1,"td",38),g.TgZ(2,"span",39),g._uU(3),g.ALo(4,"translate"),g.qZA(),g._UZ(5,"i",40),g.qZA(),g.TgZ(6,"td",30),g.TgZ(7,"span",39),g._uU(8),g.ALo(9,"translate"),g.qZA(),g._uU(10),g.qZA(),g.TgZ(11,"td",41),g.TgZ(12,"span",39),g._uU(13),g.ALo(14,"translate"),g.qZA(),g._uU(15),g.ALo(16,"date"),g.qZA(),g.TgZ(17,"td",30),g.TgZ(18,"span",39),g._uU(19),g.ALo(20,"translate"),g.qZA(),g._uU(21),g.qZA(),g.TgZ(22,"td",41),g.TgZ(23,"span",39),g._uU(24),g.ALo(25,"translate"),g.qZA(),g._uU(26),g.ALo(27,"date"),g.qZA(),g.TgZ(28,"td",35),g.TgZ(29,"span",39),g._uU(30),g.ALo(31,"translate"),g.qZA(),g._uU(32),g.qZA(),g.TgZ(33,"td",42),g.TgZ(34,"span",39),g._uU(35),g.ALo(36,"translate"),g.qZA(),g._uU(37),g.ALo(38,"currency"),g.qZA(),g.YNc(39,oe,5,4,"td",43),g.qZA()),2&e){var n=t.$implicit,s=g.oxw();g.xp6(3),g.Oqu(g.lcZ(4,17,s.translation.egwebapps.egrType)),g.xp6(2),g.Tol(n.icon),g.xp6(3),g.Oqu(g.lcZ(9,19,s.translation.epayments.receiptNbr)),g.xp6(2),g.hij(" ",n.receiptIncrNr," "),g.xp6(3),g.Oqu(g.lcZ(14,21,s.translation.epayments.receiptDate)),g.xp6(2),g.hij(" ",g.xi3(16,23,n.receiptDateCreated,"dd/LL/yyyy")," "),g.xp6(4),g.Oqu(g.lcZ(20,26,s.translation.epayments.transactionNbr)),g.xp6(2),g.hij(" ",n.bankTxnPaymentRef," "),g.xp6(3),g.Oqu(g.lcZ(25,28,s.translation.epayments.transactionDate)),g.xp6(2),g.hij(" ",g.xi3(27,30,n.bankTxnDateCreated,"dd/LL/yyyy")," "),g.xp6(4),g.Oqu(g.lcZ(31,33,s.translation.egwebapps.description)),g.xp6(2),g.hij(" ",n.description," "),g.xp6(3),g.Oqu(g.lcZ(36,35,s.translation.epayments.poso)),g.xp6(2),g.hij(" ",g.gM2(38,37,n.paymentTotal,"\u20ac","symbol","1.2")," "),g.xp6(2),g.Q6J("ngIf",!(null!=s.paymentsSettings&&s.paymentsSettings.isProviderThirdParty))}}function pe(e,t){if(1&e&&(g.TgZ(0,"tr"),g.TgZ(1,"td"),g._uU(2),g.ALo(3,"translate"),g.qZA(),g.qZA()),2&e){var n=g.oxw();g.xp6(1),g.uIk("colspan",null!=n.paymentsSettings&&n.paymentsSettings.isProviderThirdParty?7:8),g.xp6(1),g.hij(" ",g.lcZ(3,2,n.translation.egwebapps.egrNoResultsFound)," ")}}function ce(e,t){if(1&e&&(g.TgZ(0,"tr"),g.TgZ(1,"td",48),g.TgZ(2,"strong"),g._uU(3),g.qZA(),g.qZA(),g.TgZ(4,"td",49),g.TgZ(5,"strong"),g._uU(6),g.ALo(7,"translate"),g.ALo(8,"currency"),g.qZA(),g.qZA(),g.qZA()),2&e){var n=g.oxw();g.xp6(3),g.hij("\u03a0\u03bb\u03ae\u03b8\u03bf\u03c2: ",null==n.orderedReceiptsFiltered?null:n.orderedReceiptsFiltered.length,""),g.xp6(1),g.Q6J("ngClass",null!=n.paymentsSettings&&n.paymentsSettings.isProviderThirdParty?"fixed-width-col-120":"fixed-width-col-220"),g.uIk("colspan",null!=n.paymentsSettings&&n.paymentsSettings.isProviderThirdParty?1:2),g.xp6(2),g.AsE("",g.lcZ(7,5,n.translation.egwebapps.egrTotalCost),": ",g.gM2(8,7,n.totalPoso,"EUR","symbol","1.2-2"),"")}}var ue=function(){return{width:"100%"}},de=function(){var e=function(){function e(t,s,i,a,r,o,l){n(this,e),this.oidcSecuritySrv=t,this.epaymentsSrv=s,this.egPaymentSrv=i,this.appCacheSv=a,this.toasterSrv=r,this.cdr=o,this.route=l,this.onDestroy=new u.xQ,this.totalPoso=0,this.bankStatusMessageClass=void 0,this.oikonomikiBankMessagesEn=x.Px,this.receiptType=0,this.isLoading=!0,this.hmerominiaApodiksisRange=null,this.hmerominiaSinallagisRange=null,this.today=new Date,this.yearRange=(0,c.ug)(50,50),this.tropoiPliromis=[]}return i(e,[{key:"ngOnInit",value:function(){var e=this;"undefined"!=typeof AppConfOptions&&AppConfOptions&&AppConfOptions.epayments_api&&(this.financeApiUrl=(0,c.Qj)(AppConfOptions.epayments_api)),this.appCacheSv.translation$.pipe((0,d.R)(this.onDestroy)).subscribe(function(t){t&&(e.translation=t,(0,c.RA)(e.cdr))}),this.appCacheSv.selectedLang$.pipe((0,d.R)(this.onDestroy)).subscribe(function(t){if(t)switch(e.selectedLang=t,t){case"en":e.tropoiPliromis=[{value:0,perigrafi:"All"},{value:1,perigrafi:"Organization's Fund Office"},{value:2,perigrafi:"E-Services"}];break;default:e.tropoiPliromis=[{id:0,perigrafi:"\u038c\u03bb\u03bf\u03b9"},{id:1,perigrafi:"\u03a4\u03b1\u03bc\u03b5\u03af\u03bf \u0394\u03ae\u03bc\u03bf\u03c5"},{id:2,perigrafi:"Online"}]}}),this.isLoading=!0,this.egPaymentSrv.getPaymentSetting("".concat(this.financeApiUrl,"/api/Banks/PaymentSettings")).subscribe(function(t){t&&(e.paymentsSettings=t)}),this.oidcSecuritySrv.userData$.pipe((0,d.R)(this.onDestroy)).subscribe(function(t){t&&(e.user=t.userData,e.user.email=(0,c.Ew)(e.user.email)?e.user.email:e.user.email.trim(),e.user.username=(0,c.Ew)(e.user.username)?e.user.username:e.user.username.trim(),e.user.tin=(0,c.Ew)(e.user.tin)?e.user.tin:e.user.tin.trim(),e.user.family_name=(0,c.Ew)(e.user.family_name)?e.user.family_name:e.user.family_name.trim(),e.user.given_name=(0,c.Ew)(e.user.given_name)?e.user.given_name:e.user.given_name.trim(),e.user.fathers_name=(0,c.Ew)(e.user.fathers_name)?e.user.fathers_name:e.user.fathers_name.trim(),e.user.mothers_name=(0,c.Ew)(e.user.mothers_name)?e.user.mothers_name:e.user.mothers_name.trim(),e.user.name=(0,c.Ew)(e.user.name)?e.user.name:e.user.name.trim(),e.user.address_city=(0,c.Ew)(e.user.address_city)?e.user.address_city:e.user.address_city.trim(),e.user.address_country_code=(0,c.Ew)(e.user.address_country_code)?e.user.address_country_code:e.user.address_country_code.trim(),e.user.address_country_num=(0,c.Ew)(e.user.address_country_num)?e.user.address_country_num:e.user.address_country_num.trim(),e.user.address_zip=(0,c.Ew)(e.user.address_zip)?e.user.address_zip:e.user.address_zip.trim(),e.user.address=(0,c.Ew)(e.user.address)?e.user.address:e.user.address.trim(),e.user.adt=(0,c.Ew)(e.user.adt)?e.user.adt:e.user.adt.trim(),e.user.phone_number=(0,c.Ew)(e.user.phone_number)?e.user.phone_number:e.user.phone_number.trim())}),this.epaymentsSrv.getBankMessages().pipe((0,h.w)(function(t){return t?(e.oikonomikiBankMessages=t,e.route.queryParams.pipe((0,d.R)(e.onDestroy))):(0,X.of)(!1)})).subscribe(function(t){if(t){var n=t;if(n.messagecode||n.paymentStatus){var s=n.messagecode?n.messagecode:n.paymentStatus;e.bankStatusMessage="el"==e.selectedLang?e.oikonomikiBankMessages[s]:e.oikonomikiBankMessagesEn[s],"TRANSACTION_COMPLETED"==s||"APPROVED"==s?(e.toasterSrv.showSuccess("",e.bankStatusMessage),e.bankStatusMessageClass="success"):(e.bankStatusMessageClass="error",e.toasterSrv.showError("",e.bankStatusMessage))}(0,c.RA)(e.cdr),e._initReceiptsByTin()}else e.toasterSrv.showError("",e.translation.egwebapps.egrProblemFound),e.isLoading=!1,(0,c.RA)(e.cdr)})}},{key:"ngOnChanges",value:function(e){e&&e.tabChanged&&(this.bankStatusMessage=void 0,(0,c.RA)(this.cdr))}},{key:"ngOnDestroy",value:function(){this.onDestroy.next(null)}},{key:"onReceiptTypeChanged",value:function(e){this.receiptType=e,(0,c.RA)(this.cdr)}},{key:"onSearch",value:function(){var e=this;this.isLoading=!0,this.orderedReceiptsFiltered=(0,c.p$)(this.orderedReceipts);var t=[];if(this.hmerominiaApodiksisRange){var n=this.orderedReceiptsFiltered.filter(function(t){return(0,W.Z)(new Date(t.receiptDateCreated),{start:new Date(e.hmerominiaApodiksisRange[0]),end:new Date(e.hmerominiaApodiksisRange[1])})});n&&n.length&&n.forEach(function(e){t.push(e)})}if(this.hmerominiaSinallagisRange){var s=this.orderedReceiptsFiltered.filter(function(t){return(0,W.Z)(new Date(t.bankTxnDateCreated),{start:new Date(e.hmerominiaSinallagisRange[0]),end:new Date(e.hmerominiaSinallagisRange[1])})});s&&s.length&&s.forEach(function(e){t.push(e)})}!this.hmerominiaApodiksisRange&&!this.hmerominiaSinallagisRange&&(t=(0,c.p$)(this.orderedReceipts)),this.orderedReceiptsFiltered=V.intersection(t),(0,c.RA)(this.cdr),this._filterByType(this.orderedReceiptsFiltered)}},{key:"onClear",value:function(){this.orderedReceiptsFiltered=(0,c.p$)(this.orderedReceipts),this.hmerominiaApodiksisRange=null,this.hmerominiaSinallagisRange=null,this.receiptType=0,(0,c.RA)(this.cdr)}},{key:"_initReceiptsByTin",value:function(){var e=this;this.isLoading=!0;var t=new Date,n={tin:this.user.tin,year:t.getFullYear()};this.epaymentsSrv.getPaymentsByTin(n).subscribe(function(t){t&&(e.receipts=t,e.totalPoso=0,e.receipts.entries&&e.receipts.entries.length>0&&e.receipts.entries.forEach(function(t){e.totalPoso+=t.receiptAmount}),!e.receipts.statusCode||2!=e.receipts.statusCode&&3!=e.receipts.statusCode?1==e.receipts.statusCode&&0==e.receipts.entries.length?e.receiptsMessage=e.translation.epayments.revDebtorNotFound:e._fillOrderedReceipts():e.receipts.responseMetadata.metadata.hasOwnProperty("REV_DEPTOR_NOT_FOUND")?(e.toasterSrv.showWarning("",e.translation.epayments.revDebtorNotFound),e.receiptsMessage=e.translation.epayments.revDebtorNotFound):e.receipts.responseMetadata.metadata.hasOwnProperty("REV_MULTIPLE_DEPTORS_FOUND")&&(e.toasterSrv.showError("error",e.translation.epayments.duplicateTin),e.receiptsMessage=e.translation.epayments.duplicateTin)),e.isLoading=!1,(0,c.RA)(e.cdr)})}},{key:"_filterByType",value:function(e){e&&(2===this.receiptType?this.orderedReceiptsFiltered=e.filter(function(e){return!0===e.isOnline}):1===this.receiptType&&(this.orderedReceiptsFiltered=e.filter(function(e){return!1===e.isOnline||!e.isOnline}))),this.isLoading=!1,(0,c.RA)(this.cdr)}},{key:"_fillOrderedReceipts",value:function(){var e=this;this.orderedReceipts=V.orderBy(this.receipts.entries,["receiptDateCreated","bankTxnDateCreated","id"],["desc","desc","desc"]),this.orderedReceipts.forEach(function(t){!t.receiptDateCreated&&!t.bankTxnDateCreated&&e.orderedReceipts.unshift(t)}),this.orderedReceipts.forEach(function(e){e.icon=0==e.isOnline?"far fa-building":"fas fa-desktop",e.description=null==e.bankTxnDescr?e.receiptDescr:e.bankTxnDescr,e.paymentTotal=null==e.bankTxnPaymentTotal?e.receiptAmount:e.bankTxnPaymentTotal,e.link=null!=e.receiptId&&null!=e.bankTxnUid?'<a href="'+AppConfOptions.epayments_api+"/api/PersistedDebits/GetPaymentFile/"+e.bankTxnUid+'" target="_blank"><i class="far fa-file-pdf"></i></a>':""}),this.orderedReceiptsFiltered=(0,c.p$)(this.orderedReceipts),(0,c.RA)(this.cdr)}},{key:"handleError",value:function(e){return(0,G._)(e.message)}},{key:"_customSort",value:function(e){if(e.hasOwnProperty("field"))switch(e.field){case"receiptDateCreated":this.orderedReceiptsFiltered=e.hasOwnProperty("order")&&1==e.order?this.orderedReceiptsFiltered.sort(function(e,t){return+new Date(t.receiptDateCreated)-+new Date(e.receiptDateCreated)>0?1:-1}):this.orderedReceiptsFiltered.sort(function(e,t){return+new Date(t.receiptDateCreated)-+new Date(e.receiptDateCreated)<0?1:-1});break;case"bankTxnDateCreated":this.orderedReceiptsFiltered=e.hasOwnProperty("order")&&1==e.order?this.orderedReceiptsFiltered.sort(function(e,t){return+new Date(t.bankTxnDateCreated)-+new Date(e.bankTxnDateCreated)>0?1:-1}):this.orderedReceiptsFiltered.sort(function(e,t){return+new Date(t.bankTxnDateCreated)-+new Date(e.bankTxnDateCreated)<0?1:-1});break;default:this.orderedReceiptsFiltered=e.hasOwnProperty("order")&&1==e.order?this.receipts.entries.sort(function(e,t){return t.receiptIncrNr&&e.receiptIncrNr&&parseInt(t.receiptIncrNr.split("/").pop())-parseInt(e.receiptIncrNr.split("/").pop())<0?1:-1}):this.receipts.entries.sort(function(e,t){return t.receiptIncrNr&&e.receiptIncrNr&&parseInt(t.receiptIncrNr.split("/").pop())-parseInt(e.receiptIncrNr.split("/").pop())>0?1:-1})}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(g.Y36(f.J_),g.Y36(w.C),g.Y36(c.te),g.Y36(m.g),g.Y36(c.MJ),g.Y36(g.sBO),g.Y36(p.gz))},e.\u0275cmp=g.Xpm({type:e,selectors:[["app-receipts"]],inputs:{tabChanged:"tabChanged"},features:[g.TTD],decls:35,vars:59,consts:[["severity","warn",3,"text",4,"ngIf"],[3,"severity","text","styleClass",4,"ngIf"],[3,"header","styleClass"],[1,"form"],[1,"row"],[1,"form-group","col-12","col-sm-6","col-md-4"],["for","hmerominiaApodiksisRange"],["name","hmerominiaApodiksisRange","dateFormat","dd/mm/yy","placeholder","\u03b7\u03b7/\u03bc\u03bc/\u03c7\u03c7\u03c7\u03c7","selectionMode","range","appendTo","body",3,"baseZIndex","firstDayOfWeek","selectOtherMonths","monthNavigator","yearNavigator","yearRange","showIcon","showButtonBar","readonlyInput","ngModel","ngModelChange"],["for","exchangeDatepicker"],["name","hmerominiaSinallagisRange","dateFormat","dd/mm/yy","placeholder","\u03b7\u03b7/\u03bc\u03bc/\u03c7\u03c7\u03c7\u03c7","selectionMode","range","appendTo","body",3,"baseZIndex","firstDayOfWeek","selectOtherMonths","monthNavigator","yearNavigator","yearRange","showIcon","showButtonBar","readonlyInput","ngModel","ngModelChange"],["for","recType"],["name","recType","bindLabel","perigrafi","bindValue","value",3,"items","ngModel","searchable","clearable","ngModelChange"],[1,"form-buttons","d-flex","flex-wrap"],["type","button",1,"btn","btn-primary","btn-sm","mr-1",3,"click"],["aria-hidden","true",1,"fas","fa-search","fa-fw"],["type","button",1,"btn","btn-warning","btn-sm","text-white",3,"click"],["aria-hidden","true",1,"fas","fa-times","fa-fw"],["responsiveLayout","stack","breakpoint","1070px",3,"value","lazy","lazyLoadOnInit","rowHover","paginator","alwaysShowPaginator","rows","loading","totalRecords","customSort","sortFunction"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","footer"],["severity","warn",3,"text"],[3,"severity","text","styleClass"],[1,"ui-helper-clearfix",2,"text-align","left"],[1,"mr-1"],[1,"fas","fa-desktop","fa-fw"],[1,"far","fa-building","fa-fw"],[1,"fixed-width-col-40"],[1,"fixed-width-col-100"],["pSortableColumn","receiptDateCreated",1,"fixed-width-col-170"],["field","receiptDateCreated"],["pSortableColumn","bankTxnDateCreated",1,"fixed-width-col-170"],["field","bankTxnDateCreated"],[1,"fixed-width-col-210"],[1,"fixed-width-col-120"],["class","fixed-width-col-100",4,"ngIf"],[1,"fixed-width-col-40","text-center"],[1,"p-column-title"],["aria-hidden","true"],[1,"fixed-width-col-170","text-center"],[1,"fixed-width-col-120","text-right"],["class","fixed-width-col-100 text-center",4,"ngIf"],[1,"fixed-width-col-100","text-center"],["target","_blank","aria-label","\u03a3\u03cd\u03bd\u03b4\u03b5\u03c3\u03bc\u03bf\u03c2 \u03b3\u03b9\u03b1 \u0391\u03c1\u03c7\u03b5\u03af\u03bf \u0395\u03ba\u03c4\u03cd\u03c0\u03c9\u03c3\u03b7\u03c2","rel","noopener",3,"href",4,"ngIf"],["target","_blank","aria-label","\u03a3\u03cd\u03bd\u03b4\u03b5\u03c3\u03bc\u03bf\u03c2 \u03b3\u03b9\u03b1 \u0391\u03c1\u03c7\u03b5\u03af\u03bf \u0395\u03ba\u03c4\u03cd\u03c0\u03c9\u03c3\u03b7\u03c2","rel","noopener",3,"href"],["aria-hidden","true",1,"far","fa-file-pdf"],["colspan","6",1,"fixed-width-col-790"],[1,"text-right",3,"ngClass"]],template:function(e,t){1&e&&(g.YNc(0,te,1,1,"p-message",0),g.YNc(1,ne,1,3,"p-message",1),g.TgZ(2,"p-panel",2),g.TgZ(3,"form",3),g.TgZ(4,"div",4),g.TgZ(5,"div",5),g.TgZ(6,"label",6),g._uU(7),g.ALo(8,"translate"),g.qZA(),g.TgZ(9,"p-calendar",7),g.NdJ("ngModelChange",function(e){return t.hmerominiaApodiksisRange=e}),g.qZA(),g.qZA(),g.TgZ(10,"div",5),g.TgZ(11,"label",8),g._uU(12),g.ALo(13,"translate"),g.qZA(),g.TgZ(14,"p-calendar",9),g.NdJ("ngModelChange",function(e){return t.hmerominiaSinallagisRange=e}),g.qZA(),g.qZA(),g.TgZ(15,"div",5),g.TgZ(16,"label",10),g._uU(17),g.ALo(18,"translate"),g.qZA(),g.TgZ(19,"ng-select",11),g.NdJ("ngModelChange",function(e){return t.receiptType=e})("ngModelChange",function(e){return t.onReceiptTypeChanged(e)}),g.qZA(),g.qZA(),g.qZA(),g.TgZ(20,"div",12),g.TgZ(21,"button",13),g.NdJ("click",function(){return t.onSearch()}),g._UZ(22,"i",14),g._uU(23),g.ALo(24,"translate"),g.qZA(),g.TgZ(25,"button",15),g.NdJ("click",function(){return t.onClear()}),g._UZ(26,"i",16),g._uU(27),g.ALo(28,"translate"),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(29,"p-table",17),g.NdJ("sortFunction",function(e){return t._customSort(e)}),g.YNc(30,se,9,6,"ng-template",18),g.YNc(31,ae,25,22,"ng-template",19),g.YNc(32,le,40,42,"ng-template",20),g.YNc(33,pe,4,4,"ng-template",21),g.YNc(34,ce,9,12,"ng-template",22),g.qZA()),2&e&&(g.Q6J("ngIf",t.receiptsMessage&&""!=t.receiptsMessage),g.xp6(1),g.Q6J("ngIf",!t.isLoading&&t.bankStatusMessage&&""!=t.bankStatusMessage),g.xp6(1),g.Q6J("header",t.translation.egwebapps.egrSearchFilters)("styleClass","mb-3"),g.xp6(5),g.Oqu(g.lcZ(8,47,t.translation.epayments.receiptDateRange)),g.xp6(2),g.Akn(g.DdM(57,ue)),g.Q6J("baseZIndex",9999)("firstDayOfWeek",1)("selectOtherMonths",!0)("monthNavigator",!0)("yearNavigator",!0)("yearRange",t.yearRange)("showIcon",!0)("showButtonBar",!0)("readonlyInput",!0)("ngModel",t.hmerominiaApodiksisRange),g.xp6(3),g.Oqu(g.lcZ(13,49,t.translation.epayments.transactionDateRange)),g.xp6(2),g.Akn(g.DdM(58,ue)),g.Q6J("baseZIndex",9999)("firstDayOfWeek",1)("selectOtherMonths",!0)("monthNavigator",!0)("yearNavigator",!0)("yearRange",t.yearRange)("showIcon",!0)("showButtonBar",!0)("readonlyInput",!0)("ngModel",t.hmerominiaSinallagisRange),g.xp6(3),g.Oqu(g.lcZ(18,51,t.translation.egwebapps.egrPaymentMethod)),g.xp6(2),g.Q6J("items",t.tropoiPliromis)("ngModel",t.receiptType)("searchable",!1)("clearable",!1),g.xp6(4),g.hij(" ",g.lcZ(24,53,t.translation.egwebapps.egrSearchBtn)," "),g.xp6(4),g.hij(" ",g.lcZ(28,55,t.translation.egwebapps.egrClearBtn)," "),g.xp6(2),g.Q6J("value",t.orderedReceiptsFiltered)("lazy",!1)("lazyLoadOnInit",!1)("rowHover",!0)("paginator",!0)("alwaysShowPaginator",!1)("rows",10)("loading",t.isLoading)("totalRecords",null==t.orderedReceiptsFiltered?null:t.orderedReceiptsFiltered.length)("customSort",!0))},directives:[y.O5,A.s,k._Y,k.JL,k.F,ee.f,k.JJ,k.On,q.w9,T.iA,C.jx,Z.q,T.lQ,T.fz,y.mk],pipes:[o.X$,y.uU,y.H9],encapsulation:2,changeDetection:0}),e}(),he=a(41886);function ge(e,t){if(1&e&&g._UZ(0,"p-message",4),2&e){var n=g.oxw();g.Q6J("text",null==n.translation?null:n.translation.egwebapps.egwebappsLoginMesg)}}function fe(e,t){if(1&e&&(g.TgZ(0,"p-panel",7),g._UZ(1,"div",8),g.ALo(2,"decodeHtmlString"),g.qZA()),2&e){var n=g.oxw(2);g.Q6J("header",null==n.translation?null:n.translation.egwebapps.information)("styleClass","tab-msg mb-3")("toggleable",!0),g.xp6(1),g.Q6J("innerHTML",g.lcZ(2,4,n.tabMsg),g.oJD)}}function me(e,t){if(1&e&&g._UZ(0,"app-receipts",12),2&e){var n=g.oxw(3);g.Q6J("tabChanged",n.onTbChanged)}}function ye(e,t){if(1&e){var n=g.EpF();g.TgZ(0,"p-tabView",9),g.NdJ("onChange",function(e){return g.CHM(n),g.oxw(2).onTabChanged(e)}),g.TgZ(1,"p-tabPanel",10),g._UZ(2,"app-debits"),g.qZA(),g.TgZ(3,"p-tabPanel",10),g.YNc(4,me,1,1,"ng-template",11),g.qZA(),g.qZA()}if(2&e){var s=g.oxw(2);g.Q6J("activeIndex",s.index),g.xp6(1),g.Q6J("header",null==s.translation?null:s.translation.epayments.debitsTab),g.xp6(2),g.Q6J("header",null==s.translation?null:s.translation.epayments.paymentsTab)}}function be(e,t){if(1&e&&(g.ynx(0),g.YNc(1,fe,3,6,"p-panel",5),g.YNc(2,ye,5,3,"p-tabView",6),g.BQk()),2&e){var n=g.oxw();g.xp6(1),g.Q6J("ngIf",n.tabMsg),g.xp6(1),g.Q6J("ngIf",n.isAuthorized)}}var Ze=[{path:"",component:function(){var e=function(){function e(t,s,i,a,r,o){n(this,e),this.oidcSecuritySrv=t,this.appCacheSrv=s,this.location=i,this.router=a,this.route=r,this.cdr=o,this.onDestroy=new u.xQ,this.afmNotFound=!1,this.index=0,this.onTbChanged=!1,this.selectedLang="el"}return i(e,[{key:"ngOnInit",value:function(){var e=this;this.appCacheSrv.translation$.pipe((0,d.R)(this.onDestroy)).subscribe(function(t){t&&(e.translation=t,(0,c.RA)(e.cdr))}),this.appCacheSrv.selectedLang$.pipe((0,d.R)(this.onDestroy)).subscribe(function(t){t&&(e.selectedLang=t),AppConfOptions&&1==AppConfOptions.multilingual&&"el"!=e.selectedLang&&AppConfOptions.epayments_debits_tab_info_en&&""!=AppConfOptions.epayments_debits_tab_info_en&&e.router.url.includes("debits")?e.tabMsg=AppConfOptions.epayments_debits_tab_info_en:AppConfOptions.epayments_debits_tab_info&&""!=AppConfOptions.epayments_debits_tab_info&&"el"==e.selectedLang&&e.router.url.includes("debits")&&(e.tabMsg=AppConfOptions.epayments_debits_tab_info),AppConfOptions&&1==AppConfOptions.multilingual&&"el"!=e.selectedLang&&AppConfOptions.epayments_receipts_tab_info_en&&""!=AppConfOptions.epayments_receipts_tab_info_en&&e.router.url.includes("receipts")?e.tabMsg=AppConfOptions.epayments_receipts_tab_info_en:AppConfOptions.epayments_receipts_tab_info&&""!=AppConfOptions.epayments_receipts_tab_info&&"el"==e.selectedLang&&e.router.url.includes("receipts")&&(e.tabMsg=AppConfOptions.epayments_receipts_tab_info),(0,c.RA)(e.cdr)}),this.oidcSecuritySrv.isAuthenticated$.pipe((0,h.w)(function(t){return e.isAuthorized=null!=t&&t.isAuthenticated,e.oidcSecuritySrv.userData$})).subscribe(function(t){t&&t.userData&&(!t.userData.tin||(0,c.Ew)(t.userData.tin))&&1==AppConfOptions.epayments_afm_required&&(e.afmNotFound=!0),(0,c.RA)(e.cdr)}),this.index="receipts"===this.route.children[0].snapshot.url[0].path?1:0,(0,c.RA)(this.cdr)}},{key:"ngOnDestroy",value:function(){this.onDestroy.next(null)}},{key:"onTabChanged",value:function(e){0==e.index?(this.router.navigate(["./debits"],{relativeTo:this.route}),AppConfOptions&&AppConfOptions.epayments_debits_tab_info&&""!=AppConfOptions.epayments_debits_tab_info&&(this.tabMsg=AppConfOptions.epayments_debits_tab_info)):(this.router.navigate(["./receipts"],{relativeTo:this.route}),this.onTbChanged=!0,AppConfOptions&&AppConfOptions.epayments_receipts_tab_info&&""!=AppConfOptions.epayments_receipts_tab_info&&(this.tabMsg=AppConfOptions.epayments_receipts_tab_info)),(0,c.RA)(this.cdr)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(g.Y36(f.J_),g.Y36(m.g),g.Y36(y.Ye),g.Y36(p.F0),g.Y36(p.gz),g.Y36(g.sBO))},e.\u0275cmp=g.Xpm({type:e,selectors:[["app-epayments-layout"]],inputs:{isAuthorized:"isAuthorized"},decls:5,vars:4,consts:[[1,"module-title"],["severity","warn",3,"text",4,"ngIf"],[3,"afmNotFound"],[4,"ngIf"],["severity","warn",3,"text"],[3,"header","styleClass","toggleable",4,"ngIf"],[3,"activeIndex","onChange",4,"ngIf"],[3,"header","styleClass","toggleable"],[3,"innerHTML"],[3,"activeIndex","onChange"],[3,"header"],["pTemplate","content"],[3,"tabChanged"]],template:function(e,t){1&e&&(g.TgZ(0,"h3",0),g._uU(1),g.qZA(),g.YNc(2,ge,1,1,"p-message",1),g._UZ(3,"app-afmnotfound",2),g.YNc(4,be,3,2,"ng-container",3)),2&e&&(g.xp6(1),g.Oqu(null==t.translation?null:t.translation.menu.epaymentsMenuItem),g.xp6(1),g.Q6J("ngIf",!t.isAuthorized),g.xp6(1),g.Q6J("afmNotFound",t.afmNotFound),g.xp6(1),g.Q6J("ngIf",!t.afmNotFound))},directives:[y.O5,b.d,Z.q,A.s,_.xf,_.x4,K,C.jx,de],pipes:[he.o],encapsulation:2}),e}(),children:[{path:"",pathMatch:"full",redirectTo:"debits"},{path:"debits",component:K},{path:"receipts",component:de}]}],Ae=function(){var e=i(function e(){n(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.oAB({type:e}),e.\u0275inj=g.cJS({imports:[[p.Bz.forChild(Ze)],p.Bz]}),e}(),_e=function(){var e=i(function e(){n(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.oAB({type:e}),e.\u0275inj=g.cJS({providers:[w.C],imports:[[Ae,l.m,r.IJ,o.aw.forChild()]]}),e}()}}])}();