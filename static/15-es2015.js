(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{kpNr:function(e,t,i){"use strict";i.r(t),i.d(t,"EpaymentsModule",function(){return be});var s=i("1kSV"),n=i("PCNd"),c=i("tyNb"),a=i("oXA7"),r=i("fXoL"),o=i("zazq"),d=i("ofXK"),l=i("FMpt"),h=i("7CaW"),p=i("dPl2"),m=i("4krO"),g=i("1q39"),f=i("Sy1n"),b=i("/rUF"),u=i("iFvM"),y=i("AEAu"),C=i("tk/3"),T=i("rEr+"),k=i("7zfz"),w=i("ZOsW"),x=i("3Pt+"),v=i("Ji6n"),O=i("3u8h");function D(e,t){1&e&&(r.mc(0,"div",4),r.mc(1,"span",5),r.hc(2,"i",6),r.lc(),r.lc())}function _(e,t){if(1&e&&r.hc(0,"p-message",7),2&e){const e=r.yc();r.Hc("text",e.debitsMessage)("styleClass","mt-2")}}function S(e,t){1&e&&r.hc(0,"p-message",9),2&e&&r.Hc("styleClass","mt-2")}function I(e,t){1&e&&r.ic(0)}function M(e,t){if(1&e&&(r.mc(0,"div",18),r.gd(1,I,1,0,"ng-container",19),r.lc()),2&e){r.yc(3);const e=r.Xc(4);r.Tb(1),r.Hc("ngTemplateOutlet",e)}}function A(e,t){if(1&e){const e=r.nc();r.mc(0,"div"),r.mc(1,"label"),r.id(2,"\u0395\u03af\u03b4\u03bf\u03c2 \u039f\u03c6\u03b5\u03b9\u03bb\u03ae\u03c2"),r.lc(),r.mc(3,"ng-select",20),r.wc("ngModelChange",function(t){r.Zc(e);return r.yc(3).selectedEidosId=t})("ngModelChange",function(t){r.Zc(e);return r.yc(3).onSelectedPersistedTypeChanged(t)}),r.lc(),r.lc()}if(2&e){const e=r.yc(3);r.Tb(3),r.Hc("items",e.eidosDebit)("ngModel",e.selectedEidosId)("clearable",!1)}}function R(e,t){1&e&&(r.mc(0,"legend",21),r.mc(1,"span",22),r.hc(2,"i",23),r.id(3," \u0392\u03b5\u03b2\u03b1\u03b9\u03c9\u03bc\u03ad\u03bd\u03b7 \u039f\u03c6\u03b5\u03b9\u03bb\u03ae"),r.lc(),r.mc(4,"span",22),r.hc(5,"i",24),r.id(6," \u039c\u03b7 \u0392\u03b5\u03b2\u03b1\u03b9\u03c9\u03bc\u03ad\u03bd\u03b7 \u039f\u03c6\u03b5\u03b9\u03bb\u03ae"),r.lc(),r.lc())}function P(e,t){1&e&&(r.mc(0,"th",28),r.id(1,"\xa0"),r.lc())}function j(e,t){if(1&e){const e=r.nc();r.mc(0,"tr"),r.mc(1,"th",25),r.mc(2,"p-checkbox",26),r.wc("ngModelChange",function(t){r.Zc(e);return r.yc(3).isAllDebitsChecked=t})("onChange",function(){r.Zc(e);return r.yc(3).onAllDebitsSelected()}),r.lc(),r.lc(),r.gd(3,P,2,0,"th",27),r.mc(4,"th",28),r.id(5,"AA"),r.lc(),r.mc(6,"th",29),r.id(7,"\u03a3\u03c4\u03bf\u03b9\u03c7\u03b5\u03af\u03b1 \u03a7\u03c1\u03b7\u03bc\u03b1\u03c4\u03b9\u03ba\u03bf\u03cd \u039a\u03b1\u03c4\u03b1\u03bb\u03cc\u03b3\u03bf\u03c5"),r.lc(),r.mc(8,"th",30),r.id(9,"\u03a0\u03b5\u03c1\u03b9\u03b3\u03c1\u03b1\u03c6\u03ae \u03a7\u03c1\u03ad\u03c9\u03c3\u03b7\u03c2"),r.lc(),r.mc(10,"th",31),r.id(11,"\u0397\u03bc. \u039b\u03ae\u03be\u03b7\u03c2"),r.lc(),r.mc(12,"th",31),r.id(13,"\u039a\u03b1\u03b8\u03b1\u03c1\u03cc \u03a0\u03bf\u03c3\u03cc"),r.lc(),r.mc(14,"th",31),r.id(15,"\u03a4\u03c1\u03ad\u03c7\u03bf\u03c5\u03c3\u03b5\u03c2 \u0395\u03c0\u03b9\u03b2\u03b1\u03c1\u03cd\u03bd\u03c3\u03b5\u03b9\u03c2*"),r.lc(),r.mc(16,"th",31),r.id(17,"\u03a3\u03cd\u03bd\u03bf\u03bb\u03bf"),r.lc(),r.lc()}if(2&e){const e=r.yc(3);r.Tb(2),r.Hc("binary",!0)("ngModel",e.isAllDebitsChecked),r.Tb(1),r.Hc("ngIf",e.isNonPersistedEnabled)}}function H(e,t){if(1&e&&(r.mc(0,"td",25),r.mc(1,"span",32),r.id(2,"\xa0"),r.lc(),r.hc(3,"i",35),r.lc()),2&e){const e=r.yc().$implicit;r.Tb(3),r.Hc("ngClass",e.isBebaiomeno?"far fa-dot-circle":"fas fa-dot-circle")}}function L(e,t){if(1&e){const e=r.nc();r.mc(0,"tr"),r.mc(1,"td",25),r.mc(2,"span",32),r.id(3,"\u0395\u03c0\u03b9\u03bb\u03bf\u03b3\u03ae"),r.lc(),r.mc(4,"p-checkbox",26),r.wc("ngModelChange",function(e){return t.$implicit.isChecked=e})("onChange",function(){r.Zc(e);return r.yc(3)._calculateTotalAmounts()}),r.lc(),r.lc(),r.gd(5,H,4,1,"td",33),r.mc(6,"td",28),r.mc(7,"span",32),r.id(8,"AA"),r.lc(),r.id(9),r.lc(),r.mc(10,"td",29),r.mc(11,"span",32),r.id(12,"\u03a3\u03c4\u03bf\u03b9\u03c7\u03b5\u03af\u03b1 \u03a7\u03c1\u03b7\u03bc\u03b1\u03c4\u03b9\u03ba\u03bf\u03cd \u039a\u03b1\u03c4\u03b1\u03bb\u03cc\u03b3\u03bf\u03c5"),r.lc(),r.id(13),r.lc(),r.mc(14,"td",30),r.mc(15,"span",32),r.id(16,"\u03a0\u03b5\u03c1\u03b9\u03b3\u03c1\u03b1\u03c6\u03ae \u03a7\u03c1\u03ad\u03c9\u03c3\u03b7\u03c2"),r.lc(),r.id(17),r.lc(),r.mc(18,"td",31),r.mc(19,"span",32),r.id(20,"\u0397\u03bc. \u039b\u03ae\u03be\u03b7\u03c2"),r.lc(),r.id(21),r.zc(22,"date"),r.lc(),r.mc(23,"td",34),r.mc(24,"span",32),r.id(25,"\u039a\u03b1\u03b8\u03b1\u03c1\u03cc \u03a0\u03bf\u03c3\u03cc"),r.lc(),r.id(26),r.zc(27,"currency"),r.lc(),r.mc(28,"td",34),r.mc(29,"span",32),r.id(30,"\u03a4\u03c1\u03ad\u03c7\u03bf\u03c5\u03c3\u03b5\u03c2 \u0395\u03c0\u03b9\u03b2\u03b1\u03c1\u03cd\u03bd\u03c3\u03b5\u03b9\u03c2"),r.lc(),r.id(31),r.zc(32,"currency"),r.lc(),r.mc(33,"td",34),r.mc(34,"span",32),r.id(35,"\u03a3\u03cd\u03bd\u03bf\u03bb\u03bf"),r.lc(),r.id(36),r.zc(37,"currency"),r.lc(),r.lc()}if(2&e){const e=t.$implicit,i=t.rowIndex,s=r.yc(3);r.Tb(4),r.Hc("binary",!0)("ngModel",e.isChecked),r.Tb(1),r.Hc("ngIf",s.isNonPersistedEnabled),r.Tb(4),r.kd(" ",i+1," "),r.Tb(4),r.kd(" ",e.aaEggrafis," "),r.Tb(4),r.kd(" ",e.perigrafi," "),r.Tb(4),r.kd(" ",r.Bc(22,10,e.hmerominiaLixis,"dd/LL/yyyy")," "),r.Tb(5),r.kd(" ",r.Dc(27,13,e.currentKatharoPoso,"\u20ac","symbol","1.2")," "),r.Tb(5),r.kd(" ",r.Dc(32,18,e.currentProsafksisi+e.currentKrathseis,"\u20ac","symbol","1.2")," "),r.Tb(5),r.kd(" ",r.Dc(37,23,e.currentSynolo,"\u20ac","symbol","1.2")," ")}}function E(e,t){1&e&&(r.mc(0,"td",39),r.mc(1,"strong"),r.id(2,"\u03a3\u03cd\u03bd\u03bf\u03bb\u03b1:"),r.lc(),r.lc())}function B(e,t){1&e&&(r.mc(0,"td",40),r.mc(1,"strong"),r.id(2,"\u03a3\u03cd\u03bd\u03bf\u03bb\u03b1:"),r.lc(),r.lc())}function z(e,t){if(1&e&&(r.mc(0,"tr"),r.gd(1,E,3,0,"td",36),r.gd(2,B,3,0,"td",37),r.mc(3,"td",38),r.mc(4,"strong"),r.id(5),r.zc(6,"currency"),r.lc(),r.lc(),r.mc(7,"td",38),r.mc(8,"strong"),r.id(9),r.zc(10,"currency"),r.lc(),r.lc(),r.mc(11,"td",38),r.mc(12,"strong"),r.id(13),r.zc(14,"currency"),r.lc(),r.lc(),r.lc()),2&e){const e=r.yc(3);r.Tb(1),r.Hc("ngIf",!e.isNonPersistedEnabled),r.Tb(1),r.Hc("ngIf",e.isNonPersistedEnabled),r.Tb(3),r.jd(r.Dc(6,5,e.totalCurrentKatharo,"\u20ac","symbol","1.2")),r.Tb(4),r.jd(r.Dc(10,10,e.totalCurrentProsafksisi,"\u20ac","symbol","1.2")),r.Tb(4),r.jd(r.Dc(14,15,e.totalcurrentSynolo,"\u20ac","symbol","1.2"))}}function F(e,t){if(1&e&&(r.kc(0),r.gd(1,M,2,1,"div",10),r.gd(2,A,4,3,"div",2),r.gd(3,R,7,0,"legend",11),r.mc(4,"p",12),r.mc(5,"strong"),r.id(6),r.lc(),r.lc(),r.mc(7,"p-table",13),r.gd(8,j,18,3,"ng-template",14),r.gd(9,L,38,28,"ng-template",15),r.gd(10,z,15,20,"ng-template",16),r.lc(),r.mc(11,"p",17),r.mc(12,"strong"),r.id(13),r.lc(),r.lc(),r.mc(14,"p"),r.mc(15,"small"),r.mc(16,"em"),r.id(17,"* \u03a4\u03c1\u03ad\u03c7\u03bf\u03c5\u03c3\u03b5\u03c2 \u03a0\u03c1\u03bf\u03c3\u03b1\u03c5\u03be\u03ae\u03c3\u03b5\u03b9\u03c2 \u03ba\u03b1\u03b9 \u03a4\u03c1\u03ad\u03c7\u03bf\u03c5\u03c3\u03b5\u03c2 \u039a\u03c1\u03b1\u03c4\u03ae\u03c3\u03b5\u03b9\u03c2"),r.lc(),r.lc(),r.lc(),r.jc()),2&e){const e=r.yc(2);r.Tb(1),r.Hc("ngIf",e.calculatedChecked.countChecked>0),r.Tb(1),r.Hc("ngIf",e.isNonPersistedEnabled),r.Tb(1),r.Hc("ngIf",e.isNonPersistedEnabled),r.Tb(3),r.kd("\u03a0\u03bb\u03ae\u03b8\u03bf\u03c2 \u039f\u03c6\u03b5\u03b9\u03bb\u03ce\u03bd: ",null==e.filteredDebits.entries?null:e.filteredDebits.entries.length,""),r.Tb(1),r.Hc("value",e.filteredDebits.entries)("autoLayout",!0)("responsive",!0)("scrollable",!0)("lazy",!1)("paginator",!0)("alwaysShowPaginator",!1)("rows",10)("totalRecords",e.filteredDebits.entries.length)("loading",e.isLoading),r.Tb(6),r.kd("\u03a0\u03bb\u03ae\u03b8\u03bf\u03c2 \u039f\u03c6\u03b5\u03b9\u03bb\u03ce\u03bd: ",null==e.filteredDebits.entries?null:e.filteredDebits.entries.length,"")}}function N(e,t){if(1&e&&(r.mc(0,"div"),r.gd(1,S,1,1,"p-message",8),r.gd(2,F,18,15,"ng-container",2),r.lc()),2&e){const e=r.yc();r.Tb(1),r.Hc("ngIf",0==e.calculatedChecked.countChecked&&e.debits.entries),r.Tb(1),r.Hc("ngIf",e.debits.entries&&e.debits.entries.length)}}function Z(e,t){if(1&e){const e=r.nc();r.mc(0,"div",41),r.mc(1,"div"),r.mc(2,"p",42),r.id(3,"\u0388\u03c7\u03b5\u03c4\u03b5 \u03b5\u03c0\u03b9\u03bb\u03ad\u03be\u03b5\u03b9 "),r.mc(4,"span",43),r.id(5),r.lc(),r.lc(),r.mc(6,"p",42),r.id(7,"\u039a\u03b1\u03b8\u03b1\u03c1\u03cc \u03c3\u03cd\u03bd\u03bf\u03bb\u03bf: "),r.mc(8,"span",43),r.id(9),r.zc(10,"currency"),r.lc(),r.lc(),r.mc(11,"p",42),r.id(12,"\u03a4\u03c1\u03ad\u03c7\u03bf\u03c5\u03c3\u03b5\u03c2 \u03b5\u03c0\u03b9\u03b2\u03b1\u03c1\u03cd\u03bd\u03c3\u03b5\u03b9\u03c2: "),r.mc(13,"span",43),r.id(14),r.zc(15,"currency"),r.lc(),r.lc(),r.mc(16,"p",42),r.id(17,"\u03a3\u03cd\u03bd\u03bf\u03bb\u03bf \u03b5\u03c0\u03b9\u03bb\u03b5\u03b3\u03bc\u03ad\u03bd\u03c9\u03bd \u03bf\u03c6\u03b5\u03b9\u03bb\u03ce\u03bd: "),r.mc(18,"span",44),r.id(19),r.zc(20,"currency"),r.lc(),r.lc(),r.lc(),r.mc(21,"app-checkout",45),r.wc("onPayBtnClick",function(t){r.Zc(e);return r.yc().onCreatePaymentRequest(t)}),r.lc(),r.lc()}if(2&e){const e=r.yc();r.Tb(5),r.ld("",e.calculatedChecked.countChecked," ",1==e.calculatedChecked.countChecked?"\u03bf\u03c6\u03b5\u03b9\u03bb\u03ae":"\u03bf\u03c6\u03b5\u03b9\u03bb\u03ad\u03c2",""),r.Tb(4),r.jd(r.Dc(10,9,e.calculatedChecked.checkedKatharo,"\u20ac","symbol","1.2")),r.Tb(5),r.jd(r.Dc(15,14,e.calculatedChecked.checkedEpivarinseis,"\u20ac","symbol","1.2")),r.Tb(5),r.jd(r.Dc(20,19,e.calculatedChecked.checkedSum,"\u20ac","symbol","1.2")),r.Tb(2),r.Hc("isPaymentFormValid",!0)("doPaymentSubscription",e.onDoPaymentSubject.asObservable())("finApiUrl",e.financeApiUrl)("buttonText","\u03a0\u03bb\u03b7\u03c1\u03c9\u03bc\u03ae")}}class U{constructor(e,t,i,s,n,c){this.toasterSrv=e,this.oidcSecuritySrv=t,this.epaymentsSrv=i,this.cdr=s,this._http=n,this._parent=c,this.countriesList=[],this.onDoPaymentSubject=new a.a,this.isMobile=!1,this.debitsMessage=null,this.calculatedChecked={countChecked:0,countText:"\u03bf\u03c6\u03b5\u03b9\u03bb\u03ad\u03c2",checkedSum:0,checkedKatharo:0,checkedProsafksisis:0},this.isAllDebitsChecked=!1,this.isLoading=!0,this.eidosDebit=[{value:0,perigrafi:"\u038c\u03bb\u03b5\u03c2"},{value:1,perigrafi:"\u0392\u03b5\u03b2\u03b1\u03b9\u03c9\u03bc\u03ad\u03bd\u03b5\u03c2 \u039f\u03c6\u03b5\u03b9\u03bb\u03ad\u03c2"},{value:2,perigrafi:"\u039c\u03b7 \u0392\u03b5\u03b2\u03b1\u03b9\u03c9\u03bc\u03ad\u03bd\u03b5\u03c2 \u039f\u03c6\u03b5\u03b9\u03bb\u03ad\u03c2"}],this.selectedEidosId=0,this.onDestroy=new a.a}ngOnInit(){this.isMobile=this._parent.isMobile,this.isNonPersistedEnabled=AppConfOptions.show_non_persisted_debits,"undefined"!=typeof AuthConfOptions&&AppConfOptions&&AppConfOptions.epayments_api&&(this.financeApiUrl=Object(u.g)(AppConfOptions.epayments_api));let e=Object(u.g)(AuthConfOptions.stsServer);e+="/api/general/GetCountries",this._http.get(e).pipe(Object(g.a)(e=>e?(this.countriesList=e,this.oidcSecuritySrv.userData$):Object(m.a)(!1))).subscribe(e=>{e&&(this.user=e,this.user.address_country_code&&""!=this.user.address_country_code&&(this.user.address_country_num=this.countriesList.find(e=>e.Alpha2Code==this.user.address_country_code).NumericCode.toString()),this._initDebitsByTin()),Object(u.d)(this.cdr)})}ngOnDestroy(){this.onDestroy.next(null)}onCreatePaymentRequest(e){this.paymentRequestDto=void 0,Object(u.d)(this.cdr);let t=this.debits.entries.filter(e=>e.isChecked);if(t&&t.length){let i={tinRelated:this.user.tin,relatedCallbackUrl:AppConfOptions.application_url+"/epayments/receipts",billingAddressCity:this.user.address_city,billingAddressCountryCode:this.user.address_country_code,billingAddressZip:this.user.address_zip,billingAddress:this.user.address,userEmail:this.user.email,userPhone:this.user.phone_number,paymentMethodKey:e.key,entries:[]};"PIRBGRAA"===e.key&&(i.billingAddressCountryCode=null);for(let e of t.filter(e=>e.isChecked)){let t={remittanceInfo:this._createRemittanceInfo(e),amount:e.currentSynolo,debtorName:e.eponymia,tin:this.user.tin,description:e.perigrafi,metadata:e.metadata};i.entries.push(t)}this.paymentRequestDto=i,Object(u.d)(this.cdr),this.epaymentsSrv.addPaymentRequest(this.paymentRequestDto).subscribe(e=>{if(e){let t=e;this.paymentResponseDto=t.model,this.onDoPaymentSubject.next(this.paymentResponseDto)}else this.toasterSrv.showError("","\u03a5\u03c0\u03ae\u03c1\u03be\u03b5 \u03ba\u03ac\u03c0\u03bf\u03b9\u03bf \u03c0\u03c1\u03cc\u03b2\u03bb\u03b7\u03bc\u03b1 \u03ba\u03b1\u03c4\u03ac \u03c4\u03b7\u03bd \u03b5\u03c0\u03b5\u03be\u03b5\u03c1\u03b3\u03b1\u03c3\u03af\u03b1 \u03c4\u03b7\u03c2 \u03c0\u03bb\u03b7\u03c1\u03c9\u03bc\u03ae\u03c2.")})}}onAllDebitsSelected(){this.debits.entries.forEach(e=>{e.isChecked=this.isAllDebitsChecked}),Object(u.d)(this.cdr),this._calculateTotalAmounts()}onSelectedPersistedTypeChanged(e){this.selectedEidosId=+e,this.filteredDebits=JSON.parse(JSON.stringify(this.debits)),1===this.selectedEidosId?this.filteredDebits.entries=this.debits.entries.filter(e=>!0===e.isBebaiomeno):2===this.selectedEidosId?this.filteredDebits.entries=this.debits.entries.filter(e=>!1===e.isBebaiomeno):this.filteredDebits.entries=this.debits.entries,console.log(this.filteredDebits),Object(u.d)(this.cdr),this._fillDebitsTable(this.filteredDebits)}_initDebitsByTin(){this.isLoading=!0;let e={tin:this.user.tin};this.epaymentsSrv.getBankMessages().pipe(Object(g.a)(t=>(this.bankMessages=t,this.epaymentsSrv.getDebitsByTin(e)))).subscribe(e=>{e&&(e.entries&&e.entries.length>=0?(this.debits=e,this.filteredDebits=e,this._fillDebitsTable(this.debits)):(e.message||e.messageId)&&(this.debitsMessage=this.bankMessages[e.messageId]?this.bankMessages[e.messageId]:e.message,this.toasterSrv.showError("",e.message)),this.isLoading=!1)})}_fillDebitsTable(e){if(this.isLoading=!0,Object(u.d)(this.cdr),2==e.statusCode)return this.toasterSrv.showWarning("","\u03a0\u03b1\u03c1\u03b1\u03ba\u03b1\u03bb\u03bf\u03cd\u03bc\u03b5 \u03b5\u03c0\u03b9\u03ba\u03bf\u03b9\u03bd\u03c9\u03bd\u03ae\u03c3\u03c4\u03b5 \u03bc\u03b5 \u03c4\u03bf \u03c4\u03b1\u03bc\u03b5\u03af\u03bf \u03c4\u03bf\u03c5 \u03b4\u03ae\u03bc\u03bf\u03c5. \u03a4\u03bf \u0391\u03a6\u039c \u03c3\u03b1\u03c2 \u03b5\u03bc\u03c6\u03b1\u03bd\u03af\u03b6\u03b5\u03c4\u03b1\u03b9 \u03c3\u03b5 \u03c0\u03b1\u03c1\u03b1\u03c0\u03ac\u03bd\u03c9 \u03b1\u03c0\u03cc \u03bc\u03b9\u03b1 \u03ba\u03b1\u03c1\u03c4\u03ad\u03bb\u03b5\u03c2, \u03bf\u03b9 \u03bf\u03c0\u03bf\u03af\u03b5\u03c2 \u03c0\u03c1\u03ad\u03c0\u03b5\u03b9 \u03bd\u03b1 \u03c3\u03c5\u03b3\u03c7\u03c9\u03bd\u03b5\u03c5\u03b8\u03bf\u03cd\u03bd."),void(this.debitsMessage="\u03a0\u03b1\u03c1\u03b1\u03ba\u03b1\u03bb\u03bf\u03cd\u03bc\u03b5 \u03b5\u03c0\u03b9\u03ba\u03bf\u03b9\u03bd\u03c9\u03bd\u03ae\u03c3\u03c4\u03b5 \u03bc\u03b5 \u03c4\u03bf \u03c4\u03b1\u03bc\u03b5\u03af\u03bf \u03c4\u03bf\u03c5 \u03b4\u03ae\u03bc\u03bf\u03c5. \u03a4\u03bf \u0391\u03a6\u039c \u03c3\u03b1\u03c2 \u03b5\u03bc\u03c6\u03b1\u03bd\u03af\u03b6\u03b5\u03c4\u03b1\u03b9 \u03c3\u03b5 \u03c0\u03b1\u03c1\u03b1\u03c0\u03ac\u03bd\u03c9 \u03b1\u03c0\u03cc \u03bc\u03b9\u03b1 \u03ba\u03b1\u03c1\u03c4\u03ad\u03bb\u03b5\u03c2, \u03bf\u03b9 \u03bf\u03c0\u03bf\u03af\u03b5\u03c2 \u03c0\u03c1\u03ad\u03c0\u03b5\u03b9 \u03bd\u03b1 \u03c3\u03c5\u03b3\u03c7\u03c9\u03bd\u03b5\u03c5\u03b8\u03bf\u03cd\u03bd.");if(4==e.statusCode)return this.toasterSrv.showWarning("","\u0394\u03b5\u03bd \u03ae\u03c4\u03b1\u03bd \u03b4\u03c5\u03bd\u03b1\u03c4\u03ae \u03b7 \u03c6\u03cc\u03c1\u03c4\u03c9\u03c3\u03b7 \u03c4\u03c9\u03bd \u03b2\u03b5\u03b2\u03b1\u03b9\u03c9\u03bc\u03ad\u03bd\u03c9\u03bd \u03bf\u03c6\u03b5\u03b9\u03bb\u03ce\u03bd \u03c3\u03b1\u03c2. \u03a0\u03b1\u03c1\u03b1\u03ba\u03b1\u03bb\u03bf\u03cd\u03bc\u03b5 \u03c0\u03c1\u03bf\u03c3\u03c0\u03b1\u03b8\u03ae\u03c3\u03c4\u03b5 \u03be\u03b1\u03bd\u03ac \u03b1\u03c1\u03b3\u03cc\u03c4\u03b5\u03c1\u03b1."),void(this.debitsMessage="\u0394\u03b5\u03bd \u03ae\u03c4\u03b1\u03bd \u03b4\u03c5\u03bd\u03b1\u03c4\u03ae \u03b7 \u03c6\u03cc\u03c1\u03c4\u03c9\u03c3\u03b7 \u03c4\u03c9\u03bd \u03b2\u03b5\u03b2\u03b1\u03b9\u03c9\u03bc\u03ad\u03bd\u03c9\u03bd \u03bf\u03c6\u03b5\u03b9\u03bb\u03ce\u03bd \u03c3\u03b1\u03c2. \u03a0\u03b1\u03c1\u03b1\u03ba\u03b1\u03bb\u03bf\u03cd\u03bc\u03b5 \u03c0\u03c1\u03bf\u03c3\u03c0\u03b1\u03b8\u03ae\u03c3\u03c4\u03b5 \u03be\u03b1\u03bd\u03ac \u03b1\u03c1\u03b3\u03cc\u03c4\u03b5\u03c1\u03b1.");0===e.entries.length&&(this.debitsMessage="\u0394\u03b5\u03bd \u03c5\u03c0\u03ac\u03c1\u03c7\u03bf\u03c5\u03bd \u03b4\u03b9\u03b1\u03b8\u03ad\u03c3\u03b9\u03bc\u03b5\u03c2 \u03bf\u03c6\u03b5\u03b9\u03bb\u03ad\u03c2 \u03c3\u03c4\u03bf \u0391\u03a6\u039c \u03c3\u03b1\u03c2 \u03b3\u03b9\u03b1 \u03c0\u03bb\u03b7\u03c1\u03c9\u03bc\u03ae \u03bc\u03ad\u03c3\u03c9 \u03c4\u03bf\u03c5 online \u03c3\u03c5\u03c3\u03c4\u03ae\u03bc\u03b1\u03c4\u03bf\u03c2."),!1===this.isNonPersistedEnabled&&(e.entries=e.entries.filter(e=>!0===e.isBebaiomeno)),e.entries.forEach(e=>{e.isChecked=!1});let t=e.entries.map(e=>e.currentKatharoPoso);this.totalCurrentKatharo=t.reduce((e,t)=>e+t,0);let i=e.entries.map(e=>e.currentProsafksisi),s=e.entries.map(e=>e.currentKrathseis);this.totalCurrentProsafksisi=i.reduce((e,t)=>e+t,0)+s.reduce((e,t)=>e+t,0);let n=e.entries.map(e=>e.currentSynolo);this.totalcurrentSynolo=n.reduce((e,t)=>e+t,0),e.entries.sort(function(e,t){return Date.parse(e.hmerominiaLixis)/1e3-Date.parse(t.hmerominiaLixis)/1e3}),this.isLoading=!1,Object(u.d)(this.cdr)}_calculateTotalAmounts(){let e=0,t=0,i=0,s=0,n="\u03bf\u03c6\u03b5\u03b9\u03bb\u03ad\u03c2";this.debits.entries.forEach(n=>{n.isChecked&&(s++,e+=n.currentSynolo,t+=n.currentKatharoPoso,i+=n.currentProsafksisi+n.currentKrathseis)}),n=1==s?"\u03bf\u03c6\u03b5\u03b9\u03bb\u03ae":"\u03bf\u03c6\u03b5\u03b9\u03bb\u03ad\u03c2",this.calculatedChecked={countChecked:s,countText:n,checkedSum:e,checkedKatharo:t,checkedEpivarinseis:i}}_createRemittanceInfo(e){return e.remittanceInfo}}U.\u0275fac=function(e){return new(e||U)(r.gc(b.a),r.gc(o.e),r.gc(y.a),r.gc(r.j),r.gc(C.b),r.gc(f.a))},U.\u0275cmp=r.ac({type:U,selectors:[["app-debits"]],inputs:{isAuthorized:"isAuthorized"},decls:5,vars:3,consts:[["class","bg-white","style","width: 100%; height: 300px",4,"ngIf"],["severity","warn",3,"text","styleClass",4,"ngIf"],[4,"ngIf"],["selectedDebits",""],[1,"bg-white",2,"width","100%","height","300px"],[1,"d-flex","justify-content-center","align-items-center","w-100","h-100"],[1,"fas","fa-circle-notch","fa-3x","fa-pulse"],["severity","warn",3,"text","styleClass"],["severity","warn","text","\u0394\u03b5\u03bd \u03c5\u03c0\u03ac\u03c1\u03c7\u03bf\u03c5\u03bd \u03b5\u03c0\u03b9\u03bb\u03b5\u03b3\u03bc\u03ad\u03bd\u03b5\u03c2 \u03bf\u03c6\u03b5\u03b9\u03bb\u03ad\u03c2. \u03a0\u03b1\u03c1\u03b1\u03ba\u03b1\u03bb\u03bf\u03cd\u03bc\u03b5 \u03b5\u03c0\u03b9\u03bb\u03ad\u03be\u03c4\u03b5 \u03c4\u03b9\u03c2 \u03bf\u03c6\u03b5\u03b9\u03bb\u03ad\u03c2 \u03c0\u03bf\u03c5 \u03b8\u03ad\u03bb\u03b5\u03c4\u03b5 \u03bd\u03b1 \u03b5\u03be\u03bf\u03c6\u03bb\u03ae\u03c3\u03b5\u03c4\u03b5 \u03b1\u03c0\u03cc \u03c4\u03b7\u03bd \u03c0\u03b1\u03c1\u03b1\u03ba\u03ac\u03c4\u03c9 \u03bb\u03af\u03c3\u03c4\u03b1.",3,"styleClass",4,"ngIf"],["severity","warn","text","\u0394\u03b5\u03bd \u03c5\u03c0\u03ac\u03c1\u03c7\u03bf\u03c5\u03bd \u03b5\u03c0\u03b9\u03bb\u03b5\u03b3\u03bc\u03ad\u03bd\u03b5\u03c2 \u03bf\u03c6\u03b5\u03b9\u03bb\u03ad\u03c2. \u03a0\u03b1\u03c1\u03b1\u03ba\u03b1\u03bb\u03bf\u03cd\u03bc\u03b5 \u03b5\u03c0\u03b9\u03bb\u03ad\u03be\u03c4\u03b5 \u03c4\u03b9\u03c2 \u03bf\u03c6\u03b5\u03b9\u03bb\u03ad\u03c2 \u03c0\u03bf\u03c5 \u03b8\u03ad\u03bb\u03b5\u03c4\u03b5 \u03bd\u03b1 \u03b5\u03be\u03bf\u03c6\u03bb\u03ae\u03c3\u03b5\u03c4\u03b5 \u03b1\u03c0\u03cc \u03c4\u03b7\u03bd \u03c0\u03b1\u03c1\u03b1\u03ba\u03ac\u03c4\u03c9 \u03bb\u03af\u03c3\u03c4\u03b1.",3,"styleClass"],["class","debits-info__selected-debits",4,"ngIf"],["class","iconTooltips d-flex flex-wrap mt-4 mb-2","style","font-size: 14px;",4,"ngIf"],[1,"mt-2","mb-1"],[3,"value","autoLayout","responsive","scrollable","lazy","paginator","alwaysShowPaginator","rows","totalRecords","loading"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],[1,"mt-1"],[1,"debits-info__selected-debits"],[4,"ngTemplateOutlet"],["name","perstType","bindLabel","perigrafi","bindValue","value",3,"items","ngModel","clearable","ngModelChange"],[1,"iconTooltips","d-flex","flex-wrap","mt-4","mb-2",2,"font-size","14px"],[1,"mr-1"],[1,"far","fa-dot-circle","fa-fw"],[1,"fas","fa-dot-circle","fa-fw"],[1,"fixed-width-col-40","text-center"],[3,"binary","ngModel","ngModelChange","onChange"],["class","fixed-width-col-40",4,"ngIf"],[1,"fixed-width-col-40"],[1,"fixed-width-col-120"],[1,"fixed-width-col-170"],[1,"fixed-width-col-100"],[1,"p-column-title"],["class","fixed-width-col-40 text-center",4,"ngIf"],[1,"fixed-width-col-100","text-right"],["aria-hidden","true",1,"fa-fw",3,"ngClass"],["class","fixed-width-col-470 text-right","colspan","5",4,"ngIf"],["class","fixed-width-col-510 text-right","colspan","6",4,"ngIf"],["colspan","1",1,"fixed-width-col-100","text-right"],["colspan","5",1,"fixed-width-col-470","text-right"],["colspan","6",1,"fixed-width-col-510","text-right"],[1,"debits-info","d-flex","flex-wrap","justify-content-around","w-100","align-items-center","mb-1"],[1,"mb-0"],[1,"totalPoso"],["id","sumTotalToBank",1,"totalPoso"],[3,"isPaymentFormValid","doPaymentSubscription","finApiUrl","buttonText","onPayBtnClick"]],template:function(e,t){1&e&&(r.gd(0,D,3,0,"div",0),r.gd(1,_,1,2,"p-message",1),r.gd(2,N,3,2,"div",2),r.gd(3,Z,22,24,"ng-template",null,3,r.hd)),2&e&&(r.Hc("ngIf",t.isLoading),r.Tb(1),r.Hc("ngIf",t.debitsMessage),r.Tb(1),r.Hc("ngIf",t.debits&&!t.isLoading))},directives:[d.p,l.b,T.d,k.j,d.u,w.a,x.m,x.p,v.a,d.n,O.a],pipes:[d.f,d.d],encapsulation:2});var K=i("wd/R"),V=i("lhB6"),q=i("bk9D"),W=i("eO1q");function $(e,t){1&e&&(r.mc(0,"div",4),r.mc(1,"span",5),r.hc(2,"i",6),r.lc(),r.lc())}function J(e,t){if(1&e&&r.hc(0,"p-message",7),2&e){const e=r.yc();r.Hc("text",e.receiptsMessage)}}function G(e,t){if(1&e&&r.hc(0,"p-message",8),2&e){const e=r.yc();r.Hc("severity",e.bankStatusMessageClass)("text",e.bankStatusMessage)("styleClass","mb-2")}}function X(e,t){1&e&&(r.mc(0,"th",38),r.id(1,"\u0391\u03c0\u03cc\u03b4\u03b5\u03b9\u03be\u03b7 \u03a0\u03bb\u03b7\u03c1\u03c9\u03bc\u03ae\u03c2"),r.lc())}function Y(e,t){if(1&e&&(r.mc(0,"tr"),r.mc(1,"th",37),r.id(2,"\u0395\u03af\u03b4\u03bf\u03c2"),r.lc(),r.mc(3,"th",38),r.id(4,"\u0391\u03c1. \u0391\u03c0\u03cc\u03b4\u03b5\u03b9\u03be\u03b7\u03c2"),r.lc(),r.mc(5,"th",38),r.id(6,"\u0397\u03bc. \u0391\u03c0\u03cc\u03b4\u03b5\u03b9\u03be\u03b7\u03c2"),r.lc(),r.mc(7,"th",38),r.id(8,"\u0391\u03c1. \u03a3\u03c5\u03bd\u03b1\u03bb\u03bb\u03b1\u03b3\u03ae\u03c2"),r.lc(),r.mc(9,"th",38),r.id(10,"\u0397\u03bc. \u03a3\u03c5\u03bd\u03b1\u03bb\u03bb\u03b1\u03b3\u03ae\u03c2"),r.lc(),r.mc(11,"th",39),r.id(12,"\u03a0\u03b5\u03c1\u03b9\u03b3\u03c1\u03b1\u03c6\u03ae"),r.lc(),r.mc(13,"th",38),r.id(14,"\u03a0\u03bf\u03c3\u03cc"),r.lc(),r.gd(15,X,2,0,"th",40),r.lc()),2&e){const e=r.yc(3);r.Tb(15),r.Hc("ngIf",!(null!=e.paymentsSettings&&e.paymentsSettings.isProviderThirdParty))}}function Q(e,t){if(1&e&&(r.mc(0,"a",48),r.hc(1,"i",49),r.lc()),2&e){const e=r.yc(2).$implicit,t=r.yc(3);r.Kc("href","",t.receiptsUrlBase,"api/PersistedDebits/GetPaymentFile/",e.bankTxnUid,"",r.bd)}}function ee(e,t){if(1&e&&(r.mc(0,"td",46),r.mc(1,"span",42),r.id(2,"\u0391\u03c0\u03cc\u03b4\u03b5\u03b9\u03be\u03b7 \u03a0\u03bb\u03b7\u03c1\u03c9\u03bc\u03ae\u03c2"),r.lc(),r.gd(3,Q,2,2,"a",47),r.lc()),2&e){const e=r.yc().$implicit;r.Tb(3),r.Hc("ngIf",e.receiptId&&e.bankTxnUid)}}function te(e,t){if(1&e&&(r.mc(0,"tr"),r.mc(1,"td",41),r.mc(2,"span",42),r.id(3,"\u0395\u03af\u03b4\u03bf\u03c2"),r.lc(),r.hc(4,"i",43),r.lc(),r.mc(5,"td",38),r.mc(6,"span",42),r.id(7,"\u0391\u03c1. \u0391\u03c0\u03cc\u03b4\u03b5\u03b9\u03be\u03b7\u03c2"),r.lc(),r.id(8),r.lc(),r.mc(9,"td",38),r.mc(10,"span",42),r.id(11,"\u0397\u03bc. \u0391\u03c0\u03cc\u03b4\u03b5\u03b9\u03be\u03b7\u03c2"),r.lc(),r.id(12),r.zc(13,"date"),r.lc(),r.mc(14,"td",38),r.mc(15,"span",42),r.id(16,"\u0391\u03c1. \u03a3\u03c5\u03bd\u03b1\u03bb\u03bb\u03b1\u03b3\u03ae\u03c2"),r.lc(),r.id(17),r.lc(),r.mc(18,"td",38),r.mc(19,"span",42),r.id(20,"\u0397\u03bc. \u03a3\u03c5\u03bd\u03b1\u03bb\u03bb\u03b1\u03b3\u03ae\u03c2"),r.lc(),r.id(21),r.zc(22,"date"),r.lc(),r.mc(23,"td",39),r.mc(24,"span",42),r.id(25,"\u03a0\u03b5\u03c1\u03b9\u03b3\u03c1\u03b1\u03c6\u03ae"),r.lc(),r.id(26),r.lc(),r.mc(27,"td",44),r.mc(28,"span",42),r.id(29,"\u03a0\u03bf\u03c3\u03cc"),r.lc(),r.id(30),r.zc(31,"currency"),r.lc(),r.gd(32,ee,4,1,"td",45),r.lc()),2&e){const e=t.$implicit,i=r.yc(3);r.Tb(4),r.Vb(e.icon),r.Tb(4),r.kd(" ",e.receiptIncrNr," "),r.Tb(4),r.kd(" ",r.Bc(13,10,e.receiptDateCreated,"dd/LL/yyyy")," "),r.Tb(5),r.kd(" ",e.bankTxnPaymentRef," "),r.Tb(4),r.kd(" ",r.Bc(22,13,e.bankTxnDateCreated,"dd/LL/yyyy")," "),r.Tb(5),r.kd(" ",e.description," "),r.Tb(4),r.kd(" ",r.Dc(31,16,e.paymentTotal,"\u20ac","symbol","1.2")," "),r.Tb(2),r.Hc("ngIf",!(null!=i.paymentsSettings&&i.paymentsSettings.isProviderThirdParty))}}function ie(e,t){if(1&e&&(r.mc(0,"tr"),r.mc(1,"td",50),r.mc(2,"strong"),r.id(3,"\u03a3\u03cd\u03bd\u03bf\u03bb\u03bf"),r.lc(),r.lc(),r.mc(4,"td",51),r.mc(5,"strong"),r.id(6),r.zc(7,"currency"),r.lc(),r.lc(),r.lc()),2&e){const e=r.yc(3);r.Tb(4),r.Ub("colspan",null!=e.paymentsSettings&&e.paymentsSettings.isProviderThirdParty?1:2),r.Tb(2),r.jd(r.Dc(7,2,e.totalPoso,"\u20ac","symbol","1.2"))}}function se(e,t){if(1&e&&(r.mc(0,"tr"),r.mc(1,"td"),r.id(2," \u0394\u03b5\u03bd \u03b2\u03c1\u03ad\u03b8\u03b7\u03ba\u03b1\u03bd \u03bf\u03c6\u03b5\u03b9\u03bb\u03ad\u03c2 \u03bc\u03b5 \u03c4\u03b1 \u03ba\u03c1\u03b9\u03c4\u03ae\u03c1\u03b9\u03b1 \u03c0\u03bf\u03c5 \u03ad\u03c7\u03b5\u03c4\u03b5 \u03b5\u03c0\u03b9\u03bb\u03ad\u03be\u03b5\u03b9. "),r.lc(),r.lc()),2&e){const e=r.yc(3);r.Tb(1),r.Ub("colspan",null!=e.paymentsSettings&&e.paymentsSettings.isProviderThirdParty?7:8)}}const ne=function(){return{width:"100%"}};function ce(e,t){if(1&e){const e=r.nc();r.mc(0,"div",10),r.mc(1,"p-panel",11),r.mc(2,"form",12),r.mc(3,"div",13),r.mc(4,"div",14),r.mc(5,"label",15),r.id(6,"\u0395\u03cd\u03c1\u03bf\u03c2 \u0397\u03bc. \u0391\u03c0\u03cc\u03b4\u03b5\u03b9\u03be\u03b7\u03c2"),r.lc(),r.mc(7,"p-calendar",16),r.wc("ngModelChange",function(t){r.Zc(e);return r.yc(2).hmerominiaApodiksisRange=t}),r.lc(),r.lc(),r.mc(8,"div",14),r.mc(9,"label",17),r.id(10,"\u0395\u03cd\u03c1\u03bf\u03c2 \u0397\u03bc. \u03a3\u03c5\u03bd\u03b1\u03bb\u03bb\u03b1\u03b3\u03ae\u03c2"),r.lc(),r.mc(11,"p-calendar",18),r.wc("ngModelChange",function(t){r.Zc(e);return r.yc(2).hmerominiaSinallagisRange=t}),r.lc(),r.lc(),r.mc(12,"div",14),r.mc(13,"label",19),r.id(14,"\u03a4\u03c1\u03cc\u03c0\u03bf\u03c2 \u03a0\u03bb\u03b7\u03c1\u03c9\u03bc\u03ae\u03c2"),r.lc(),r.mc(15,"ng-select",20),r.wc("ngModelChange",function(t){r.Zc(e);return r.yc(2).receiptType=t}),r.lc(),r.lc(),r.lc(),r.mc(16,"div",21),r.mc(17,"button",22),r.wc("click",function(){r.Zc(e);return r.yc(2).btnApplyFiltersClicked()}),r.hc(18,"i",23),r.id(19," \u0391\u03bd\u03b1\u03b6\u03ae\u03c4\u03b7\u03c3\u03b7 "),r.lc(),r.mc(20,"button",24),r.wc("click",function(){r.Zc(e);return r.yc(2).btnCleanFiltersClicked()}),r.hc(21,"i",25),r.id(22," \u039a\u03b1\u03b8\u03b1\u03c1\u03b9\u03c3\u03bc\u03cc\u03c2 "),r.lc(),r.lc(),r.lc(),r.lc(),r.mc(23,"legend",26),r.mc(24,"span",27),r.hc(25,"i",28),r.id(26," \u0395\u03be\u03cc\u03c6\u03bb\u03b7\u03c3\u03b7 \u03bc\u03ad\u03c3\u03c9 \u03c4\u03bf\u03c5 Online \u03a3\u03c5\u03c3\u03c4\u03ae\u03bc\u03b1\u03c4\u03bf\u03c2 \u03a0\u03bb\u03b7\u03c1\u03c9\u03bc\u03ae\u03c2"),r.lc(),r.mc(27,"span",27),r.hc(28,"i",29),r.id(29," \u0395\u03be\u03cc\u03c6\u03bb\u03b7\u03c3\u03b7 \u03c3\u03c4\u03bf \u0394\u03ae\u03bc\u03bf"),r.lc(),r.lc(),r.mc(30,"p"),r.mc(31,"strong"),r.id(32),r.lc(),r.lc(),r.mc(33,"p-table",30),r.gd(34,Y,16,1,"ng-template",31),r.gd(35,te,33,21,"ng-template",32),r.gd(36,ie,8,7,"ng-template",33),r.gd(37,se,3,1,"ng-template",34),r.lc(),r.mc(38,"p",35),r.mc(39,"strong"),r.id(40),r.lc(),r.lc(),r.mc(41,"legend",36),r.mc(42,"span",27),r.hc(43,"i",28),r.id(44," \u0395\u03be\u03cc\u03c6\u03bb\u03b7\u03c3\u03b7 \u03bc\u03ad\u03c3\u03c9 \u03c4\u03bf\u03c5 Online \u03a3\u03c5\u03c3\u03c4\u03ae\u03bc\u03b1\u03c4\u03bf\u03c2 \u03a0\u03bb\u03b7\u03c1\u03c9\u03bc\u03ae\u03c2"),r.lc(),r.mc(45,"span",27),r.hc(46,"i",29),r.id(47," \u0395\u03be\u03cc\u03c6\u03bb\u03b7\u03c3\u03b7 \u03c3\u03c4\u03bf \u0394\u03ae\u03bc\u03bf"),r.lc(),r.lc(),r.lc()}if(2&e){const e=r.yc(2);r.Tb(1),r.Hc("styleClass","mb-3"),r.Tb(6),r.dd(r.Nc(41,ne)),r.Hc("baseZIndex",9999)("firstDayOfWeek",1)("selectOtherMonths",!0)("monthNavigator",!0)("yearNavigator",!0)("yearRange",e.yearRange)("showIcon",!0)("showButtonBar",!0)("readonlyInput",!0)("ngModel",e.hmerominiaApodiksisRange),r.Tb(4),r.dd(r.Nc(42,ne)),r.Hc("baseZIndex",9999)("firstDayOfWeek",1)("selectOtherMonths",!0)("monthNavigator",!0)("yearNavigator",!0)("yearRange",e.yearRange)("showIcon",!0)("showButtonBar",!0)("readonlyInput",!0)("ngModel",e.hmerominiaSinallagisRange),r.Tb(4),r.Hc("items",e.tropoiPliromis)("ngModel",e.receiptType)("searchable",!1)("clearable",!1),r.Tb(17),r.kd("\u03a0\u03bb\u03ae\u03b8\u03bf\u03c2 \u0391\u03c0\u03bf\u03b4\u03b5\u03af\u03be\u03b5\u03c9\u03bd: ",null==e.orderedReceiptsFiltered?null:e.orderedReceiptsFiltered.length,""),r.Tb(1),r.Hc("value",e.orderedReceiptsFiltered)("autoLayout",!0)("responsive",!0)("scrollable",!0)("lazy",!1)("paginator",!0)("alwaysShowPaginator",!1)("rows",10)("totalRecords",e.orderedReceiptsFiltered.length)("loading",e.isLoading),r.Tb(7),r.kd("\u03a0\u03bb\u03ae\u03b8\u03bf\u03c2 \u0391\u03c0\u03bf\u03b4\u03b5\u03af\u03be\u03b5\u03c9\u03bd: ",null==e.orderedReceiptsFiltered?null:e.orderedReceiptsFiltered.length,"")}}function ae(e,t){if(1&e&&(r.kc(0),r.gd(1,ce,48,43,"div",9),r.jc()),2&e){const e=r.yc();r.Tb(1),r.Hc("ngIf",e.receipts.entries&&e.receipts.entries.length)}}class re{constructor(e,t,i,s,n){this.oidcSecuritySrv=e,this.epaymentsSrv=t,this.toasterSrv=i,this.cdr=s,this.route=n,this.onDestroy=new a.a,this.totalPoso=0,this.bankStatusMessageClass=void 0,this.receiptsUrlBase=AppConfOptions.epayments_api,this.receiptType="all",this.isLoading=!0,this.hmerominiaApodiksisRange=null,this.hmerominiaSinallagisRange=null,this.today=new Date,this.yearRange=u.h,this.tropoiPliromis=[{id:"all",perigrafi:"\u038c\u03bb\u03bf\u03b9"},{id:"municipality",perigrafi:"\u03a4\u03b1\u03bc\u03b5\u03af\u03bf \u0394\u03ae\u03bc\u03bf\u03c5"},{id:"bank",perigrafi:"Online"}]}ngOnInit(){this.isLoading=!0,this.epaymentsSrv.getPaymentSettings().subscribe(e=>this.paymentsSettings=e),this.epaymentsSrv.getBankMessages().pipe(Object(g.a)(e=>e?(this.oikonomikiBankMessages=e,this.oidcSecuritySrv.userData$.pipe(Object(q.a)(this.onDestroy))):Object(m.a)(!1)),Object(g.a)(e=>e?(this.user=e,this.route.queryParams.pipe(Object(q.a)(this.onDestroy))):Object(m.a)(!1))).subscribe(e=>{if(e){let t=e;if(t.messagecode||t.paymentStatus){let e;e=t.messagecode?t.messagecode:t.paymentStatus,this.bankStatusMessage=this.oikonomikiBankMessages[e],this.bankStatusMessageClass="TRANSACTION_COMPLETED"==e||"APPROVED"==e?"success":"error"}Object(u.d)(this.cdr),this._initReceiptsByTin()}else this.toasterSrv.showError("","\u039a\u03ac\u03c4\u03b9 \u03c0\u03ae\u03b3\u03b5 \u03c3\u03c4\u03c1\u03b1\u03b2\u03ac..."),this.isLoading=!1,Object(u.d)(this.cdr)})}ngOnChanges(e){e&&e.tabChanged&&(this.bankStatusMessage=void 0,Object(u.d)(this.cdr))}ngOnDestroy(){this.onDestroy.next(null)}_initReceiptsByTin(){this.isLoading=!0;let e=new Date,t={tin:this.user.tin,year:e.getFullYear()};this.epaymentsSrv.getPaymentsByTin(t).subscribe(e=>{e&&(this.receipts=e,this.totalPoso=0,this.receipts.entries&&this.receipts.entries.length>0&&this.receipts.entries.forEach(e=>{this.totalPoso+=e.receiptAmount}),!this.receipts.statusCode||2!=this.receipts.statusCode&&3!=this.receipts.statusCode?1==this.receipts.statusCode&&0==this.receipts.entries.length?this.receiptsMessage="\u0394\u03b5\u03bd \u03c5\u03c0\u03ac\u03c1\u03c7\u03bf\u03c5\u03bd \u03b1\u03c0\u03bf\u03b4\u03b5\u03af\u03be\u03b5\u03b9\u03c2 \u03b5\u03af\u03c3\u03c0\u03c1\u03b1\u03be\u03b7\u03c2 \u03c3\u03c4\u03bf \u0391\u03a6\u039c \u03c3\u03b1\u03c2.":this._fillOrderedReceipts(this.receipts):this.receipts.responseMetadata.metadata.hasOwnProperty("REV_DEPTOR_NOT_FOUND")?(this.toasterSrv.showWarning("","\u0394\u03b5\u03bd \u03c5\u03c0\u03ac\u03c1\u03c7\u03bf\u03c5\u03bd \u03b1\u03c0\u03bf\u03b4\u03b5\u03af\u03be\u03b5\u03b9\u03c2 \u03b5\u03af\u03c3\u03c0\u03c1\u03b1\u03be\u03b7\u03c2 \u03c3\u03c4\u03bf \u0391\u03a6\u039c \u03c3\u03b1\u03c2."),this.receiptsMessage="\u0394\u03b5\u03bd \u03c5\u03c0\u03ac\u03c1\u03c7\u03bf\u03c5\u03bd \u03b1\u03c0\u03bf\u03b4\u03b5\u03af\u03be\u03b5\u03b9\u03c2 \u03b5\u03af\u03c3\u03c0\u03c1\u03b1\u03be\u03b7\u03c2 \u03c3\u03c4\u03bf \u0391\u03a6\u039c \u03c3\u03b1\u03c2."):this.receipts.responseMetadata.metadata.hasOwnProperty("REV_MULTIPLE_DEPTORS_FOUND")&&(this.toasterSrv.showError("error","\u03a0\u03b1\u03c1\u03b1\u03ba\u03b1\u03bb\u03bf\u03cd\u03bc\u03b5 \u03b5\u03c0\u03b9\u03ba\u03bf\u03b9\u03bd\u03c9\u03bd\u03ae\u03c3\u03c4\u03b5 \u03bc\u03b5 \u03c4\u03bf \u03c4\u03b1\u03bc\u03b5\u03af\u03bf \u03c4\u03bf\u03c5 \u03b4\u03ae\u03bc\u03bf\u03c5. \u03a4\u03bf \u0391\u03a6\u039c \u03c3\u03b1\u03c2 \u03b5\u03bc\u03c6\u03b1\u03bd\u03af\u03b6\u03b5\u03c4\u03b1\u03b9 \u03c3\u03b5 \u03c0\u03b1\u03c1\u03b1\u03c0\u03ac\u03bd\u03c9 \u03b1\u03c0\u03cc \u03bc\u03b9\u03b1 \u03ba\u03b1\u03c1\u03c4\u03ad\u03bb\u03b5\u03c2, \u03bf\u03b9 \u03bf\u03c0\u03bf\u03af\u03b5\u03c2 \u03c0\u03c1\u03ad\u03c0\u03b5\u03b9 \u03bd\u03b1 \u03c3\u03c5\u03b3\u03c7\u03c9\u03bd\u03b5\u03c5\u03b8\u03bf\u03cd\u03bd."),this.receiptsMessage="\u03a0\u03b1\u03c1\u03b1\u03ba\u03b1\u03bb\u03bf\u03cd\u03bc\u03b5 \u03b5\u03c0\u03b9\u03ba\u03bf\u03b9\u03bd\u03c9\u03bd\u03ae\u03c3\u03c4\u03b5 \u03bc\u03b5 \u03c4\u03bf \u03c4\u03b1\u03bc\u03b5\u03af\u03bf \u03c4\u03bf\u03c5 \u03b4\u03ae\u03bc\u03bf\u03c5. \u03a4\u03bf \u0391\u03a6\u039c \u03c3\u03b1\u03c2 \u03b5\u03bc\u03c6\u03b1\u03bd\u03af\u03b6\u03b5\u03c4\u03b1\u03b9 \u03c3\u03b5 \u03c0\u03b1\u03c1\u03b1\u03c0\u03ac\u03bd\u03c9 \u03b1\u03c0\u03cc \u03bc\u03b9\u03b1 \u03ba\u03b1\u03c1\u03c4\u03ad\u03bb\u03b5\u03c2, \u03bf\u03b9 \u03bf\u03c0\u03bf\u03af\u03b5\u03c2 \u03c0\u03c1\u03ad\u03c0\u03b5\u03b9 \u03bd\u03b1 \u03c3\u03c5\u03b3\u03c7\u03c9\u03bd\u03b5\u03c5\u03b8\u03bf\u03cd\u03bd.")),this.isLoading=!1,Object(u.d)(this.cdr)})}btnApplyFiltersClicked(){this.isLoading=!0,this.orderedReceiptsFiltered=Object(u.c)(this.orderedReceipts),this.hmerominiaApodiksisRange&&(this.orderedReceiptsFiltered=this.orderedReceiptsFiltered.filter(e=>!!K.utc(e.receiptDateCreated).isBetween(K.utc(this.hmerominiaApodiksisRange[0]),K.utc(this.hmerominiaApodiksisRange[1]).add(1,"day")))),this.hmerominiaSinallagisRange&&(this.orderedReceiptsFiltered=this.orderedReceiptsFiltered.filter(e=>!!K(e.bankTxnDateCreated).isBetween(K(this.hmerominiaSinallagisRange[0]),K(this.hmerominiaSinallagisRange[1]).add(1,"day")))),Object(u.d)(this.cdr),this._filterByType()}btnCleanFiltersClicked(){this.orderedReceiptsFiltered=Object(u.c)(this.orderedReceipts),this.hmerominiaApodiksisRange=null,this.hmerominiaSinallagisRange=null,this.receiptType,Object(u.d)(this.cdr)}_filterByType(){"bank"==this.receiptType?this.orderedReceiptsFiltered=this.orderedReceiptsFiltered.filter(e=>0!=e.isOnline):"municipality"==this.receiptType&&(this.orderedReceiptsFiltered=this.orderedReceiptsFiltered.filter(e=>1!=e.isOnline)),this.isLoading=!1,Object(u.d)(this.cdr)}btnBankStatusMessageClicked(){this.bankStatusMessage=null,this._initReceiptsByTin()}_fillOrderedReceipts(e=null){null==e&&(e=this.receipts);let t=this.receipts.entries.filter(e=>null===e.receiptDateCreated),i=this.receipts.entries.filter(e=>null!=e.receiptDateCreated);this.orderedReceipts=i.sort(function(e,t){if(t.receiptDateCreated!==e.receiptDateCreated)return t.receiptDateCreated>e.receiptDateCreated;return parseInt(t.receiptIncrNr.split("/").pop())>parseInt(e.receiptIncrNr.split("/").pop())}),0!=t.length&&t.forEach(e=>{this.orderedReceipts.unshift(e)}),this.orderedReceipts.forEach(e=>{0==e.isOnline?e.icon="far fa-building":e.icon="fas fa-desktop",null==e.bankTxnDescr?e.description=e.receiptDescr:e.description=e.bankTxnDescr,null==e.bankTxnPaymentTotal?e.paymentTotal=e.receiptAmount:e.paymentTotal=e.bankTxnPaymentTotal,null!=e.receiptId&&null!=e.bankTxnUid?e.link='<a href="'+AppConfOptions.epayments_api+"/api/PersistedDebits/GetPaymentFile/"+e.bankTxnUid+'" target="_blank"><i class="far fa-file-pdf"></i></a>':e.link=""}),this.orderedReceiptsFiltered=Object(u.c)(this.orderedReceipts),Object(u.d)(this.cdr)}handleError(e){return console.log(e.message),console.log(e.error),Object(V.a)(e.message)}}re.\u0275fac=function(e){return new(e||re)(r.gc(o.e),r.gc(y.a),r.gc(b.a),r.gc(r.j),r.gc(c.a))},re.\u0275cmp=r.ac({type:re,selectors:[["app-receipts"]],inputs:{tabChanged:"tabChanged"},features:[r.Rb],decls:4,vars:4,consts:[["class","bg-white","style","width: 100%; height: 300px",4,"ngIf"],["severity","warn",3,"text",4,"ngIf"],[3,"severity","text","styleClass",4,"ngIf"],[4,"ngIf"],[1,"bg-white",2,"width","100%","height","300px"],[1,"d-flex","justify-content-center","align-items-center","w-100","h-100"],[1,"fas","fa-circle-notch","fa-3x","fa-pulse"],["severity","warn",3,"text"],[3,"severity","text","styleClass"],["class","receipts-info",4,"ngIf"],[1,"receipts-info"],["header","\u03a6\u03af\u03bb\u03c4\u03c1\u03b1 \u0391\u03bd\u03b1\u03b6\u03ae\u03c4\u03b7\u03c3\u03b7\u03c2",3,"styleClass"],[1,"form"],[1,"row"],[1,"form-group","col-12","col-sm-6","col-md-4"],["for","hmerominiaApodiksisRange"],["name","hmerominiaApodiksisRange","dateFormat","dd/mm/yy","placeholder","\u03b7\u03b7/\u03bc\u03bc/\u03c7\u03c7\u03c7\u03c7","selectionMode","range","appendTo","body",3,"baseZIndex","firstDayOfWeek","selectOtherMonths","monthNavigator","yearNavigator","yearRange","showIcon","showButtonBar","readonlyInput","ngModel","ngModelChange"],["for","exchangeDatepicker"],["name","hmerominiaSinallagisRange","dateFormat","dd/mm/yy","placeholder","\u03b7\u03b7/\u03bc\u03bc/\u03c7\u03c7\u03c7\u03c7","selectionMode","range","appendTo","body",3,"baseZIndex","firstDayOfWeek","selectOtherMonths","monthNavigator","yearNavigator","yearRange","showIcon","showButtonBar","readonlyInput","ngModel","ngModelChange"],["for","recType"],["name","recType","bindLabel","perigrafi","bindValue","id",3,"items","ngModel","searchable","clearable","ngModelChange"],[1,"form-buttons","d-flex","flex-wrap"],["type","button",1,"btn","btn-primary","btn-sm","mr-1",3,"click"],["aria-hidden","true",1,"fas","fa-search","fa-fw"],["type","button",1,"btn","btn-warning","btn-sm","text-white",3,"click"],["aria-hidden","true",1,"fas","fa-times","fa-fw"],[1,"d-flex","flex-wrap","mb-1",2,"font-size","14px"],[1,"mr-1"],[1,"fas","fa-desktop","fa-fw"],[1,"far","fa-building","fa-fw"],[3,"value","autoLayout","responsive","scrollable","lazy","paginator","alwaysShowPaginator","rows","totalRecords","loading"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],["pTemplate","emptymessage"],[1,"mt-1"],[1,"d-flex","flex-wrap","mt-1","mb-1",2,"font-size","14px"],[1,"fixed-width-col-40"],[1,"fixed-width-col-60"],[1,"fixed-width-col-150"],["class","fixed-width-col-60",4,"ngIf"],[1,"fixed-width-col-40","text-center"],[1,"p-column-title"],["aria-hidden","true"],[1,"fixed-width-col-60","text-right"],["class","fixed-width-col-60 text-center",4,"ngIf"],[1,"fixed-width-col-60","text-center"],["target","_blank","aria-label","\u03a3\u03cd\u03bd\u03b4\u03b5\u03c3\u03bc\u03bf\u03c2 \u03b3\u03b9\u03b1 \u0391\u03c1\u03c7\u03b5\u03af\u03bf \u0395\u03ba\u03c4\u03cd\u03c0\u03c9\u03c3\u03b7\u03c2","rel","noopener",3,"href",4,"ngIf"],["target","_blank","aria-label","\u03a3\u03cd\u03bd\u03b4\u03b5\u03c3\u03bc\u03bf\u03c2 \u03b3\u03b9\u03b1 \u0391\u03c1\u03c7\u03b5\u03af\u03bf \u0395\u03ba\u03c4\u03cd\u03c0\u03c9\u03c3\u03b7\u03c2","rel","noopener",3,"href"],["aria-hidden","true",1,"far","fa-file-pdf"],["colspan","6",1,"fixed-width-col-430","text-right"],[1,"fixed-width-col-120"]],template:function(e,t){1&e&&(r.gd(0,$,3,0,"div",0),r.gd(1,J,1,1,"p-message",1),r.gd(2,G,1,3,"p-message",2),r.gd(3,ae,2,1,"ng-container",3)),2&e&&(r.Hc("ngIf",!t.receipts||t.isLoading),r.Tb(1),r.Hc("ngIf",t.receiptsMessage&&""!=t.receiptsMessage),r.Tb(1),r.Hc("ngIf",!t.isLoading&&t.bankStatusMessage&&""!=t.bankStatusMessage),r.Tb(1),r.Hc("ngIf",t.receipts&&!t.isLoading))},directives:[d.p,l.b,h.a,x.w,x.n,x.o,W.a,x.m,x.p,w.a,T.d,k.j],pipes:[d.f,d.d],encapsulation:2,changeDetection:0});var oe=i("iHy+");function de(e,t){1&e&&r.hc(0,"p-message",3)}function le(e,t){if(1&e&&(r.mc(0,"p-panel",4),r.hc(1,"div",5),r.zc(2,"decodeHtmlString"),r.lc()),2&e){const e=r.yc();r.Hc("styleClass","tab-msg mb-3")("toggleable",!0),r.Tb(1),r.Hc("innerHTML",r.Ac(2,3,e.tabMsg),r.ad)}}function he(e,t){if(1&e&&r.hc(0,"app-receipts",10),2&e){const e=r.yc(2);r.Hc("tabChanged",e.onTbChanged)}}function pe(e,t){if(1&e){const e=r.nc();r.mc(0,"p-tabView",6),r.wc("onChange",function(t){r.Zc(e);return r.yc().onTabChanged(t)}),r.mc(1,"p-tabPanel",7),r.hc(2,"app-debits"),r.lc(),r.mc(3,"p-tabPanel",8),r.gd(4,he,1,1,"ng-template",9),r.lc(),r.lc()}if(2&e){const e=r.yc();r.Hc("activeIndex",e.index)}}class me{constructor(e,t,i,s){this.oidcSecuritySrv=e,this.location=t,this.router=i,this.route=s,this.onDestroy=new a.a,this.index=0,this.onTbChanged=!1}ngOnInit(){this.oidcSecuritySrv.isAuthenticated$.subscribe(e=>{this.isAuthorized=e,AppConfOptions&&AppConfOptions.epayments_debits_tab_info&&""!=AppConfOptions.epayments_debits_tab_info&&this.router.url.includes("debits")&&(this.tabMsg=AppConfOptions.epayments_debits_tab_info),AppConfOptions&&AppConfOptions.epayments_receipts_tab_info&&""!=AppConfOptions.epayments_receipts_tab_info&&this.router.url.includes("receipts")&&(this.tabMsg=AppConfOptions.epayments_receipts_tab_info)}),"receipts"===this.route.children[0].snapshot.url[0].path?this.index=1:this.index=0}ngOnDestroy(){this.onDestroy.next(null)}onTabChanged(e){0==e.index?(this.router.navigate(["./debits"],{relativeTo:this.route}),AppConfOptions&&AppConfOptions.epayments_debits_tab_info&&""!=AppConfOptions.epayments_debits_tab_info&&(this.tabMsg=AppConfOptions.epayments_debits_tab_info)):(this.router.navigate(["./receipts"],{relativeTo:this.route}),this.onTbChanged=!0,AppConfOptions&&AppConfOptions.epayments_receipts_tab_info&&""!=AppConfOptions.epayments_receipts_tab_info&&(this.tabMsg=AppConfOptions.epayments_receipts_tab_info))}}me.\u0275fac=function(e){return new(e||me)(r.gc(o.e),r.gc(d.k),r.gc(c.d),r.gc(c.a))},me.\u0275cmp=r.ac({type:me,selectors:[["app-epayments-layout"]],inputs:{isAuthorized:"isAuthorized"},decls:3,vars:3,consts:[["severity","warn","text","\u03a0\u03b1\u03c1\u03b1\u03ba\u03b1\u03bb\u03bf\u03cd\u03bc\u03b5 \u03c3\u03c5\u03bd\u03b4\u03b5\u03b8\u03b5\u03af\u03c4\u03b5 \u03c3\u03c4\u03bf \u03c3\u03cd\u03c3\u03c4\u03b7\u03bc\u03b1 \u03b7\u03bb\u03b5\u03ba\u03c4\u03c1\u03bf\u03bd\u03b9\u03ba\u03ce\u03bd \u03c5\u03c0\u03b7\u03c1\u03b5\u03c3\u03b9\u03ce\u03bd.",4,"ngIf"],["header","\u03a0\u03bb\u03b7\u03c1\u03bf\u03c6\u03bf\u03c1\u03af\u03b5\u03c2",3,"styleClass","toggleable",4,"ngIf"],[3,"activeIndex","onChange",4,"ngIf"],["severity","warn","text","\u03a0\u03b1\u03c1\u03b1\u03ba\u03b1\u03bb\u03bf\u03cd\u03bc\u03b5 \u03c3\u03c5\u03bd\u03b4\u03b5\u03b8\u03b5\u03af\u03c4\u03b5 \u03c3\u03c4\u03bf \u03c3\u03cd\u03c3\u03c4\u03b7\u03bc\u03b1 \u03b7\u03bb\u03b5\u03ba\u03c4\u03c1\u03bf\u03bd\u03b9\u03ba\u03ce\u03bd \u03c5\u03c0\u03b7\u03c1\u03b5\u03c3\u03b9\u03ce\u03bd."],["header","\u03a0\u03bb\u03b7\u03c1\u03bf\u03c6\u03bf\u03c1\u03af\u03b5\u03c2",3,"styleClass","toggleable"],[3,"innerHTML"],[3,"activeIndex","onChange"],["header","\u03a0\u03bb\u03b7\u03c1\u03c9\u03bc\u03ad\u03c2 \u039f\u03c6\u03b5\u03b9\u03bb\u03ce\u03bd"],["header","\u0399\u03c3\u03c4\u03bf\u03c1\u03b9\u03ba\u03cc \u03a0\u03bb\u03b7\u03c1\u03c9\u03bc\u03ce\u03bd"],["pTemplate","content"],[3,"tabChanged"]],template:function(e,t){1&e&&(r.gd(0,de,1,0,"p-message",0),r.gd(1,le,3,5,"p-panel",1),r.gd(2,pe,5,1,"p-tabView",2)),2&e&&(r.Hc("ngIf",!t.isAuthorized),r.Tb(1),r.Hc("ngIf",t.tabMsg),r.Tb(1),r.Hc("ngIf",t.isAuthorized))},directives:[d.p,l.b,h.a,p.b,p.a,U,k.j,re],pipes:[oe.a],encapsulation:2});const ge=[{path:"",component:me,children:[{path:"",pathMatch:"full",redirectTo:"debits"},{path:"debits",component:U},{path:"receipts",component:re}]}];class fe{}fe.\u0275fac=function(e){return new(e||fe)},fe.\u0275mod=r.ec({type:fe}),fe.\u0275inj=r.dc({imports:[[c.g.forChild(ge)],c.g]});class be{}be.\u0275fac=function(e){return new(e||be)},be.\u0275mod=r.ec({type:be}),be.\u0275inj=r.dc({providers:[y.a],imports:[[fe,n.a,s.d]]})}}]);